<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ML-Dl-kaggleæ­£ç¡®ç”¨æ³•</title>
      <link href="/2022/05/09/ml-dl-kaggle-zheng-que-yong-fa/"/>
      <url>/2022/05/09/ml-dl-kaggle-zheng-que-yong-fa/</url>
      
        <content type="html"><![CDATA[<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>æƒ³å†™çš„æ—¶å€™å°±æ¥ï¼Œä¸æƒ³ push è‡ªå·±ï¼Œæ²¡æœ‰æ–°æ„</p>]]></content>
      
      
      
        <tags>
            
            <tag> Noince </tag>
            
            <tag> advance </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-update-2</title>
      <link href="/2022/05/07/pe-update-2/"/>
      <url>/2022/05/07/pe-update-2/</url>
      
        <content type="html"><![CDATA[<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>ä»Šå¤©çš„æ„Ÿjoæ˜¯æ²¡å¾—ä»€ä¹ˆèƒ½å¤Ÿæ‹¦ä½æˆ‘ï¼Œæ€ç»ªé£˜åœ¨äº†å›ºå®šçš„æ–¹å‘ï¼Œæœ‰å¤ªå¤šå¤ªå¤šæƒ³å»åšçš„å•¦ã€‚</p><p>æƒ³å»ºç«‹ä¸€ä¸ªå·¥ä½œå®¤ç»™å¤§å®¶å¸¦æ¥å¿«ä¹ï¼Œæƒ³å»åˆ›ä¸šå»ºç«‹æˆ‘çš„æ—¶ä»£ï¼Œæƒ³å»å’Œé‚£äº›äº’è”ç½‘å¤´ç›®ç¢°æ’ï¼Œæƒ³å®‰å¿ƒåœ¨å­¦æœ¯æ°›å›´æµ“åšçš„åœ°æ–¹åšç ”ç©¶</p>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-é¸Ÿç±»é¥²å…»è®°</title>
      <link href="/2022/05/04/pe-niao-lei-si-yang-ji/"/>
      <url>/2022/05/04/pe-niao-lei-si-yang-ji/</url>
      
        <content type="html"><![CDATA[<h3 id="è‡´å›é€†çš„-Big-Birdï¼š"><a href="#è‡´å›é€†çš„-Big-Birdï¼š" class="headerlink" title="è‡´å›é€†çš„ Big Birdï¼š"></a>è‡´å›é€†çš„ Big Birdï¼š</h3><p>çœ‹èµ·æ¥ä¼¼ä¹å¥½æ´»æ³¼å¥½åŠ¨ï¼Œå´æ¯«ä¸ä¸ºæˆ‘æ‰€æä¾›çš„å…­æ˜Ÿçº§è±ªååˆ«å¢…æ‰€åŠ¨ï¼Œæ»¡çœ¼éƒ½å´‡å°šå¤–é¢çš„ç‚¹æ»´ä¸€æ–¹ä¸–ç•Œï¼Œç•™ä¸ä½çš„ä¹Ÿä¼šè«åçš„æµéœ²å‡ºä¸€ä¸ä¸ä¸å¿å¿ƒã€‚</p><p>è‡ªç§çš„çƒ­åˆ‡å…³å¿ƒå¹¶ä¸ä¼šæ”¹å˜ä»€ä¹ˆï¼Œæˆ‘å¹¶ä¸å¤±è½ï¼Œå› ä¸ºè¿™ç»“æœæˆ‘å¯ä»¥é¢„è§ï¼Œå¦ä¸€ç§ç»“æœæ˜¯æ¯«ä¸ç•™æƒ…ç›´æ¥ç‚–äº†ï¼Œä¾èµ–è¾¾å°”æ–‡æ‰€è¯´çš„ç”Ÿç‰©è¿›åŒ–çš„åŸºç¡€æ˜¯è‡ªç„¶é€‰æ‹©ï¼Œè¿™å¹¶ä¸æ®‹å¿</p><p>ä½†ä¸ºä»€ä¹ˆäº§ç”Ÿäº†ä¸€ç‚¹ç‚¹ç©ºè™šå‘¢ï¼Œè§£æä¸å‡ºæ¥ã€‚</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>ä»ä¸€åªé¸Ÿçš„è§‚å¯Ÿè”ç³»åˆ°äººé™…äº¤æµï¼Œå…³å¿ƒä¼šå¯¹ä¸€ä¸ªäººä»˜å‡ºè‡ªå·±è„†è½çš„ç‰ç’ƒå¿ƒï¼Œå³ä½¿æ˜¯å­¤èµ–è°ƒçš®çš„äººä¹Ÿä¸ä¾‹å¤–ã€‚</p><p><img src="/IMG_20220504_155927.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¥²å…»è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-æœ•ä¹‹æ—¨æ„</title>
      <link href="/2022/05/02/pe-zhen-zhi-zhi-yi/"/>
      <url>/2022/05/02/pe-zhen-zhi-zhi-yi/</url>
      
        <content type="html"><![CDATA[<h3 id="å†…ç¯‡-amp-amp-é€é¥æ¸¸"><a href="#å†…ç¯‡-amp-amp-é€é¥æ¸¸" class="headerlink" title="å†…ç¯‡&amp;&amp;é€é¥æ¸¸"></a>å†…ç¯‡&amp;&amp;é€é¥æ¸¸</h3><p>ä»¥åå°è¯•å»å†™å‡ æœ¬ä¹¦</p><p>ä¸€æœ¬è®²æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„ï¼Œä¸€å®šä¸è¦å†™çš„å¤ªåšï¼Œå› ä¸ºå¯¹äºåƒæˆ‘è¿™æ ·æ…¢æ€§ç²¾è¯»çš„äººæ¥è¯´å°±éå¸¸æŠ˜ç£¨ï¼Œè¿˜æ²¡åˆ°è·Ÿè‡ªå·±è¿‡ä¸å»çš„æ—¶å€™ã€‚</p><p>ä¸€æœ¬è®²æˆ‘å¯¹é‡å­è®¡ç®—ä¸ä¿¡æ¯çš„æ¢ç´¢ï¼Œè¿™æ˜¯ä¸ªå¤§è¯¾é¢˜ï¼Œå¾—å¾ˆä¹…å•¦ã€‚</p><p>æœ€åä¸€æœ¬æ˜¯æˆ‘çš„æ‰‹ç»˜æœ¬ï¼Œæƒ³äº†ä¸€ä¸ªæ¯”è¾ƒä¸­äºŒçš„åå­—ï¼Œ[ç ”ç©¶è€…çš„æ‰‹ç»˜æœ¬ï¼šå¼‚æ„è®¤è¯†ä¸–ç•Œ]</p><p>æœ€åçš„ä¸€ç‚¹ç‚¹æ˜¯ï¼Œå³ä½¿æœ‰æƒ³æ”¾å¼ƒå½“åˆçš„éƒ¨åˆ†çƒ­è¡·ï¼Œè¦ç‡ƒèµ·å¯¹è‡ªå·±çš„çƒ­çˆ±ï¼Œå› ä¸ºè¿˜æœ‰å¯èƒ½ï¼Œæˆ‘å¯ç»™ä»¥æ— èŠçš„ä¸–ç•Œå¸¦æ¥ä¹è¶£ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾®ä¸è¶³é“çš„è´¡çŒ® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-update-0</title>
      <link href="/2022/05/02/pe-update-0/"/>
      <url>/2022/05/02/pe-update-0/</url>
      
        <content type="html"><![CDATA[<h3 id="å†…ç¯‡-amp-amp-äººé—´ä¸–"><a href="#å†…ç¯‡-amp-amp-äººé—´ä¸–" class="headerlink" title="å†…ç¯‡&amp;&amp;äººé—´ä¸–"></a>å†…ç¯‡&amp;&amp;äººé—´ä¸–</h3><p>æ¯å¤©æ—©ä¸Šè¿·è¿·ç³Šç³Šçš„èµ·åºŠæ’é˜ŸæŠ¢æ˜¾å¡æ˜¾å¾—æˆ‘å¾ˆçª˜è¿«ã€å¤šä½™ï¼Œç°åœ¨æ˜¯æ—©ä¸Š 0.36ï¼Œä¸Šçº¿æ’é˜Ÿç­‰ TPUä¸­â€¦â€¦</p>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-update-1</title>
      <link href="/2022/04/26/pe-update-1/"/>
      <url>/2022/04/26/pe-update-1/</url>
      
        <content type="html"><![CDATA[<h3 id="å¾€æ—¥ç»­è°ˆ"><a href="#å¾€æ—¥ç»­è°ˆ" class="headerlink" title="å¾€æ—¥ç»­è°ˆ"></a>å¾€æ—¥ç»­è°ˆ</h3><p>å¹´è½»çš„æ—¶å€™å½“ç„¶ä¼šè§‰å¾—åš hacker æ˜¯æœ€å¸…çš„ï¼Œä¼šå†™ä»£ç è´Ÿè·æ”»å‡»ï¼Œæ¸¸è¡åœ¨å¤–é¢å±é™©è€Œåˆè¿·äººçš„ç¥ç§˜èƒŒå½±æ€èƒ½ä¸è®©äººå¿ƒåŠ¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-kFoldéªŒè¯</title>
      <link href="/2022/04/15/ml-dl-kfold-yan-zheng/"/>
      <url>/2022/04/15/ml-dl-kfold-yan-zheng/</url>
      
        <content type="html"><![CDATA[<h3 id="è®­ç»ƒæ–¹æ³•"><a href="#è®­ç»ƒæ–¹æ³•" class="headerlink" title="è®­ç»ƒæ–¹æ³•"></a>è®­ç»ƒæ–¹æ³•</h3><p>k-foldéªŒè¯æ˜¯åœ¨è®­ç»ƒæ¨¡å‹çš„æ—¶å€™æ™®éä½¿ç”¨çš„ç­–ç•¥ï¼Œåœ¨è®­ç»ƒé›†ä¸Šéšæœºåˆ’åˆ†æ•°ä¸ªæ¨¡å—ï¼Œä¸€èˆ¬åˆ†ä¸º5æŠ˜ï¼Œå…¶ä¸­ä¸€æŠ˜æ˜¯éªŒè¯é›†ï¼Œå¦å¤–å››æŠ˜æ˜¯è®­ç»ƒé›†ï¼Œå¾ªç¯è¿­ä»£5æ¬¡ï¼Œæœ€åå¯¹åšæ¨¡å‹é›†æˆåŠ æƒå¹³å‡ï¼Œç‰¹å¾å·¥ç¨‹é‡Œå¯¹äºåˆ’åˆ†ä¹Ÿæœ‰å¾ˆç»†è‡´çš„åˆ’åˆ†ï¼Œä½†è¿™é‡Œå°±ä¸è¯¦ç»†è¿°è¯´äº†ï¼Œæœ‰åŸºç¡€çš„è¯»è€…åº”è¯¥çŸ¥é“ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">create_folds</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> num_splits<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># we create a new column called kfold and fill it with -1</span>    data<span class="token punctuation">[</span><span class="token string">"fold"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>        <span class="token comment"># the next step is to randomize the rows of the data</span>    <span class="token comment"># data = data.sample(frac=1).reset_index(drop=True)</span>    <span class="token comment"># calculate number of bins by Sturge's rule</span>    <span class="token comment"># I take the floor of the value, you can also</span>    <span class="token comment"># just round it</span>    <span class="token comment"># num_bins = int(np.floor(1 + np.log2(len(data))))</span>        <span class="token comment"># bin targets</span>    data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"bins"</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>        data<span class="token punctuation">[</span><span class="token string">"score"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token boolean">False</span>    <span class="token punctuation">)</span>        <span class="token comment"># initiate the kfold class from model_selection module</span>    kf <span class="token operator">=</span> StratifiedKFold<span class="token punctuation">(</span>n_splits<span class="token operator">=</span>num_splits<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>        <span class="token comment"># fill the new kfold column</span>    <span class="token comment"># note that, instead of targets, we use bins!</span>    <span class="token keyword">for</span> f<span class="token punctuation">,</span> <span class="token punctuation">(</span>t_<span class="token punctuation">,</span> v_<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>kf<span class="token punctuation">.</span>split<span class="token punctuation">(</span>X<span class="token operator">=</span>data<span class="token punctuation">,</span> y<span class="token operator">=</span>data<span class="token punctuation">.</span>bins<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>v_<span class="token punctuation">,</span> <span class="token string">'fold'</span><span class="token punctuation">]</span> <span class="token operator">=</span> f        <span class="token comment"># drop the bins column</span>    data <span class="token operator">=</span> data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"bins"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment"># return dataframe with folds</span>    <span class="token keyword">return</span> data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ML </tag>
            
            <tag> DL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/04/13/hello-world/"/>
      <url>/2022/04/13/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-KaggleCompeTem</title>
      <link href="/2022/04/11/ml-dl-kagglecompetem/"/>
      <url>/2022/04/11/ml-dl-kagglecompetem/</url>
      
        <content type="html"><![CDATA[<h2 id="1ã€The-most-common-classes-CV"><a href="#1ã€The-most-common-classes-CV" class="headerlink" title="1ã€The most common classes - CV"></a>1ã€The most common classes - CV</h2><p>è¡¥å……ç»†åˆ†ç±»åˆ«</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ä»¥USPPPMä¸ºä¾‹å­</span><span class="token keyword">class</span> <span class="token class-name">Dataset</span><span class="token punctuation">:</span>        <span class="token keyword">class</span> <span class="token class-name">CFG</span><span class="token punctuation">:</span>        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2ã€The-second-classes-NLP"><a href="#2ã€The-second-classes-NLP" class="headerlink" title="2ã€The second classes - NLP"></a>2ã€The second classes - NLP</h2><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>è¡¥å……ç»†åˆ†ç±»åˆ«</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3ã€Machine-learning-Competitions"><a href="#3ã€Machine-learning-Competitions" class="headerlink" title="3ã€Machine learning Competitions"></a>3ã€Machine learning Competitions</h2>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kaggle </tag>
            
            <tag> ç«èµ›æ¨¡æ¿ </tag>
            
            <tag> å¸¸ç”¨tricks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-Dl-DataVisualtion</title>
      <link href="/2022/04/08/ml-dl-datavisualtion/"/>
      <url>/2022/04/08/ml-dl-datavisualtion/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-none"><code class="language-none">import pandas as pdpd.plotting.register_matplotlib_converters()import matplotlib.pyplot as plt%matplotlib inlineimport seaborn as sns<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> data vistualtion </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-ä¼˜åŒ–ç®—æ³•ç–‘é—®</title>
      <link href="/2022/04/07/ml-dl-you-hua-suan-fa-yi-wen/"/>
      <url>/2022/04/07/ml-dl-you-hua-suan-fa-yi-wen/</url>
      
        <content type="html"><![CDATA[<h4 id="ä¼˜åŒ–ç®—æ³•ç–‘é—®"><a href="#ä¼˜åŒ–ç®—æ³•ç–‘é—®" class="headerlink" title="ä¼˜åŒ–ç®—æ³•ç–‘é—®"></a>ä¼˜åŒ–ç®—æ³•ç–‘é—®</h4><p>å‰ä¸€æ®µæ—¶é—´äº†è§£äº†ç”¨äºæ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–ç®—æ³•ï¼Œå¯æƒœæœ‰ä¸€äº›ç–‘é—®æ²¡èƒ½åŠæ—¶è®°å½•ä¸‹æ¥ï¼Œä¸ç„¶ arxiv ä¼šè¯ç”Ÿå‡ºä¸€ç¯‡æ–°çš„å…³äºä½¿ç”¨å°æ‰¹é‡ä¼˜åŒ–æ¢¯åº¦çš„åä¸½æ–‡ç« </p><p>ä¸‹é¢çš„ç®—æ³•è®°å½•å’Œè°ƒåŒ…ä¾ è¡Œä¸ºæ— å¼‚ï¼Œå¯¹äºæœ‰åŸºç¡€çš„é“å‹å¯ä»¥è·³åˆ°ä»£ç éƒ¨åˆ†</p><p>1.æœ´ç´ çš„ SGD</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">SGD</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>lr <span class="token operator">=</span> lr        self<span class="token punctuation">.</span>params<span class="token punctuation">,</span>self<span class="token punctuation">.</span>grads <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>params<span class="token punctuation">,</span>grads<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            params<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-=</span> self<span class="token punctuation">.</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.ç‰©ç†ä¸–ç•Œçš„ Momentum</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Momentum</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>lr <span class="token operator">=</span> lr        self<span class="token punctuation">.</span>momentum <span class="token operator">=</span> momentum        self<span class="token punctuation">.</span>v <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>params<span class="token punctuation">,</span>grads<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>v <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>v <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># v point to direct vector</span>            <span class="token keyword">for</span> param <span class="token keyword">in</span> params<span class="token punctuation">:</span>                self<span class="token punctuation">.</span>v<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>momentum <span class="token operator">*</span> self<span class="token punctuation">.</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            params<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> self<span class="token punctuation">.</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3.ä¸çŸ¥é“è¯¥æ€ä¹ˆæè¿° Nesterov</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Nesterov</span><span class="token punctuation">:</span>    <span class="token comment"># è¿™ä¸ªæ–¹æ³•ä¸å¤ªç†Ÿæ‚‰</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>lr <span class="token operator">=</span> lr        self<span class="token punctuation">.</span>momentum <span class="token operator">=</span> momentum        self<span class="token punctuation">.</span>v <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>params<span class="token punctuation">,</span>grads<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>v <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>v <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> param <span class="token keyword">in</span> params<span class="token punctuation">:</span>                self<span class="token punctuation">.</span>v<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>momentum <span class="token operator">*</span> self<span class="token punctuation">.</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            params<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> self<span class="token punctuation">.</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4.å¤§å®¶æ™®éä½¿ç”¨çš„ AdaGrad</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AdaGrad</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>lr <span class="token operator">=</span> lr        self<span class="token punctuation">.</span>h <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>params<span class="token punctuation">,</span>grads<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>h <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>h <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> param <span class="token keyword">in</span> params<span class="token punctuation">:</span>                self<span class="token punctuation">.</span>h<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>h<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            params<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-=</span> self<span class="token punctuation">.</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>self<span class="token punctuation">.</span>h<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1e-7</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>5.ä¹Ÿæ˜¯å¤§å®¶å¸¸ä½¿ç”¨çš„ RMSprop</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">RMSprop</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__int__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>decay_rate<span class="token operator">=</span><span class="token number">0.99</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>lr <span class="token operator">=</span> lr        self<span class="token punctuation">.</span>decay_rate <span class="token operator">=</span> decay_rate        self<span class="token punctuation">.</span>h <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>params<span class="token punctuation">,</span>grads<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>h <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>h <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> param <span class="token keyword">in</span> params<span class="token punctuation">:</span>                self<span class="token punctuation">.</span>h<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>h<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*=</span> self<span class="token punctuation">.</span>decay_rate                self<span class="token punctuation">.</span>h<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>decay_rate<span class="token punctuation">)</span> <span class="token operator">*</span> grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span>                params<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-=</span> self<span class="token punctuation">.</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>self<span class="token punctuation">.</span>h<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1e-7</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>6.è¿˜æ˜¯å¤§å®¶å¸¸ä½¿ç”¨çš„ Adam </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Adam</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>beta1<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>beta2<span class="token operator">=</span><span class="token number">0.999</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>lr <span class="token operator">=</span> lr        self<span class="token punctuation">.</span>beta1 <span class="token operator">=</span> beta1        self<span class="token punctuation">.</span>beta2 <span class="token operator">=</span> beta2        self<span class="token punctuation">.</span><span class="token builtin">iter</span> <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>v <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>params<span class="token punctuation">,</span>grads<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>m <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>m<span class="token punctuation">,</span> self<span class="token punctuation">.</span>v <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> param <span class="token keyword">in</span> params<span class="token punctuation">:</span>                self<span class="token punctuation">.</span>m<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>v<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span><span class="token builtin">iter</span> <span class="token operator">+=</span> <span class="token number">1</span>        lr_t <span class="token operator">=</span> self<span class="token punctuation">.</span>lr <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>beta2<span class="token operator">**</span>self<span class="token punctuation">.</span><span class="token builtin">iter</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>beta1<span class="token operator">**</span>self<span class="token punctuation">.</span><span class="token builtin">iter</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>beta1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>beta2<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>grads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            params <span class="token operator">-=</span> lr_t <span class="token operator">*</span> self<span class="token punctuation">.</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>self<span class="token punctuation">.</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1e-7</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h4><p>ä»£ç æºè‡ªï¼š æ–‹è—¤åº·æ¯…çš„ã€Šæ·±åº¦å­¦ä¹ è¿›é˜¶ï¼šè‡ªç„¶è¯­è¨€å¤„ç†ã€‹ï¼Œæœ‰å…´è¶£çš„é“å‹å¯ä»¥å»ç¿»çœ‹ï¼Œå¾ˆå¥½çš„ä¸€æœ¬ä¹¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SGD </tag>
            
            <tag> RMSProp </tag>
            
            <tag> Adam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-è®ºæ–‡å†™ä½œ</title>
      <link href="/2022/04/07/pe-lun-wen-xie-zuo/"/>
      <url>/2022/04/07/pe-lun-wen-xie-zuo/</url>
      
        <content type="html"><![CDATA[<h2 id="è®ºæ–‡å†™ä½œè¦æ±‚"><a href="#è®ºæ–‡å†™ä½œè¦æ±‚" class="headerlink" title="è®ºæ–‡å†™ä½œè¦æ±‚"></a>è®ºæ–‡å†™ä½œè¦æ±‚</h2><p>1.æ ‡é¢˜ + ä½œè€…</p><p>2.æ‘˜è¦ - Abstract</p><p>3.å¯¼è¨€ - Introduction </p><p>4.ç›¸å…³å·¥ä½œ - Related Work</p><p>Example : 5.æ¨¡å‹ - Deep Residual Learning - 5.1 &gt; 5.2 â€¦</p><p>6.ç†è®º</p><p>7.å®éªŒ + æ€»ç»“ - Experiments + Conclusion</p><p>8.è¯„è®º</p><p>å¼•ç”¨ï¼šReferences</p>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®ºæ–‡å†™ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-pythonç”¨æ³•æ³¨æ„</title>
      <link href="/2022/04/04/ml-dl-python-yong-fa-zhu-yi/"/>
      <url>/2022/04/04/ml-dl-python-yong-fa-zhu-yi/</url>
      
        <content type="html"><![CDATA[<h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><h3 id="åˆ‡ç‰‡æ“ä½œçš„å°å—è§£é‡Š"><a href="#åˆ‡ç‰‡æ“ä½œçš„å°å—è§£é‡Š" class="headerlink" title="åˆ‡ç‰‡æ“ä½œçš„å°å—è§£é‡Š"></a>åˆ‡ç‰‡æ“ä½œçš„å°å—è§£é‡Š</h3><ul><li>[-1]ï¼šè·å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç±»ä¼¼äºmatlabä¸­çš„endï¼›</li><li>[:-1]ï¼šé™¤äº†æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè·å–å…¶ä»–æ‰€æœ‰çš„å…ƒç´ ï¼›</li><li>[::-1]ï¼šå¯¹ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ è¿›è¡Œå€’åºä¹‹åå–å‡ºï¼›</li><li>[n::-1]ï¼šå¯¹ç¬¬ä¸€ä¸ªåˆ°ç¬¬nä¸ªå…ƒç´ è¿›è¡Œå€’åºåå–å‡º</li></ul><h2 id="enumerate"><a href="#enumerate" class="headerlink" title="enumerate()"></a>enumerate()</h2><p>enumerate() å‡½æ•°ç”¨äºå°†ä¸€ä¸ªå¯éå†çš„æ•°æ®å¯¹è±¡ç»„åˆæˆä¸€ä¸ªç´¢å¼•åºåˆ—ï¼ŒåŒæ—¶åˆ—å‡ºæ•°æ®å’Œæ•°æ®ä¸‹æ ‡</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">train_score <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'score'</span><span class="token punctuation">]</span><span class="token keyword">del</span> train<span class="token punctuation">[</span><span class="token string">'score'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-æ³¨æ„åŠ›æœºåˆ¶</title>
      <link href="/2022/04/02/ml-dl-zhu-yi-li-ji-zhi/"/>
      <url>/2022/04/02/ml-dl-zhu-yi-li-ji-zhi/</url>
      
        <content type="html"><![CDATA[<h2 id="æ³¨æ„åŠ›æœºåˆ¶-Attention-Mechanism"><a href="#æ³¨æ„åŠ›æœºåˆ¶-Attention-Mechanism" class="headerlink" title="æ³¨æ„åŠ›æœºåˆ¶ - Attention Mechanism"></a>æ³¨æ„åŠ›æœºåˆ¶ - Attention Mechanism</h2><h3 id="ä¸€ã€attention-è¿™é¡¹å·¥ä½œçš„å‡ºç°"><a href="#ä¸€ã€attention-è¿™é¡¹å·¥ä½œçš„å‡ºç°" class="headerlink" title="ä¸€ã€attention è¿™é¡¹å·¥ä½œçš„å‡ºç°"></a>ä¸€ã€attention è¿™é¡¹å·¥ä½œçš„å‡ºç°</h3><h3 id="äºŒã€é’ˆå¯¹æ³¨æ„åŠ›æœºåˆ¶æ‰€åŒ…å«çš„ä¸€äº›åŒºåˆ†"><a href="#äºŒã€é’ˆå¯¹æ³¨æ„åŠ›æœºåˆ¶æ‰€åŒ…å«çš„ä¸€äº›åŒºåˆ†" class="headerlink" title="äºŒã€é’ˆå¯¹æ³¨æ„åŠ›æœºåˆ¶æ‰€åŒ…å«çš„ä¸€äº›åŒºåˆ†"></a>äºŒã€é’ˆå¯¹æ³¨æ„åŠ›æœºåˆ¶æ‰€åŒ…å«çš„ä¸€äº›åŒºåˆ†</h3><p>1ã€è½¯æ³¨æ„ï¼Œä¾§é‡äºå¸å–çš„ä¿¡æ¯ç›¸å¯¹æ¥è¯´ä¼šåå‘å…¨é¢</p><p>2ã€ç¡¬æ³¨æ„ï¼Œä¼šç›´æ¥èˆå¼ƒéƒ¨åˆ†ä¿¡æ¯æ¥ä¿ç•™è®¡ç®—çš„è½»ä¾¿</p><p>3ã€è‡ªæ³¨æ„æœºåˆ¶ï¼Œç”±è¾“å…¥æƒé‡æ¥ç›¸äº’ä½œç”¨ï¼Œå…¶å®è¿™æ ·çš„çŠ¶å†µæ˜¯ç”±å†…éƒ¨æ¥å†³å®šï¼Œ</p><p>é¢„è®­ç»ƒæ¨¡å‹çœ‹èµ·æ¥å’Œ Transformer æœ‰ç€å¾ˆå¤§çš„å¹²ç³»ï¼Œå¯ä»¥è¯´æ˜¯è¯­è¨€æ¨¡å‹çš„æ ¸å¿ƒç½‘ç»œï¼Œ</p><p>transformer åœ¨æˆ‘è¿™é‡Œç»™å‡ºçš„è§£é‡Šæ˜¯ï¼Œä¸€æ®µè¯ä½œä¸ºè¾“å…¥ï¼Œé¦–å…ˆå°†è¾“å…¥ä¸­çš„å„ä¸ªè¯åœ¨self-attention æœºåˆ¶ä¸‹å˜æˆè¯å‘é‡ï¼ŒåŒæ—¶ä¼šå«æœ‰ä¸€è¿ä¸²çš„æ¯ä¸€ä¸ªè¯çš„ä½ç½®å‘é‡ ï¼ˆ ä¸è¡Œï¼Œæˆ‘å®Œå…¨æ˜¯è·Ÿç€åˆ«äººèµ°çš„ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> å¾ªç¯ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-ReadingPaper</title>
      <link href="/2022/04/02/ml-dl-readingpaper/"/>
      <url>/2022/04/02/ml-dl-readingpaper/</url>
      
        <content type="html"><![CDATA[<h2 id="Awesome-Deep-Learning-amp-Quantum-Computing"><a href="#Awesome-Deep-Learning-amp-Quantum-Computing" class="headerlink" title="Awesome Deep Learning &amp; Quantum Computing"></a>Awesome Deep Learning &amp; Quantum Computing</h2><p>æˆ‘çš„å°ä»“åº“ğŸ˜ğŸ˜ : <a href="https://www.aliyundrive.com/s/CELiSXuKc8e">https://www.aliyundrive.com/s/CELiSXuKc8e</a></p><p>ä¸é”™çš„githubåœ°å€ï¼š</p><p><u>æ·±åº¦å­¦ä¹ </u></p><p><a href="https://github.com/floodsung/Deep-Learning-Papers-Reading-Roadmap">https://github.com/floodsung/Deep-Learning-Papers-Reading-Roadmap</a></p><p><a href="https://github.com/mli/paper-reading">https://github.com/mli/paper-reading</a></p><p><u>é‡å­è®¡ç®—</u></p><p><a href="https://github.com/desireevl/awesome-quantum-computing">https://github.com/desireevl/awesome-quantum-computing</a></p>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> paper </tag>
            
            <tag> deep learning </tag>
            
            <tag> neural network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-å¾ªç¯ç¥ç»ç½‘ç»œ</title>
      <link href="/2022/03/28/ml-dl-xun-huan-shen-jing-wang-luo/"/>
      <url>/2022/03/28/ml-dl-xun-huan-shen-jing-wang-luo/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RNN </tag>
            
            <tag> å¾ªç¯ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-Pytorchå®ç°</title>
      <link href="/2022/03/26/ml-dl-pytorch-shi-xian/"/>
      <url>/2022/03/26/ml-dl-pytorch-shi-xian/</url>
      
        <content type="html"><![CDATA[<h4 id="Declaration-ï¼šå€Ÿé‰´äº†-d2l-https-zh-d2l-ai-çš„pytorchå®ç°"><a href="#Declaration-ï¼šå€Ÿé‰´äº†-d2l-https-zh-d2l-ai-çš„pytorchå®ç°" class="headerlink" title="Declaration ï¼šå€Ÿé‰´äº† d2l (https://zh.d2l.ai)çš„pytorchå®ç°"></a>Declaration ï¼šå€Ÿé‰´äº† d2l (<a href="https://zh.d2l.ai)çš„pytorchå®ç°/">https://zh.d2l.ai)çš„pytorchå®ç°</a></h4>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pytorch </tag>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-å®ä¹ æ„å‘</title>
      <link href="/2022/03/26/pe-shi-xi-yi-xiang/"/>
      <url>/2022/03/26/pe-shi-xi-yi-xiang/</url>
      
        <content type="html"><![CDATA[<p>ç›®å½•</p><ul><li><p>ä¸€ã€AI for Designç ”å‘å®ä¹ ç”Ÿ</p></li><li><p>äºŒã€Graph Neural Network Researchç ”å‘å®ä¹ ç”Ÿ</p></li><li><p>ä¸‰ã€ä¸Šæµ·AIç³»ç»Ÿç ”ç©¶å®ä¹ ç”Ÿ</p></li><li><p>å››ã€æœºå™¨å­¦ä¹ ç»„AI for Scienceå®ä¹ ç”Ÿ</p></li><li><p>äº”ã€ä¸Šæµ·AIç³»ç»Ÿå¼€å‘å®ä¹ ç”Ÿ</p></li><li><p>å…­ã€æœºå™¨å­¦ä¹ +è®¡ç®—åŒ–å­¦/è®¡ç®—ç‰©ç†ç®—æ³•å®ä¹ ç”Ÿ</p></li><li><p>ä¸ƒã€å¼ºåŒ–å­¦ä¹ ç®—æ³•åº”ç”¨å®ä¹ ç”Ÿ</p></li></ul><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>ä¸€ã€AI for Designç ”å‘å®ä¹ ç”Ÿ</p><ul><li>æ‹›è˜äººæ•°ï¼š 1-2</li><li>å·¥ä½œåœ°ç‚¹ï¼š åŒ—äº¬</li></ul><p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p><p>å¾®è½¯äºšæ´²ç ”ç©¶é™¢DKI (Data, Knowledge &amp; Intelligence) Area è‡´åŠ›äºäººå·¥æ™ºèƒ½ã€æ•°æ®åˆ†æã€æ•°æ®äº¤äº’ã€‚æ•°æ®å¯è§†åŒ–çš„ç ”ç©¶ã€‚æ¢ç´¢å…¨æ–°çš„æ•°æ®åˆ†æï¼Œå±•ç¤ºï¼Œäº¤äº’æŠ€æœ¯ï¼Œè®©æ•°æ®å’Œæ•°æ®ä¸­çš„å‘ç°æ•…äº‹è¢«é«˜æ•ˆåœ°ç†è§£ã€å¹¿æ³›åœ°ä¼ æ’­ã€‚æ•°æ®æ™ºèƒ½æ˜¯ä¸€ä¸ªå…¸å‹çš„äº¤å‰é¢†åŸŸï¼Œç»¼åˆäº†è‡ªç„¶è¯­è¨€å¤„ç†ã€å¤šç»´æ•°æ®åˆ†æã€æœºå™¨å­¦ä¹ ã€æ•°æ®å¯è§†åŒ–ã€äººæœºäº¤äº’ã€è®¡ç®—æœºè§†è§‰ç­‰å¤šä¸ªé¢†åŸŸã€‚å›¢é˜Ÿä¸å¾®è½¯æ ¸å¿ƒäº§å“ï¼ˆå¦‚Excelï¼ŒPowerPointç­‰ï¼‰æ·±åº¦åˆä½œï¼Œå¹¶å¸¸å¹´åœ¨å„ä¸ªé¢†åŸŸçš„é¡¶çº§ä¼šè®®å’ŒæœŸåˆŠä¸Šå‘è¡¨å…·æœ‰å½±å“åŠ›çš„è®ºæ–‡ã€‚</p><p><strong>é¡¹ç›®ç®€ä»‹ï¼š</strong></p><p>ä¸»è¦ä»äº‹å°†äººå·¥æ™ºèƒ½ä¸å¹³é¢è®¾è®¡ç›¸ç»“åˆçš„ç ”ç©¶å·¥ä½œï¼Œæ¢ç´¢ä½¿å¾—å¹³é¢è®¾è®¡æ›´åŠ è‡ªåŠ¨åŒ–å’Œæ™ºèƒ½åŒ–çš„æ·±åº¦å­¦ä¹ æ¨¡å‹å’Œæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªè·¨é¢†åŸŸçš„ç ”ç©¶è¯¾é¢˜ï¼Œæ¶‰åŠåˆ°æ·±åº¦å­¦ä¹ ã€è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€å¹³é¢è®¾è®¡ã€è½¯ä»¶å·¥ç¨‹ç­‰ç ”ç©¶é¢†åŸŸã€‚</p><p><strong>å·¥ä½œèŒè´£ï¼š</strong></p><ul><li>ç§¯æè·Ÿè¿›å’Œå…³æ³¨æ·±åº¦å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰çš„å‰æ²¿ç ”ç©¶</li><li>æ¨¡å‹ä¸ç®—æ³•è®¾è®¡å’Œæ”¹è¿›ï¼Œæ•°æ®çš„æ”¶é›†ä¸å¤„ç†ï¼Œå¤§è§„æ¨¡æ¨¡å‹çš„è®­ç»ƒä¸è°ƒè¯•ï¼Œå®éªŒç»“æœåˆ†æä¸æ€»ç»“ï¼Œç­‰ç­‰</li><li>æ’°å†™é«˜æ°´å¹³è®ºæ–‡</li><li>åŸå‹ç³»ç»Ÿçš„å®ç°</li></ul><p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p><ol><li>ç›¸å…³ä¸“ä¸šç¡•å£«åŠä»¥ä¸Šå…¨æ—¥åˆ¶åœ¨è¯»å­¦ç”Ÿ</li><li>ç†Ÿæ‚‰Pythonï¼Œç²¾é€š Huggingface, Fairseq, DeepSpeedç­‰DNNæ¡†æ¶ä¸å·¥å…·</li><li>æœ‰è¾ƒå¼ºçš„æ•°å­¦åŸºç¡€ï¼Œè¾ƒå¼ºçš„ç¼–ç¨‹èƒ½åŠ›ï¼Œèƒ½ç‹¬ç«‹è¿›è¡Œæ•°æ®åˆ†æ</li><li>å…·å¤‡æ·±åº¦å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰çš„ç›¸å…³çŸ¥è¯†</li><li>éœ€è¦å¯¹GANã€CLIPã€DALL-Eã€GPTã€T5ã€BARTç­‰å·¥ä½œåŠç›¸å…³ç ”ç©¶ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªéå¸¸äº†è§£</li><li>æ‹¥æœ‰è®ºæ–‡å¿«é€Ÿæ£€ç´¢å’Œé˜…è¯»èƒ½åŠ›</li><li>æœ‰åœ¨è®¡ç®—æœºè§†è§‰æˆ–NLPæ–¹å‘å›½é™…ä¼šè®®å‘è¡¨è®ºæ–‡ç»å†ï¼Œæˆ–ç¼–ç¨‹æ¯”èµ›ç»å†çš„åŒå­¦ä¼˜å…ˆã€‚</li><li>æœ‰æŠ€æœ¯ç±»åšå®¢æ–‡ç« æ’°å†™ä¹ æƒ¯çš„ä¼˜å…ˆ</li></ol><p>äºŒã€Graph Neural Network Researchç ”å‘å®ä¹ ç”Ÿ</p><ul><li>æ‹›è˜äººæ•°ï¼š 1-2</li><li>å·¥ä½œåœ°ç‚¹ï¼š åŒ—äº¬</li></ul><p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p><p>Data Analytics Researchæ˜¯å¾®è½¯äºšæ´²ç ”ç©¶é™¢DKI (Data, Knowledge &amp; Intelligence) Area ä¸‹ä¸“æ³¨äºæ•°æ®åˆ†æçš„ç ”ç©¶å›¢é˜Ÿï¼Œæ·±åº¦å‚ä¸äº†å¾®è½¯å¤šä¸ªäº§å“ï¼ˆå¦‚Excel, Forms, Bing, Azure, Power BIç­‰ï¼‰ä¸­æ•°æ®åˆ†æå’Œæ™ºèƒ½çš„ç ”å‘å·¥ä½œï¼Œæ·±åˆ»æ”¹å˜äº†äº¿ä¸‡ç”¨æˆ·åˆ†æç†è§£å„é¢†åŸŸæ•°æ®çš„æ–¹å¼ï¼Œå¹¶åœ¨æ•°æ®æŒ–æ˜ã€äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ ã€è½¯ä»¶å·¥ç¨‹ç­‰é¢†åŸŸå¸¸å¹´å‘è¡¨å…·æœ‰å½±å“åŠ›çš„å·¥ä½œã€‚</p><p><strong>é¡¹ç›®ç®€ä»‹ï¼š</strong></p><p>ä¸»è¦ä»äº‹å›¾ç¥ç»ç½‘ç»œç›¸å…³çš„ç ”ç©¶å·¥ä½œï¼Œç€çœ¼äºå›¾ç¥ç»ç½‘ç»œæ¨¡å‹çš„è®¾è®¡ä¸ç†è§£ï¼Œè‡´åŠ›äºæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ä»¥åŠå¯è§£é‡Šæ€§ï¼ŒåŒ…æ‹¬ä½†ä¸ä»…é™äºå›¾ç¥ç»ç½‘ç»œæ–°æ¶æ„è®¾è®¡ï¼Œå›¾æ¨¡å‹æ™®é€‚æ€§åˆ†æï¼ŒåŸºäºå›¾æ€§è´¨çš„é—®é¢˜ç©ºé—´åˆ’åˆ†ï¼Œå›¾è¿ç§»å­¦ä¹ ï¼Œç­‰ç­‰ã€‚æ­¤å¤–ï¼ŒåŸºäºå¯¹å›¾æ¨¡å‹çš„ç†è§£ï¼Œæˆ‘ä»¬ä¹Ÿæ¢ç´¢å›¾ç½‘ç»œåœ¨æ›´å¹¿æ³›é—®é¢˜åœºæ™¯ä¸‹çš„åº”ç”¨å‰æ™¯ï¼Œç”¨å›¾ç½‘ç»œæŠ€æœ¯èµ‹èƒ½æ›´å¤šé¢†åŸŸã€‚</p><p><strong>å·¥ä½œèŒè´£ï¼š</strong></p><ul><li>ç§¯æè·Ÿè¿›å’Œå…³æ³¨å›¾ç½‘ç»œå­¦ä¹ çš„å‰æ²¿ç ”ç©¶</li><li>è¿›è¡Œå›¾ç½‘ç»œæ¨¡å‹ç ”ç©¶ï¼ŒåŒ…æ‹¬è®¾è®¡æ–°çš„å›¾æ¨¡å‹æ¶æ„ä¸å­¦ä¹ ç®—æ³•ï¼Œå›¾æ¨¡å‹å¯è§£é‡Šæ€§ç ”ç©¶ï¼Œæ–°é¢†åŸŸä¸‹çš„å›¾æ¨¡å‹åº”ç”¨ï¼Œç­‰ç­‰</li><li>æ’°å†™é«˜æ°´å¹³è®ºæ–‡å¹¶åœ¨é¡¶çº§ä¼šè®®å’ŒæœŸåˆŠä¸Šè¿›è¡Œå‘è¡¨</li></ul><p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p><ol><li>ç†Ÿæ‚‰Pythonï¼Œç²¾é€š Pytorchæˆ–Tensorflow</li><li>å…·å¤‡æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ çš„ç›¸å…³çŸ¥è¯†</li><li>æ‹¥æœ‰è®ºæ–‡å¿«é€Ÿæ£€ç´¢å’Œé˜…è¯»èƒ½åŠ›</li><li>æœ‰åœ¨å›½é™…ä¼šè®®å‘è¡¨è®ºæ–‡ç»å†ã€ACMæˆ–å…¶ä»–ç¼–ç¨‹æ¯”èµ›ç»å†çš„åŒå­¦ä¼˜å…ˆã€‚</li></ol><p>ä¸‰ã€ä¸Šæµ·AIç³»ç»Ÿç ”ç©¶å®ä¹ ç”Ÿ</p><ul><li>æ‹›è˜äººæ•°ï¼š 2-4</li><li>å·¥ä½œåœ°ç‚¹ï¼š ä¸Šæµ·</li></ul><p><strong>å·¥ä½œèŒè´£ï¼š</strong></p><p>åœ¨ MSRAç ”ç©¶å‘˜ä»¬çš„æŒ‡å¯¼ä¸‹ï¼Œè¿›è¡Œäººå·¥æ™ºèƒ½ç³»ç»Ÿå‰æ²¿æŠ€æœ¯çš„ç ”ç©¶ï¼Œå…·ä½“ç ”ç©¶æ–¹å‘åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>é’ˆå¯¹å¤§æ¨¡å‹ã€ç³»æ•°æ¨¡å‹ã€åŠ¨æ€æ¨¡å‹ç­‰å‰æ²¿æ¨¡å‹çš„è®­ç»ƒåŠæ¨ç†ä¼˜åŒ–</li><li>é’ˆå¯¹å„ç§ç«¯ä¾§å’Œäº‘ä¾§è®¾å¤‡è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²ä¼˜åŒ–ï¼ŒåŒ…æ‹¬ç¼–è¯‘ä¼˜åŒ–ï¼Œæ¨¡å‹æ¶æ„ä¼˜åŒ–ä¸å‹ç¼©ï¼Œé¢å‘ç¡¬ä»¶çš„é«˜æ•ˆæ¨¡å‹è®¾è®¡ç­‰</li><li>é¢å‘æ·±åº¦å­¦ä¹ è´Ÿè½½çš„é›†ç¾¤è®¾è®¡ï¼ŒåŒ…æ‹¬è°ƒåº¦ä¼˜åŒ–ï¼Œæ•°æ®ä¸é€šä¿¡ä¼˜åŒ–ç­‰</li></ul><p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p><ul><li>ç¡•å£«æˆ–åšå£«ç ”ç©¶ç”Ÿï¼Œä¸“ä¸šä¸ºè®¡ç®—æœºã€ç”µå­ä¿¡æ¯ç­‰ç›¸å…³ä¸“ä¸šï¼Œå…·æœ‰è¾ƒå¼ºçš„è‹±æ–‡å¬è¯´è¯»å†™èƒ½åŠ›ã€‚</li><li>æœ‰å¼ºçƒˆçš„æ„æ„¿åšä¸–ç•Œå…ˆè¿›çš„ç§‘å­¦ç ”ç©¶å¹¶ä¸”åœ¨é¡¶çº§ä¼šè®®æˆ–æœŸåˆŠå‘è¡¨è®ºæ–‡ã€‚</li><li>å…·å¤‡è‰¯å¥½çš„åŠ¨æ‰‹èƒ½åŠ›ï¼Œä»¥åŠåˆ†æé—®é¢˜è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¿«é€Ÿåœ°è§„åˆ’å‡ºè§£å†³æ–¹æ¡ˆï¼Œå¹¶è¿›è¡ŒéªŒè¯</li><li>æœ‰å›¢é˜Ÿåä½œç²¾ç¥ï¼Œæœ‰è´£ä»»å¿ƒ</li></ul><p><strong>åŠ åˆ†é¡¹ï¼š</strong></p><ul><li>æœ‰æ·±åº¦å­¦ä¹ åŸºç¡€ï¼Œè‡³å°‘å¯¹ä¸€ç§æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆPyTorch ä¼˜å…ˆï¼ŒTensorFlowç­‰ï¼‰å…·æœ‰æ·±å…¥ç†è§£ï¼›å¯¹AIç®—æ³•æœ‰ä¸€å®šäº†è§£ï¼Œæœ‰åœ¨ç›¸å…³é¢†åŸŸé¡¶ä¼šä¸Šå‘è¡¨è¿‡è®ºæ–‡è€…ä¼˜å…ˆ</li><li>å¯¹GPUæ¶æ„å…·æœ‰ä¸€å®šäº†è§£ï¼Œå¹¶æœ‰ä¼˜åŒ–ç»éªŒè€…ä¼˜å…ˆ</li><li>å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿæˆ–æ•°æ®åº“ç³»ç»Ÿæœ‰ä¸€å®šåŸºç¡€ï¼Œå…·æœ‰ç›¸å…³ç ”ç©¶ç»éªŒè€…ä¼˜å…ˆ</li><li>å…·æœ‰AIåŠ é€Ÿå™¨ï¼ˆASIC/FPGAç­‰ï¼‰ç ”ç©¶ç»éªŒè€…ä¼˜å…ˆ</li><li>å‚åŠ è¿‡å­¦æœ¯ç•Œå·¥ä¸šç•Œæœºå™¨å­¦ä¹ ç›¸å…³æ¯”èµ›ï¼ŒCCPC/ICPC ç­‰ç¨‹åºè®¾è®¡ç«èµ›ï¼Œç”µå­è®¾è®¡å¤§èµ›ç­‰ç«èµ›å¹¶è·å¾—ä¼˜å¼‚æˆç»©è€…ä¼˜å…ˆ</li><li></li></ul><p>å››ã€æœºå™¨å­¦ä¹ ç»„AI for Scienceå®ä¹ ç”Ÿ</p><ul><li>æ‹›è˜äººæ•°ï¼š 3-5</li><li>å·¥ä½œåœ°ç‚¹ï¼š åŒ—äº¬</li></ul><p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p><p>å¾®è½¯äºšæ´²ç ”ç©¶é™¢æœºå™¨å­¦ä¹ ç»„è‡´åŠ›äºä»ç®—æ³•ã€åº”ç”¨å’Œç†è®ºå±‚é¢æ¨è¿›äººå·¥æ™ºèƒ½å‰æ²¿ç ”ç©¶ï¼ŒåŠ é€Ÿäººå·¥æ™ºèƒ½åœ¨è‡ªç„¶ç§‘å­¦å’Œäº§ä¸šåº”ç”¨ä¸­çš„æ¢ç´¢ã€‚æœºå™¨å­¦ä¹ ç»„å¼€å‘äº†Graphormerï¼ŒLightGBMç­‰å¤šä¸ªå—æ¬¢è¿çš„å¼€æºå·¥å…·åŒ…ï¼Œå¤šæ¬¡å¤ºå¾—å›½é™…æ¯”èµ›å† å†›ï¼Œå¹¶æŒç»­äº§å‡ºé«˜è´¨é‡å­¦æœ¯è®ºæ–‡ã€‚</p><p><strong>å·¥ä½œèŒè´£ï¼š</strong></p><p>å‚ä¸AI for Scienceé¡¹ç›®ç§‘ç ”é¡¹ç›®ï¼Œæ’°å†™é«˜è´¨é‡è®ºæ–‡ï¼Œå®Œæˆå‰æ²¿ç®—æ³•çš„è½åœ°ä¸éƒ¨ç½²ï¼Œå¼€å‘ã€ç»´æŠ¤å¼€æºå·¥å…·åŒ…ã€‚å…·ä½“æ–¹å‘åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ol><li>åŸºäºæ·±åº¦å­¦ä¹ çš„åˆ†å­æ¨¡æ‹Ÿï¼Œå¦‚åˆ†å­åŠ¨åŠ›å­¦ï¼Œåˆ†å­æ€§è´¨é¢„æµ‹ï¼Œåˆ†å­ç”Ÿæˆï¼Œé€†åˆæˆç­‰ã€‚</li><li>æ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨ç®—æ³•åŠç†è®ºå±‚é¢çš„åˆ›æ–°ï¼Œå¦‚å›¾ç¥ç»ç½‘ç»œã€å¤§è§„æ¨¡é¢„è®­ç»ƒç®—æ³•ç­‰ã€‚</li><li>æ·±åº¦å­¦ä¹ åœ¨ææ–™å‘ç°ã€è¯ç‰©å‘ç°ç­‰ä¸­çš„åº”ç”¨ã€‚</li><li>æœºå™¨å­¦ä¹ ä¸æ¹¿å®éªŒç›¸ç»“åˆã€‚</li><li>ä½¿ç”¨æœºå™¨å­¦ä¹ åŠ é€Ÿå¯†åº¦æ³›å‡½ç†è®ºç­‰ã€‚</li></ol><p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p><ol><li>æ‰å®çš„æ•°ç†åŸºç¡€çŸ¥è¯†ã€‚</li><li>ä»»ä¸€ç›¸å…³æ–¹å‘æ‰å®çš„èƒŒæ™¯çŸ¥è¯†ã€‚</li><li>ç†Ÿç»ƒä½¿ç”¨PyTorch/Tensorflowç­‰æ·±åº¦å­¦ä¹ åº“ã€‚</li></ol><p>åŠ åˆ†é¡¹ï¼š</p><ol><li>æœ‰æœºå™¨å­¦ä¹ æ–¹å‘é¡¶ä¼šè®ºæ–‡å‘è¡¨ã€‚æˆ–</li><li>æœ‰ä¸°å¯Œçš„è®¡ç®—ç‰©ç†ã€åŒ–å­¦ã€ç”Ÿç‰©çŸ¥è¯†ï¼Œä¼šç†Ÿç»ƒä½¿ç”¨ç›¸å…³é‡å­åŒ–å­¦è½¯ä»¶ç­‰ã€‚</li><li>å®ä¹ æ—¶é—´ä¸€å¹´åŠä»¥ä¸Šã€‚</li></ol><p>äº”ã€ä¸Šæµ·AIç³»ç»Ÿå¼€å‘å®ä¹ ç”Ÿ</p><ul><li>æ‹›è˜äººæ•°ï¼š 2-4</li><li>å·¥ä½œåœ°ç‚¹ï¼š ä¸Šæµ·</li></ul><p><strong>å·¥ä½œèŒè´£ï¼š</strong></p><p>ä¸ MSRAçš„ç ”ç©¶å‘˜ä»¬åˆä½œï¼Œå…±åŒç ”ç©¶AIå‰æ²¿æŠ€æœ¯ï¼Œè®¾è®¡å¼€å‘äººå·¥æ™ºèƒ½ç³»ç»Ÿä¸å·¥å…·ï¼Œç»´æŠ¤å¼€æºé¡¹ç›®ï¼Œå¹¶å°†å¼€å‘æˆæœåº”ç”¨äºå®é™…åœºæ™¯ã€‚å…¶å…·ä½“å†…å®¹åŒ…æ‹¬ï¼š</p><ul><li>åœ¨æ·±å…¥ç†è§£å‰æ²¿ç®—æ³•ï¼ˆå¦‚NASï¼ŒModel Compressionï¼Œsparsityï¼‰çš„åŸºç¡€ä¸Šï¼Œæ¢ç´¢æœªæ¥çš„å‘å±•æ–¹å‘</li><li>å‚ä¸MSRA å¼€æºé¡¹ç›®ï¼ˆå¦‚ NNIã€nn-meterç­‰ï¼‰çš„è®¾è®¡å’Œå¼€å‘ï¼ŒåŒ…æ‹¬æ¥å£è®¾è®¡ï¼Œç®—æ³•å®ç°ï¼Œç”¨æˆ·äº¤äº’ç­‰</li><li>ä¸å›¢é˜Ÿåˆä½œæ¢ç´¢é¡¹ç›®çš„æ›´å¤šåº”ç”¨åœºæ™¯ï¼Œå¹¶å°†ç³»ç»Ÿä¸å·¥å…·è¿ç”¨äºå®é™…äº§å“ä¸­</li></ul><p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p><ul><li>æœ‰è®¡ç®—æœºç§‘å­¦ã€æ•°æ®ç§‘å­¦æˆ–ç›¸å…³ä¸“ä¸šèƒŒæ™¯ï¼Œæœ¬ç§‘åŠä»¥ä¸Šå­¦å†åœ¨æ ¡å­¦ç”Ÿ</li><li>æœ‰ Pythonç­‰è¯­è¨€çš„ç¼–ç¨‹ç»éªŒï¼Œå¯¹ Tensorflow/PyTorch ç­‰æ·±åº¦å­¦ä¹ æ¡†æ¶æœ‰ä¸€å®šäº†è§£</li><li>å…·å¤‡è‰¯å¥½çš„å·¥ç¨‹èƒ½åŠ›ï¼Œä»¥åŠåˆ†æé—®é¢˜è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¿«é€Ÿåœ°è§„åˆ’å‡ºè§£å†³æ–¹æ¡ˆï¼Œå¹¶å°†æƒ³æ³•è½åœ°</li><li>æœ‰å›¢é˜Ÿåä½œç²¾ç¥ï¼Œæœ‰è´£ä»»å¿ƒ</li></ul><p><strong>åŠ åˆ†é¡¹ï¼š</strong></p><ul><li>å¯¹AIç®—æ³•ï¼ˆAutoML/NAS/Compressionç­‰ï¼‰æœ‰ä¸€å®šäº†è§£ï¼Œæœ‰åœ¨ç›¸å…³é¢†åŸŸé¡¶ä¼šä¸Šå‘è¡¨è¿‡è®ºæ–‡è€…ä¼˜å…ˆ</li><li>å‚åŠ è¿‡å­¦æœ¯ç•Œå·¥ä¸šç•Œæœºå™¨å­¦ä¹ ç›¸å…³æ¯”èµ›å¹¶è·å¾—ä¼˜å¼‚æˆç»©è€…ä¼˜å…ˆ</li><li>å…·æœ‰æ·±åº¦å­¦ä¹ é¡¹ç›®ç»éªŒè€…ä¼˜å…ˆï¼Œç†Ÿæ‚‰åˆ†å¸ƒå¼è®­ç»ƒè€…ä¼˜å…ˆ</li><li>æœ‰ CCPC/ICPC ç­‰ç¨‹åºè®¾è®¡ç«èµ›çš„è·å¥–ç»å†è€…ä¼˜å…ˆ</li><li>æœ‰å¼€æºé¡¹ç›®å¼€å‘æˆ–ç»´æŠ¤ç»å†è€…ä¼˜å…ˆ</li></ul><p>å…­ã€æœºå™¨å­¦ä¹ +è®¡ç®—åŒ–å­¦/è®¡ç®—ç‰©ç†ç®—æ³•å®ä¹ ç”Ÿ</p><ul><li>æ‹›è˜äººæ•°ï¼š 2-4</li></ul><p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p><p>å¾®è½¯äºšæ´²ç ”ç©¶é™¢æœºå™¨å­¦ä¹ é¢†åŸŸä»ç†è®ºã€ç®—æ³•ã€åº”ç”¨ç­‰ä¸åŒå±‚é¢æ¨åŠ¨æœºå™¨å­¦ä¹ çš„å‰æ²¿ã€‚æˆ‘ä»¬çš„ç ”ç©¶å…´è¶£åŒ…å«ï¼šæ·±åº¦å­¦ä¹ ã€å¼ºåŒ–å­¦ä¹ ã€å›¾å­¦ä¹ ã€æ¢¯åº¦æå‡æ ‘ã€åœ¨çº¿å­¦ä¹ ã€é¢„è®­ç»ƒã€åŠ¨æ€å­¦ä¹ ã€å­¦ä¹ ç†è®ºç­‰ã€‚åŒæ—¶ï¼Œ æˆ‘ä»¬ä¹Ÿåœ¨ç§¯ææ¢ç´¢äººå·¥æ™ºèƒ½åœ¨è‡ªç„¶ç§‘å­¦å’Œäº§ä¸šåº”ç”¨ä¸­çš„ä»·å€¼ï¼Œä»è€Œä¸ºç§‘å­¦å·¥ä½œè€…å’Œä¼ ç»Ÿå·¥ä¸šèµ‹èƒ½ï¼ˆå…·ä½“è§ç ”ç©¶æ¦‚å†µï¼‰ã€‚åœ¨è¿‡å»çš„åå‡ å¹´é—´ï¼Œæˆ‘ä»¬åœ¨é¡¶çº§å›½é™…ä¼šè®®å’ŒæœŸåˆŠä¸Šå‘è¡¨äº†å¤§é‡è¢«é«˜åº¦å¼•ç”¨çš„é«˜è´¨é‡è®ºæ–‡ï¼Œå‘å¾®è½¯çš„äº§å“éƒ¨é—¨è½¬åŒ–äº†å¤§é‡æ ¸å¿ƒæŠ€æœ¯ï¼Œå¹¶å¸®åŠ©ä¼—å¤šçš„ä¼ä¸šåˆä½œä¼™ä¼´å®ç°äº†æ•°å­—åŒ–è½¬å‹ã€‚æˆ‘ä»¬ä¹Ÿå‘å¼€æºç¤¾åŒºè´¡çŒ®äº†å¤§é‡é«˜è´¨é‡å¼€æºå·¥å…·ï¼Œä¾‹å¦‚ LightGBMã€LigthLDAã€å¾®è½¯å›¾å¼•æ“ï¼Œå¤šæ™ºèƒ½ä½“èµ„æºä¼˜åŒ–å¹³å°â€œç¾¤ç­– MAROâ€œï¼Œä¸šå†…é¦–ä¸ªAIé‡åŒ–æŠ•èµ„å¹³å°â€œå¾®çŸ¿Qlibâ€ï¼Œä»¥åŠæœ€æ–°çš„æ—¶ç©ºé¢„æµ‹å¹³å°â€FOSTâ€ã€‚</p><p><strong>å·¥ä½œèŒè´£ï¼š</strong></p><ol><li>å¤ç°å·²æœ‰è®ºæ–‡</li><li>æ”¹è¿›ç°æœ‰ä»£ç ã€æ€§èƒ½ä¼˜åŒ–</li></ol><p>å·¥ä½œæ–¹å‘ï¼ˆé€‰å…¶ä¸€ï¼‰</p><ul><li>åˆ©ç”¨å›¾ç¥ç»ç½‘ç»œç­‰ç›¸å…³æ–¹æ³•è¿›è¡Œåˆ†å­ææ–™è¡¨å¾</li><li>ä½¿ç”¨ç”Ÿæˆæ¨¡å‹ã€å¼ºåŒ–å­¦ä¹ ç­‰æ–¹æ³•å®Œæˆåˆ†å­ææ–™è®¾è®¡</li><li>åˆ©ç”¨ç¥ç»ç½‘ç»œåŠ é€Ÿåå¾®åˆ†æ–¹ç¨‹æ±‚è§£</li><li>åˆ©ç”¨ç¥ç»ç½‘ç»œå®Œæˆç§¯åˆ†æ–¹ç¨‹æ±‚è§£</li><li>åˆ©ç”¨cudaè¯­è¨€åŠ é€Ÿ</li></ul><p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p><ol><li>è®¡ç®—æœºã€ç”µå­ã€åŒ–å­¦ã€ç‰©ç†æˆ–ç›¸å…³ä¸“ä¸šï¼ˆæœ¬ç§‘/ç¡•å£«/åšå£«ï¼‰</li><li>æ‰å®çš„æ•°æ®ç»“æ„/ç®—æ³•åŸºç¡€</li><li>ç†Ÿæ‚‰å¸¸è§çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç†Ÿæ‚‰ä½¿ç”¨PyTorchæˆ–TensorFlowç­‰</li><li>ç†Ÿç»ƒçš„ç¼–ç¨‹èƒ½åŠ›</li><li>å¿«é€Ÿå­¦ä¹ èƒ½åŠ›,è‰¯å¥½çš„æ²Ÿé€šä¸åˆä½œèƒ½åŠ›</li></ol><p>ä¸ƒã€å¼ºåŒ–å­¦ä¹ ç®—æ³•åº”ç”¨å®ä¹ ç”Ÿ</p><ul><li>æ‹›è˜äººæ•°ï¼š 2-4</li></ul><p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p><p>å¾®è½¯äºšæ´²ç ”ç©¶é™¢æœºå™¨å­¦ä¹ é¢†åŸŸä»ç†è®ºã€ç®—æ³•ã€åº”ç”¨ç­‰ä¸åŒå±‚é¢æ¨åŠ¨æœºå™¨å­¦ä¹ çš„å‰æ²¿ã€‚æˆ‘ä»¬çš„ç ”ç©¶å…´è¶£åŒ…å«ï¼šæ·±åº¦å­¦ä¹ ã€å¼ºåŒ–å­¦ä¹ ã€å›¾å­¦ä¹ ã€æ¢¯åº¦æå‡æ ‘ã€åœ¨çº¿å­¦ä¹ ã€é¢„è®­ç»ƒã€åŠ¨æ€å­¦ä¹ ã€å­¦ä¹ ç†è®ºç­‰ã€‚åŒæ—¶ï¼Œ æˆ‘ä»¬ä¹Ÿåœ¨ç§¯ææ¢ç´¢äººå·¥æ™ºèƒ½åœ¨è‡ªç„¶ç§‘å­¦å’Œäº§ä¸šåº”ç”¨ä¸­çš„ä»·å€¼ï¼Œä»è€Œä¸ºç§‘å­¦å·¥ä½œè€…å’Œä¼ ç»Ÿå·¥ä¸šèµ‹èƒ½ï¼ˆå…·ä½“è§ç ”ç©¶æ¦‚å†µï¼‰ã€‚åœ¨è¿‡å»çš„åå‡ å¹´é—´ï¼Œæˆ‘ä»¬åœ¨é¡¶çº§å›½é™…ä¼šè®®å’ŒæœŸåˆŠä¸Šå‘è¡¨äº†å¤§é‡è¢«é«˜åº¦å¼•ç”¨çš„é«˜è´¨é‡è®ºæ–‡ï¼Œå‘å¾®è½¯çš„äº§å“éƒ¨é—¨è½¬åŒ–äº†å¤§é‡æ ¸å¿ƒæŠ€æœ¯ï¼Œå¹¶å¸®åŠ©ä¼—å¤šçš„ä¼ä¸šåˆä½œä¼™ä¼´å®ç°äº†æ•°å­—åŒ–è½¬å‹ã€‚æˆ‘ä»¬ä¹Ÿå‘å¼€æºç¤¾åŒºè´¡çŒ®äº†å¤§é‡é«˜è´¨é‡å¼€æºå·¥å…·ï¼Œä¾‹å¦‚ LightGBMã€LigthLDAã€å¾®è½¯å›¾å¼•æ“ï¼Œå¤šæ™ºèƒ½ä½“èµ„æºä¼˜åŒ–å¹³å°â€œç¾¤ç­– MAROâ€œï¼Œä¸šå†…é¦–ä¸ªAIé‡åŒ–æŠ•èµ„å¹³å°â€œå¾®çŸ¿Qlibâ€ï¼Œä»¥åŠæœ€æ–°çš„æ—¶ç©ºé¢„æµ‹å¹³å°â€FOSTâ€ã€‚</p><p><strong>å·¥ä½œèŒè´£ï¼š</strong></p><ol><li>ç§¯æè·Ÿè¿›å’Œå…³æ³¨å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„å‰æ²¿ç ”ç©¶ï¼›</li><li>å‚ä¸æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç‰¹åˆ«æ˜¯å¼ºåŒ–å­¦ä¹ ç›¸å…³ç®—æ³•çš„ç ”ç©¶ï¼›</li><li>å‚ä¸å¼ºåŒ–å­¦ä¹ ç®—æ³•åœ¨ç‰©æµã€èƒ½æºã€å·¥ä¸šæ§åˆ¶ç­‰é¢†åŸŸçš„è½åœ°åº”ç”¨ã€‚</li></ol><p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p><ol><li>è®¡ç®—æœºæˆ–ç›¸å…³ä¸“ä¸šç¡•å£«æˆ–ä»¥ä¸Šå­¦å†ï¼Œæœ‰è¾ƒå¼ºç¼–ç¨‹èƒ½åŠ›çš„ä¼˜ç§€æœ¬ç§‘ç”Ÿä¹Ÿæ¬¢è¿ç”³è¯·ï¼›</li><li>å…·å¤‡è‰¯å¥½çš„æ•°å­¦åŸºç¡€ï¼Œæœºå™¨å­¦ä¹ çŸ¥è¯†ï¼›</li><li>å…·æœ‰è¾ƒå¼ºçš„ç¼–ç¨‹å®ç°èƒ½åŠ›ï¼Œè‰¯å¥½çš„æ²Ÿé€šèƒ½åŠ›å’Œå›¢é˜Ÿåä½œç²¾ç¥ï¼›</li><li>åŠ åˆ†é¡¹ï¼šæœ‰å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„å¼€å‘å’Œç ”ç©¶ç»å†ï¼›é¡¶çº§AIä¼šè®®æ–‡ç« ï¼›ç†Ÿç»ƒæŒæ¡æ·±åº¦å­¦ä¹ æ¡†æ¶(PyTorch, TensorFlow ç­‰)ï¼›æœ‰å¼€æºè½¯ä»¶å¼€å‘ç»å†ç­‰ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MSRA </tag>
            
            <tag> å¾®è½¯äºšæ´²ç ”ç©¶é™¢ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-å·ç§¯ç¥ç»ç½‘ç»œ</title>
      <link href="/2022/03/26/ml-dl-juan-ji-shen-jing-wang-luo/"/>
      <url>/2022/03/26/ml-dl-juan-ji-shen-jing-wang-luo/</url>
      
        <content type="html"><![CDATA[<h3 id="ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œçš„è¯ç”Ÿ"><a href="#ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œçš„è¯ç”Ÿ" class="headerlink" title="ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œçš„è¯ç”Ÿ"></a>ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œçš„è¯ç”Ÿ</h3><p>1.å¯¹è¯¥ç±»å‹ç½‘ç»œçš„ç ”ç©¶éƒ½æºäºå…¶ä»–äººçš„ï¼Œä¸€æ ·çš„å†…å®¹å°±ä¸åœ¨è¿‡å¤šçš„èµ˜è¿°ï¼š[å›¾åƒå­¦çš„å†…å®¹ä¸å¤ªæ„Ÿå…´è¶£]</p><p>ä¸»è¦ç”¨é€”ï¼šå¤„ç†å›¾åƒæ•°æ®ã€è¡¨æ ¼æ•°æ®ç­‰ç­‰</p><p><u>ç«èµ›å¯é€‰æ‹©ï¼šå›¾åƒè¯†åˆ«ï¼Œç›®æ ‡æ£€æµ‹-è¾¹ç¼˜æ£€æµ‹ï¼Œè¯­ä¹‰åˆ†å‰²</u></p><p>åœ¨å¯¹ DNN çš„æ¶æ„æ·»åŠ äº† å·ç§¯ layer åå°±æ˜¯ CNN ï¼Œè¿™å°±æ˜¯ CNN çš„ç”±æ¥ï¼Œä½† å·ç§¯çš„æ“ä½œæ–¹å¼æœ‰äº›å¥‡æ€ªçš„è¡Œä¸ºè®©äººå¤§è·Œçœ¼é•œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># æ„é€ ä¸€ä¸ªäºŒç»´å·ç§¯å±‚ï¼Œå®ƒå…·æœ‰1ä¸ªè¾“å‡ºé€šé“å’Œå½¢çŠ¶ä¸ºï¼ˆ1ï¼Œ2ï¼‰çš„å·ç§¯æ ¸</span><span class="token comment"># äºŒç»´å·ç§¯æ ¸ å‚æ•°å½¢å¼ (æ‰¹é‡å¤§å°ï¼Œé€šé“ï¼Œé«˜åº¦ï¼Œå®½åº¦)</span>conv2d <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç‰¹æ€§ï¼šç©ºé—´ä¸å˜æ€§</p><ol><li><em>å¹³ç§»ä¸å˜æ€§</em>ï¼ˆtranslation invarianceï¼‰ï¼šä¸ç®¡æ£€æµ‹å¯¹è±¡å‡ºç°åœ¨å›¾åƒä¸­çš„å“ªä¸ªä½ç½®ï¼Œç¥ç»ç½‘ç»œçš„å‰é¢å‡ å±‚åº”è¯¥å¯¹ç›¸åŒçš„å›¾åƒåŒºåŸŸå…·æœ‰ç›¸ä¼¼çš„ååº”ï¼Œå³ä¸ºâ€œå¹³ç§»ä¸å˜æ€§â€ã€‚</li><li><em>å±€éƒ¨æ€§</em>ï¼ˆlocalityï¼‰ï¼šç¥ç»ç½‘ç»œçš„å‰é¢å‡ å±‚åº”è¯¥åªæ¢ç´¢è¾“å…¥å›¾åƒä¸­çš„å±€éƒ¨åŒºåŸŸï¼Œè€Œä¸è¿‡åº¦åœ¨æ„å›¾åƒä¸­ç›¸éš”è¾ƒè¿œåŒºåŸŸçš„å…³ç³»ï¼Œè¿™å°±æ˜¯â€œå±€éƒ¨æ€§â€åŸåˆ™ã€‚æœ€ç»ˆï¼Œå¯ä»¥èšåˆè¿™äº›å±€éƒ¨ç‰¹å¾ï¼Œä»¥åœ¨æ•´ä¸ªå›¾åƒçº§åˆ«è¿›è¡Œé¢„æµ‹ã€‚</li></ol><p>è¾“å‡ºçš„å·ç§¯å±‚ &gt; ç‰¹å¾æ˜ å°„</p><p>æ„Ÿå—é‡ï¼šæŒ‡å‰å‘ä¼ æ’­ä¸­å¯èƒ½å½±å“ x è®¡ç®—çš„æ‰€æœ‰å…ƒç´ </p><p>2ã€å·ç§¯ç¥ç»ç½‘ç»œä¹‹LeNet</p><p>LeNetï¼ˆLeNet-5ï¼‰ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p><ul><li>å·ç§¯ç¼–ç å™¨ï¼šç”±ä¸¤ä¸ªå·ç§¯å±‚ç»„æˆ;</li><li>å…¨è¿æ¥å±‚å¯†é›†å—ï¼šç”±ä¸‰ä¸ªå…¨è¿æ¥å±‚ç»„æˆã€‚</li></ul><p><img src="/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/lenet.svg" alt="lenet"></p><h4 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><ul><li>å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æ˜¯ä¸€ç±»ä½¿ç”¨å·ç§¯å±‚çš„ç½‘ç»œã€‚</li><li>åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬ç»„åˆä½¿ç”¨å·ç§¯å±‚ã€éçº¿æ€§æ¿€æ´»å‡½æ•°å’Œæ±‡èšå±‚ã€‚</li><li>ä¸ºäº†æ„é€ é«˜æ€§èƒ½çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬é€šå¸¸å¯¹å·ç§¯å±‚è¿›è¡Œæ’åˆ—ï¼Œé€æ¸é™ä½å…¶è¡¨ç¤ºçš„ç©ºé—´åˆ†è¾¨ç‡ï¼ŒåŒæ—¶å¢åŠ é€šé“æ•°ã€‚</li><li>åœ¨ä¼ ç»Ÿçš„å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œå·ç§¯å—ç¼–ç å¾—åˆ°çš„è¡¨å¾åœ¨è¾“å‡ºä¹‹å‰éœ€ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå…¨è¿æ¥å±‚è¿›è¡Œå¤„ç†ã€‚</li><li>LeNetæ˜¯æœ€æ—©å‘å¸ƒçš„å·ç§¯ç¥ç»ç½‘ç»œä¹‹ä¸€ã€‚</li></ul><h4 id="è€ƒæŸ¥"><a href="#è€ƒæŸ¥" class="headerlink" title="è€ƒæŸ¥"></a>è€ƒæŸ¥</h4><ol><li><p>å°†å¹³å‡æ±‡èšå±‚æ›¿æ¢ä¸ºæœ€å¤§æ±‡èšå±‚ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></li><li><p>å°è¯•æ„å»ºä¸€ä¸ªåŸºäºLeNetçš„æ›´å¤æ‚çš„ç½‘ç»œï¼Œä»¥æé«˜å…¶å‡†ç¡®æ€§ã€‚</p><ol><li>è°ƒæ•´å·ç§¯çª—å£å¤§å°ã€‚</li><li>è°ƒæ•´è¾“å‡ºé€šé“çš„æ•°é‡ã€‚</li><li>è°ƒæ•´æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ReLUï¼‰ã€‚</li><li>è°ƒæ•´å·ç§¯å±‚çš„æ•°é‡ã€‚</li><li>è°ƒæ•´å…¨è¿æ¥å±‚çš„æ•°é‡ã€‚</li><li>è°ƒæ•´å­¦ä¹ ç‡å’Œå…¶ä»–è®­ç»ƒç»†èŠ‚ï¼ˆä¾‹å¦‚ï¼Œåˆå§‹åŒ–å’Œè½®æ•°ï¼‰ã€‚</li></ol></li><li><p>åœ¨MNISTæ•°æ®é›†ä¸Šå°è¯•ä»¥ä¸Šæ”¹è¿›çš„ç½‘ç»œã€‚</p></li><li><p>æ˜¾ç¤ºä¸åŒè¾“å…¥ï¼ˆä¾‹å¦‚æ¯›è¡£å’Œå¤–å¥—ï¼‰æ—¶ï¼ŒLeNetç¬¬ä¸€å±‚å’Œç¬¬äºŒå±‚çš„æ¿€æ´»å€¼ã€‚</p></li></ol><h2 id="äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ"><a href="#äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ" class="headerlink" title="äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ"></a>äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ</h2><h3 id="1ã€AlexNet"><a href="#1ã€AlexNet" class="headerlink" title="1ã€AlexNet"></a>1ã€AlexNet</h3><ul><li><p>AlexNetã€‚å®ƒæ˜¯ç¬¬ä¸€ä¸ªåœ¨å¤§è§„æ¨¡è§†è§‰ç«èµ›ä¸­å‡»è´¥ä¼ ç»Ÿè®¡ç®—æœºè§†è§‰æ¨¡å‹çš„å¤§å‹ç¥ç»ç½‘ç»œï¼›</p></li><li><p>ä½¿ç”¨é‡å¤å—çš„ç½‘ç»œï¼ˆVGGï¼‰ã€‚å®ƒåˆ©ç”¨è®¸å¤šé‡å¤çš„ç¥ç»ç½‘ç»œå—ï¼›</p></li><li><p>ç½‘ç»œä¸­çš„ç½‘ç»œï¼ˆNiNï¼‰ã€‚å®ƒé‡å¤ä½¿ç”¨ç”±å·ç§¯å±‚å’Œ1Ã—1å·ç§¯å±‚ï¼ˆç”¨æ¥ä»£æ›¿å…¨è¿æ¥å±‚ï¼‰æ¥æ„å»ºæ·±å±‚ç½‘ç»œ;</p></li><li><p>å«å¹¶è¡Œè¿ç»“çš„ç½‘ç»œï¼ˆGoogLeNetï¼‰ã€‚å®ƒä½¿ç”¨å¹¶è¡Œè¿ç»“çš„ç½‘ç»œï¼Œé€šè¿‡ä¸åŒçª—å£å¤§å°çš„å·ç§¯å±‚å’Œæœ€å¤§æ±‡èšå±‚æ¥å¹¶è¡ŒæŠ½å–ä¿¡æ¯ï¼›</p></li><li><p>æ®‹å·®ç½‘ç»œï¼ˆResNetï¼‰ã€‚å®ƒé€šè¿‡æ®‹å·®å—æ„å»ºè·¨å±‚çš„æ•°æ®é€šé“ï¼Œæ˜¯è®¡ç®—æœºè§†è§‰ä¸­æœ€æµè¡Œçš„ä½“ç³»æ¶æ„ï¼›</p></li><li><p>ç¨ å¯†è¿æ¥ç½‘ç»œï¼ˆDenseNetï¼‰ã€‚å®ƒçš„è®¡ç®—æˆæœ¬å¾ˆé«˜ï¼Œä½†ç»™æˆ‘ä»¬å¸¦æ¥äº†æ›´å¥½çš„æ•ˆæœã€‚</p></li></ul><p>å­¦ä¹ è¡¨å¾è§‚æ‘©å›¾</p><p><img src="/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/filters.png" alt="filters"></p><p><img src="/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/alexnet.svg" alt="alexnet"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token keyword">from</span> torch <span class="token keyword">import</span> nn<span class="token keyword">from</span> d2l <span class="token keyword">import</span> torch <span class="token keyword">as</span> d2lnet <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>    <span class="token comment"># è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª11*11çš„æ›´å¤§çª—å£æ¥æ•æ‰å¯¹è±¡ã€‚</span>    <span class="token comment"># åŒæ—¶ï¼Œæ­¥å¹…ä¸º4ï¼Œä»¥å‡å°‘è¾“å‡ºçš„é«˜åº¦å’Œå®½åº¦ã€‚</span>    <span class="token comment"># å¦å¤–ï¼Œè¾“å‡ºé€šé“çš„æ•°ç›®è¿œå¤§äºLeNet</span>    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment"># å‡å°å·ç§¯çª—å£ï¼Œä½¿ç”¨å¡«å……ä¸º2æ¥ä½¿å¾—è¾“å…¥ä¸è¾“å‡ºçš„é«˜å’Œå®½ä¸€è‡´ï¼Œä¸”å¢å¤§è¾“å‡ºé€šé“æ•°</span>    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment"># ä½¿ç”¨ä¸‰ä¸ªè¿ç»­çš„å·ç§¯å±‚å’Œè¾ƒå°çš„å·ç§¯çª—å£ã€‚</span>    <span class="token comment"># é™¤äº†æœ€åçš„å·ç§¯å±‚ï¼Œè¾“å‡ºé€šé“çš„æ•°é‡è¿›ä¸€æ­¥å¢åŠ ã€‚</span>    <span class="token comment"># åœ¨å‰ä¸¤ä¸ªå·ç§¯å±‚ä¹‹åï¼Œæ±‡èšå±‚ä¸ç”¨äºå‡å°‘è¾“å…¥çš„é«˜åº¦å’Œå®½åº¦</span>    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">384</span><span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">384</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    nn<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment"># è¿™é‡Œï¼Œå…¨è¿æ¥å±‚çš„è¾“å‡ºæ•°é‡æ˜¯LeNetä¸­çš„å¥½å‡ å€ã€‚ä½¿ç”¨dropoutå±‚æ¥å‡è½»è¿‡æ‹Ÿåˆ</span>    nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">6400</span><span class="token punctuation">,</span> <span class="token number">4096</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">,</span> <span class="token number">4096</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment"># æœ€åæ˜¯è¾“å‡ºå±‚ã€‚ç”±äºè¿™é‡Œä½¿ç”¨Fashion-MNISTï¼Œæ‰€ä»¥ç”¨ç±»åˆ«æ•°ä¸º10ï¼Œè€Œéè®ºæ–‡ä¸­çš„1000</span>    nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§‚å¯Ÿç½‘ç»œæ¯ä¸€å±‚è¾“å‡ºæ¶æ„</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">X <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token keyword">for</span> layer <span class="token keyword">in</span> net<span class="token punctuation">:</span>    X<span class="token operator">=</span>layer<span class="token punctuation">(</span>X<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__<span class="token punctuation">,</span><span class="token string">'output shape:\t'</span><span class="token punctuation">,</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">Conv2d output shape: torch.Size([1, 96, 54, 54])ReLU output shape: torch.Size([1, 96, 54, 54])MaxPool2d output shape: torch.Size([1, 96, 26, 26])Conv2d output shape: torch.Size([1, 256, 26, 26])ReLU output shape: torch.Size([1, 256, 26, 26])MaxPool2d output shape: torch.Size([1, 256, 12, 12])Conv2d output shape: torch.Size([1, 384, 12, 12])ReLU output shape: torch.Size([1, 384, 12, 12])Conv2d output shape: torch.Size([1, 384, 12, 12])ReLU output shape: torch.Size([1, 384, 12, 12])Conv2d output shape: torch.Size([1, 256, 12, 12])ReLU output shape: torch.Size([1, 256, 12, 12])MaxPool2d output shape: torch.Size([1, 256, 5, 5])Flatten output shape: torch.Size([1, 6400])Linear output shape: torch.Size([1, 4096])ReLU output shape: torch.Size([1, 4096])Dropout output shape: torch.Size([1, 4096])Linear output shape: torch.Size([1, 4096])ReLU output shape: torch.Size([1, 4096])Dropout output shape: torch.Size([1, 4096])Linear output shape: torch.Size([1, 10])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨æ›´å°çš„å­¦ä¹ é€Ÿç‡è®­ç»ƒï¼Œè¿™æ˜¯å› ä¸ºç½‘ç»œæ›´æ·±æ›´å¹¿ã€å›¾åƒåˆ†è¾¨ç‡æ›´é«˜ï¼Œè®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œå°±æ›´æ˜‚è´µã€‚</p><h4 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><ul><li>AlexNetçš„æ¶æ„ä¸LeNetç›¸ä¼¼ï¼Œä½†ä½¿ç”¨äº†æ›´å¤šçš„å·ç§¯å±‚å’Œæ›´å¤šçš„å‚æ•°æ¥æ‹Ÿåˆå¤§è§„æ¨¡çš„ImageNetæ•°æ®é›†ã€‚</li><li>ä»Šå¤©ï¼ŒAlexNetå·²ç»è¢«æ›´æœ‰æ•ˆçš„æ¶æ„æ‰€è¶…è¶Šï¼Œä½†å®ƒæ˜¯ä»æµ…å±‚ç½‘ç»œåˆ°æ·±å±‚ç½‘ç»œçš„å…³é”®ä¸€æ­¥ã€‚</li><li>å°½ç®¡AlexNetçš„ä»£ç åªæ¯”LeNetå¤šå‡ºå‡ è¡Œï¼Œä½†å­¦æœ¯ç•ŒèŠ±äº†å¾ˆå¤šå¹´æ‰æ¥å—æ·±åº¦å­¦ä¹ è¿™ä¸€æ¦‚å¿µï¼Œå¹¶åº”ç”¨å…¶å‡ºè‰²çš„å®éªŒç»“æœã€‚è¿™ä¹Ÿæ˜¯ç”±äºç¼ºä¹æœ‰æ•ˆçš„è®¡ç®—å·¥å…·ã€‚</li><li>Dropoutã€ReLUå’Œé¢„å¤„ç†æ˜¯æå‡è®¡ç®—æœºè§†è§‰ä»»åŠ¡æ€§èƒ½çš„å…¶ä»–å…³é”®æ­¥éª¤ã€‚</li></ul><h4 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h4><ol><li>è¯•ç€å¢åŠ è¿­ä»£è½®æ•°ã€‚å¯¹æ¯”LeNetçš„ç»“æœæœ‰ä»€ä¹ˆä¸åŒï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li><li>AlexNetå¯¹äºFashion-MNISTæ•°æ®é›†æ¥è¯´å¯èƒ½å¤ªå¤æ‚äº†ã€‚<ol><li>å°è¯•ç®€åŒ–æ¨¡å‹ä»¥åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼ŒåŒæ—¶ç¡®ä¿å‡†ç¡®æ€§ä¸ä¼šæ˜¾è‘—ä¸‹é™ã€‚</li><li>è®¾è®¡ä¸€ä¸ªæ›´å¥½çš„æ¨¡å‹ï¼Œå¯ä»¥ç›´æ¥åœ¨28Ã—28å›¾åƒä¸Šå·¥ä½œã€‚</li></ol></li><li>ä¿®æ”¹æ‰¹é‡å¤§å°ï¼Œå¹¶è§‚å¯Ÿæ¨¡å‹ç²¾åº¦å’ŒGPUæ˜¾å­˜å˜åŒ–ã€‚</li><li>åˆ†æäº†AlexNetçš„è®¡ç®—æ€§èƒ½ã€‚<ol><li>åœ¨AlexNetä¸­ä¸»è¦æ˜¯å“ªéƒ¨åˆ†å ç”¨æ˜¾å­˜ï¼Ÿ</li><li>åœ¨AlexNetä¸­ä¸»è¦æ˜¯å“ªéƒ¨åˆ†éœ€è¦æ›´å¤šçš„è®¡ç®—ï¼Ÿ</li><li>è®¡ç®—ç»“æœæ—¶æ˜¾å­˜å¸¦å®½å¦‚ä½•ï¼Ÿ</li></ol></li><li>å°†dropoutå’ŒReLUåº”ç”¨äºLeNet-5ï¼Œæ•ˆæœæœ‰æå‡å—ï¼Ÿå†è¯•è¯•é¢„å¤„ç†ä¼šæ€ä¹ˆæ ·ï¼Ÿ</li></ol><h3 id="2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š-VGG-å’ŒAlexNet-æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«"><a href="#2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š-VGG-å’ŒAlexNet-æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«" class="headerlink" title="2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š VGG (å’ŒAlexNet æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«)"></a>2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š VGG (å’ŒAlexNet æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«)</h3><p><img src="/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/vgg.svg" alt="vgg"></p><h4 id="å°ç»“-2"><a href="#å°ç»“-2" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><ul><li>VGG-11ä½¿ç”¨å¯å¤ç”¨çš„å·ç§¯å—æ„é€ ç½‘ç»œã€‚ä¸åŒçš„VGGæ¨¡å‹å¯é€šè¿‡æ¯ä¸ªå—ä¸­å·ç§¯å±‚æ•°é‡å’Œè¾“å‡ºé€šé“æ•°é‡çš„å·®å¼‚æ¥å®šä¹‰ã€‚</li><li>å—çš„ä½¿ç”¨å¯¼è‡´ç½‘ç»œå®šä¹‰çš„éå¸¸ç®€æ´ã€‚ä½¿ç”¨å—å¯ä»¥æœ‰æ•ˆåœ°è®¾è®¡å¤æ‚çš„ç½‘ç»œã€‚</li><li>åœ¨VGGè®ºæ–‡ä¸­ï¼ŒSimonyanå’ŒZisermanå°è¯•äº†å„ç§æ¶æ„ã€‚ç‰¹åˆ«æ˜¯ä»–ä»¬å‘ç°æ·±å±‚ä¸”çª„çš„å·ç§¯ï¼ˆå³3Ã—3ï¼‰æ¯”è¾ƒæµ…å±‚ä¸”å®½çš„å·ç§¯æ›´æœ‰æ•ˆã€‚</li></ul><h4 id="3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ-NiN"><a href="#3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ-NiN" class="headerlink" title="3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ - NiN"></a>3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ - NiN</h4>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CNN </tag>
            
            <tag> å·ç§¯ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ml-Dl-æœ•å‘½æ€¥æ•‘</title>
      <link href="/2022/03/25/ml-dl-zhen-ming-ji-jiu/"/>
      <url>/2022/03/25/ml-dl-zhen-ming-ji-jiu/</url>
      
        <content type="html"><![CDATA[<h4 id="ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿"><a href="#ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿" class="headerlink" title="ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿"></a>ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿</h4><h5 id="1ã€å¯¼å…¥å¸¸è§åº“"><a href="#1ã€å¯¼å…¥å¸¸è§åº“" class="headerlink" title="1ã€å¯¼å…¥å¸¸è§åº“"></a>1ã€å¯¼å…¥å¸¸è§åº“</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  <span class="token comment"># Linear algebra</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd <span class="token comment"># data processing, CSV file I/O</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å›¾åƒæ•°æ®å¤„ç†éƒ¨åˆ†â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span class="token comment"># å†…åµŒç»˜å›¾ï¼Œå¯ä»¥çœç•¥ plt.show()</span><span class="token operator">%</span>matplotlib inline <span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt  <span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>image <span class="token keyword">as</span> mpimg<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> snsplt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'seaborn'</span><span class="token punctuation">)</span><span class="token comment"># æ˜¾ç¤ºé£æ ¼</span>sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>style<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token string">'notebook'</span><span class="token punctuation">,</span> palette<span class="token operator">=</span><span class="token string">'deep'</span><span class="token punctuation">)</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”è¯­è¨€tokenå¤„ç†éƒ¨åˆ†â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud<span class="token punctuation">,</span> STOPWORDS â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¯æ·»åŠ è¡¥å……â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”    <span class="token keyword">from</span> IPython<span class="token punctuation">.</span>core<span class="token punctuation">.</span>interactiveshell <span class="token keyword">import</span> InteractiveShell <span class="token comment"># idk</span>InteractiveShell<span class="token punctuation">.</span>ast_node_interactivity <span class="token operator">=</span> <span class="token string">"all"</span> <span class="token comment"># idk</span>plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'figure.figsize'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span><span class="token number">10</span>plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'fivethirtyeight'</span><span class="token punctuation">)</span><span class="token comment"># ç§‘å­¦è®¡ç®—ç”¨çš„åº“ï¼ŒåŒ…å«å¾ˆå¤šæ•°å­¦å’Œç®—æ³•çš„å®ä¾‹ï¼Œåæ§½~å“ªæœ‰è¿™ä¹ˆå¤šç§‘å­¦è®¡ç®—åº“</span><span class="token keyword">from</span> scipy <span class="token keyword">import</span> stats <span class="token comment"># æ•°æ®é›†ç¯å¢ƒ</span><span class="token keyword">for</span> dirname<span class="token punctuation">,</span> _<span class="token punctuation">,</span> filenames <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span><span class="token string">'/kaggle/input'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> filenmae <span class="token keyword">in</span> filenames<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">def</span> <span class="token function">highlight_max</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> props <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>s <span class="token operator">==</span> np<span class="token punctuation">.</span>nanmax<span class="token punctuation">(</span>s<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">,</span> props<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token comment"># idk</span><span class="token comment"># è¾…åŠ©å·¥å…·</span> <span class="token comment"># è¿­ä»£è¿›åº¦æ¡ï¼Œåªæ˜¯ä¸ºäº†å¥½çœ‹</span><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm <span class="token comment"># çœ‹èµ·æ¥æœ‰ç‚¹è€çš„æ ·å­</span><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image         â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span class="token comment"># ç³»ç»Ÿå±€éƒ¨ç¯å¢ƒ</span><span class="token keyword">import</span> os<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path<span class="token comment"># åƒåœ¾å›æ”¶æœºåˆ¶</span><span class="token keyword">import</span> gc <span class="token comment"># å»ºç«‹æ·±åº¦æ¨¡å‹æ‰€éœ€è¦çš„</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential <span class="token keyword">from</span> keras <span class="token keyword">import</span>  backend <span class="token keyword">as</span> K <span class="token comment"># idk</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å›¾åƒéƒ¨åˆ†æ¨¡å‹å±‚çš„ç®€æ˜“è§£é‡Šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span class="token comment"># Conv2D : äºŒç»´å·ç§¯å±‚ï¼Œäº’ç›¸å…³è¿ç®—ï¼Œå¯ä½¿ç”¨å¡«å……ã€æ­¥å¹…å’Œå¤šé€šé“è¾“å…¥/è¾“å‡º</span><span class="token comment"># Dense : ç¨ å¯†å±‚</span><span class="token comment"># Dropout : ä¸¢å¼ƒå±‚</span><span class="token comment"># pool2d : 2ç»´æ±‡èšå±‚ï¼Œå¯¹æ±‡èšçª—å£æ‰€æœ‰å…ƒç´ è®¡ç®—æœ€å¤§å€¼æˆ–å¹³å‡å€¼ï¼Œå¯ä½¿ç”¨å¡«å……ã€æ­¥å¹…å’Œå¤šé€šé“è¾“å…¥/è¾“å‡º</span><span class="token comment"># Flatten : å¹³æ»‘å±‚</span><span class="token comment"># MaxPool2D : äºŒç»´æ±‡èšè®¡ç®—æœ€å¤§å€¼</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense <span class="token punctuation">,</span> Dropout <span class="token punctuation">,</span> Lambda<span class="token punctuation">,</span> Flatten Conv2D<span class="token punctuation">,</span> MaxPool2D <span class="token comment"># ä¼˜åŒ–å‡½æ•° rmsprop_v2 , adam_v2</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>optimizers <span class="token keyword">import</span> Adam <span class="token punctuation">,</span>RMSprop<span class="token comment"># è®­ç»ƒã€éªŒè¯æ•°æ®åˆ†ç¦»</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix <span class="token comment"># idk</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> ImageDataGenerator <span class="token comment"># idk</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”è¯­è¨€æ¨¡å‹çš„éƒ¨åˆ†è§£é‡Šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder <span class="token comment"># idk</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> StratifiedKFold <span class="token comment"># idk</span><span class="token keyword">from</span> transformers <span class="token keyword">import</span> AutoTokenizer<span class="token punctuation">,</span> AutoConfig<span class="token punctuation">,</span> AutoModel<span class="token punctuation">,</span> get_linear_schedule_with_warmup <span class="token keyword">from</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">import</span> AdamWâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span class="token keyword">from</span> keras<span class="token punctuation">.</span>callbacks <span class="token keyword">import</span> ReduceLROnPlateau <span class="token comment"># idk</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¿½ç•¥åŒ…ç¯å¢ƒçš„è­¦å‘Šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">'cuda'</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'cpu'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ã€æ£€æŸ¥ç¯å¢ƒçŠ¶å†µ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> subprocess <span class="token keyword">import</span> check_output<span class="token keyword">print</span><span class="token punctuation">(</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"ls"</span><span class="token punctuation">,</span> <span class="token string">"../input"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="äºŒã€æ£€æŸ¥æ•°æ®"><a href="#äºŒã€æ£€æŸ¥æ•°æ®" class="headerlink" title="äºŒã€æ£€æŸ¥æ•°æ®"></a>äºŒã€æ£€æŸ¥æ•°æ®</h4><h5 id="1ã€åŠ è½½æä¾›çš„æ•°æ®"><a href="#1ã€åŠ è½½æä¾›çš„æ•°æ®" class="headerlink" title="1ã€åŠ è½½æä¾›çš„æ•°æ®"></a>1ã€åŠ è½½æä¾›çš„æ•°æ®</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/train.csv'</span><span class="token punctuation">)</span> <span class="token comment"># è¯»å…¥è®­ç»ƒæ•°æ®</span>test <span class="token operator">=</span> pd <span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/test.csv'</span><span class="token punctuation">)</span> <span class="token comment"># è¯»å…¥æµ‹è¯•æ•°æ®</span>train<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æŸ¥çœ‹å‰é¢5è¡Œçš„ä¿¡æ¯</span>train<span class="token punctuation">.</span>shape <span class="token comment"># è¿”å›æ•´ä½“ data çš„ çš„ä¿¡æ¯</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Shape Dtrain:</span><span class="token interpolation"><span class="token punctuation">{</span>train<span class="token punctuation">.</span>shape<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Shape Dtest: </span><span class="token interpolation"><span class="token punctuation">{</span>test<span class="token punctuation">.</span>shape<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">20</span> <span class="token operator">*</span> <span class="token string">'#'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Unique elements per column"</span><span class="token punctuation">)</span>train<span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Missing Value?"</span><span class="token punctuation">)</span>train<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å›¾åƒæ•°æ®å¤„ç†æ–¹æ³•â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”X_train <span class="token operator">=</span> <span class="token punctuation">(</span>train<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float32'</span><span class="token punctuation">)</span> <span class="token comment"># å½¢æˆarrayæ•°ç»„ </span>y_train <span class="token operator">=</span> train<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int32'</span><span class="token punctuation">)</span> <span class="token comment"># 28*28 çš„å€¼</span>X_test <span class="token operator">=</span> test<span class="token punctuation">.</span>values<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float32'</span><span class="token punctuation">)</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” æŠ€å·§ <span class="token punctuation">(</span>tricks<span class="token punctuation">)</span> â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span class="token comment"># ä¸€äº›æŠ€å·§ - tricks</span><span class="token keyword">del</span> train <span class="token comment"># can free some space ?</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2ã€æ•°æ®å¯è§†åŒ–"><a href="#2ã€æ•°æ®å¯è§†åŒ–" class="headerlink" title="2ã€æ•°æ®å¯è§†åŒ–"></a>2ã€æ•°æ®å¯è§†åŒ–</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># method 1</span>X_train <span class="token operator">=</span> X_train<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span> <span class="token comment"># è½¬å˜æ•°æ®ä¸ºå›¾ç‰‡ï¼Œé‡æ–°ç»„ç»‡å½¢çŠ¶</span><span class="token comment"># method 2 : Reshape image in 3 dimensions (height = 28px, width = 28px , canal = 1)</span>X_train <span class="token operator">=</span> X_train<span class="token punctuation">.</span>values<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>test <span class="token operator">=</span> test<span class="token punctuation">.</span>values<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”Y_train <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token comment"># åªå–å€¼çš„é‚£ä¸€åˆ—æ ‡ç­¾</span>X_train <span class="token operator">=</span> train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># ä¸è¦å€¼çš„é‚£ä¸€åˆ—ä½œä¸ºè®­ç»ƒæ•°æ®</span>count <span class="token operator">=</span> sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>Y_train<span class="token punctuation">)</span> <span class="token comment"># è®¡ç®— 1-10 çš„æ•°é‡</span>Y_train<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æŸ±çŠ¶å›¾æ˜¾ç¤º 1 - 10 çš„æ•°é‡</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”top <span class="token operator">=</span> Counter<span class="token punctuation">(</span><span class="token punctuation">[</span>anc <span class="token keyword">for</span> anc <span class="token keyword">in</span> train<span class="token punctuation">[</span><span class="token string">'anchor'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># Counter è®¡æ•°æ ‡ç­¾'anchor'</span>top <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>top<span class="token punctuation">.</span>most_common<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># å–å¾—å‰é¢ 50 ä¸ª</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># ç»˜åˆ¶å›¾è¡¨å°ºå¯¸</span>sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>top<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>top<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> palette <span class="token operator">=</span> <span class="token string">'hls'</span><span class="token punctuation">)</span> <span class="token comment"># è°ƒè‰²æ¿ä¸º hls</span>plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token comment"># x è½´æ ‡ç­¾å¯ä»¥åšå‡ºä¸€äº›è°ƒæ•´</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Top 50 First Phrases (Anchor)"</span><span class="token punctuation">,</span> fontsize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404083846939.png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>text_len <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'anchor'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x <span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>text_len<span class="token punctuation">,</span> ax <span class="token operator">=</span> ax<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>ax<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'Word Count Distribution'</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment"># è¿™è¿˜è¦å–è®¾ç½®å¤§å°ï¼Ÿ</span>avg_word_len <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'anchor'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x <span class="token punctuation">:</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># çœ‹èµ·æ¥è¿™ä½å°å“¥å¾ˆå–œæ¬¢ ç”¨ lambda æ¼”ç®—ï¼Œåˆ†ç¦» anchor é‡Œçš„è¯å‘é‡æ¥è®¡ç®—å¹³å‡é•¿åº¦</span>sns<span class="token punctuation">.</span>histplot<span class="token punctuation">(</span>avg_word_len<span class="token punctuation">,</span> ax <span class="token operator">=</span> ax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> kde <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'#ffa408'</span><span class="token punctuation">)</span> <span class="token comment"># kde æ˜¯å¼€å¯æ ¸å¯†åº¦å‡½æ•°ï¼Ÿ,æˆ‘åªæ˜¯çœ‹åˆ°ä¸€æ¡çº¿å•Š</span>ax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'Average Word Length Distribution'</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404091257020.png"></p><h2 id="æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ"><a href="#æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ" class="headerlink" title="æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ"></a>æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsplt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>text <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'anchor'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valuesurl <span class="token operator">=</span> <span class="token string">'./img.png'</span><span class="token comment"># url = 'https://static.vecteezy.com/system/resources/previews/000/263/280/non_2x/vector-open-book.jpg'</span><span class="token comment"># æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆé“¾æ¥ä¸èƒ½æœ‰æ•ˆæ‰“å¼€</span>im <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># æ‰€ä»¥æˆ‘åªèƒ½ç”¨æˆ‘è‡ªå·±çš„æ–¹å¼æ¥æ‰“å¼€</span><span class="token comment"># im = np.array(Image.open(requests.get(url, stream=True).raw))</span>cloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>stopwords <span class="token operator">=</span> STOPWORDS<span class="token punctuation">,</span>                  background_color <span class="token operator">=</span> <span class="token string">'black'</span><span class="token punctuation">,</span>                  mask <span class="token operator">=</span> im<span class="token punctuation">,</span>                  max_words <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span>                  <span class="token punctuation">)</span><span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>cloud<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404093146238.png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># é’ˆå¯¹ä¸Šé¢çš„ anchor çš„ç‰¹å¾æ¥å¯¹ target çš„ä¿¡æ¯æŠ½å–</span><span class="token comment"># åªéœ€è¦æŠŠ anchor æ›¿æ¢æˆ taraget ,action ! </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404093640583.png"></p><p><img src="/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404093717734.png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># çœ‹èµ·æ¥è¿™ä¸ªå¥½åƒæ˜¯ cm æ¥è®¡é‡çš„</span>sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'context'</span><span class="token punctuation">,</span> data <span class="token operator">=</span> train<span class="token punctuation">,</span> palette <span class="token operator">=</span> <span class="token string">'hls'</span><span class="token punctuation">)</span> <span class="token comment"># åˆæ¥è®¡ç®— context çš„ä¿¡æ¯ï¼Œä½†çœ‹èµ·æ¥ç‰¹å¾ context çš„ä¿¡æ¯æœ‰ç‚¹å¤šå•Š</span>plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Distribution of Context'</span><span class="token punctuation">,</span> fontsize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404094416376.png"></p><h6 id="3ã€ç‰¹å¾æ ‡å‡†åŒ–"><a href="#3ã€ç‰¹å¾æ ‡å‡†åŒ–" class="headerlink" title="3ã€ç‰¹å¾æ ‡å‡†åŒ–"></a>3ã€ç‰¹å¾æ ‡å‡†åŒ–</h6><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># method 1 : </span>mean_px <span class="token operator">=</span> X_train<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token comment"># æ±‚å…¶å‡å€¼ä½œä¸º np çš„ float32 æ ¼å¼</span>std_px <span class="token operator">=</span> X_train<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span> <span class="token comment"># æ±‚å…¶æ ‡å‡†å·®ä½œä¸º np çš„ float32 æ ¼å¼</span><span class="token keyword">def</span> <span class="token function">standardize</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token keyword">return</span> <span class="token punctuation">(</span>x<span class="token operator">-</span>mean_px<span class="token punctuation">)</span><span class="token operator">/</span>std_px<span class="token comment"># method 2 : Normalize the data</span>X_train <span class="token operator">=</span> X_train <span class="token operator">/</span> <span class="token number">255.0</span>test <span class="token operator">=</span> test <span class="token operator">/</span> <span class="token number">255.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼"><a href="#4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼" class="headerlink" title="4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼"></a>4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Check the data</span>X_train<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>test<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># Encode labels to one hot vectors (ex : 2 -&gt; [0,0,1,0,0,0,0,0,0,0])</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>np_utils <span class="token keyword">import</span> to_categoricaY_train <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>Y_train<span class="token punctuation">,</span> num_classes <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Set the random seed</span>random_seed <span class="token operator">=</span> <span class="token number">2</span><span class="token comment"># Split the train and the validation set for the fitting</span>X_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> Y_train<span class="token punctuation">,</span> Y_val <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span>random_seed<span class="token punctuation">)</span><span class="token comment"># æŸ¥çœ‹ä¸€ä¸ªä¾‹å­</span>g <span class="token operator">=</span> plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”USPPMencoder <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>train<span class="token punctuation">[</span><span class="token string">'score_encoded'</span><span class="token punctuation">]</span> <span class="token operator">=</span> encoder<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>train<span class="token punctuation">[</span><span class="token string">'score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># è¿™é‡Œçš„ 0 å¯¹åº”äº label æ˜¯ 0ï¼Œ0.25 å¯¹åº”äº 1 ï¼Œ0.5 å¯¹åº”äº 2ã€‚ä»¥æ­¤ç±»æ¨...</span>skf <span class="token operator">=</span> StratifiedKFold<span class="token punctuation">(</span>n_splits <span class="token operator">=</span> CONFIG<span class="token punctuation">.</span>num_fold<span class="token punctuation">,</span>shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>random_state <span class="token operator">=</span> CONFIG<span class="token punctuation">.</span>seed<span class="token punctuation">)</span><span class="token comment"># åˆ†å±‚kæŠ˜</span><span class="token comment"># num_fold = 5, seed = 2022</span><span class="token keyword">for</span> k<span class="token punctuation">,</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> val_ind<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>skf<span class="token punctuation">.</span>split<span class="token punctuation">(</span>X <span class="token operator">=</span> train<span class="token punctuation">,</span> y <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'score_encoded'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># enumerate ä¸­åˆ†ç¦»å‡ºæ¥çš„æ•°æ®æ˜¯ ä¸‹æ ‡ åŠ ä¸Š train ä¸­çš„å€¼</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>val_ind<span class="token punctuation">)</span> <span class="token comment"># idk</span>    train<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>val_ind<span class="token punctuation">,</span><span class="token string">'fold'</span><span class="token punctuation">]</span> <span class="token operator">=</span> k <span class="token comment"># å°† val_ind çš„ä¸‹æ ‡åˆ†åˆ« è´´ä¸Š k æ ‡å¿—</span>    <span class="token comment"># é€šè¿‡è¡Œç´¢å¼• index ä¸­çš„å…·ä½“å€¼æ¥å–è¡Œæ•°æ®</span>    <span class="token comment"># iloc æ˜¯é€šè¿‡ è¡Œå·æ¥å–è¡Œæ•°æ®</span><span class="token comment">################# æ•ˆæœè¿˜ä¸é”™ ###################</span><span class="token punctuation">[</span>    <span class="token number">2</span>    <span class="token number">11</span>    <span class="token number">13</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">36468</span> <span class="token number">36469</span> <span class="token number">36470</span><span class="token punctuation">]</span><span class="token punctuation">[</span>    <span class="token number">0</span>     <span class="token number">3</span>     <span class="token number">5</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">36459</span> <span class="token number">36464</span> <span class="token number">36467</span><span class="token punctuation">]</span><span class="token punctuation">[</span>    <span class="token number">6</span>    <span class="token number">10</span>    <span class="token number">14</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">36465</span> <span class="token number">36471</span> <span class="token number">36472</span><span class="token punctuation">]</span><span class="token punctuation">[</span>    <span class="token number">4</span>    <span class="token number">21</span>    <span class="token number">26</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">36457</span> <span class="token number">36462</span> <span class="token number">36466</span><span class="token punctuation">]</span><span class="token punctuation">[</span>    <span class="token number">1</span>     <span class="token number">8</span>     <span class="token number">9</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">36455</span> <span class="token number">36456</span> <span class="token number">36460</span><span class="token punctuation">]</span><span class="token comment">###############################################</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="7-æ·»åŠ æ•°æ®æ ‡ç­¾"><a href="#7-æ·»åŠ æ•°æ®æ ‡ç­¾" class="headerlink" title="7.æ·»åŠ æ•°æ®æ ‡ç­¾"></a>7.æ·»åŠ æ•°æ®æ ‡ç­¾</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">train<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'context'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>df_cpc<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'code'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»"><a href="#æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»" class="headerlink" title="æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»"></a>æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Dataset</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Dataset(data)      data (np.array or list-like): input_ids and y    """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data <span class="token operator">=</span> data        self<span class="token punctuation">.</span>max_length <span class="token operator">=</span> max_length    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># Padding to max_length</span>        d <span class="token operator">=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        n <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>max_length<span class="token punctuation">)</span>        input_ids <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>self<span class="token punctuation">.</span>max_length<span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>        input_ids<span class="token punctuation">[</span><span class="token punctuation">:</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">[</span><span class="token string">'input_ids'</span><span class="token punctuation">]</span>        attention_mask <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>self<span class="token punctuation">.</span>max_length<span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>        attention_mask<span class="token punctuation">[</span><span class="token punctuation">:</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'input_ids'</span><span class="token punctuation">:</span> input_ids<span class="token punctuation">,</span>                <span class="token string">'attention_mask'</span><span class="token punctuation">:</span> attention_mask<span class="token punctuation">,</span>                <span class="token string">'n'</span><span class="token punctuation">:</span> n<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Tokenize"><a href="#Tokenize" class="headerlink" title="Tokenize"></a>Tokenize</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">create_data</span><span class="token punctuation">(</span>train<span class="token punctuation">,</span> tokenizer<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Create input_ids and label array y    Args:      train (pd.DataFrame)    Returns: list[dict]      input_ids (np.array[int])      n (int): seq length or number of tokens    """</span>    sep <span class="token operator">=</span> tokenizer<span class="token punctuation">.</span>sep_token_id    <span class="token keyword">if</span> tokenizer<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__ <span class="token operator">==</span> <span class="token string">'RobertaTokenizerFast'</span><span class="token punctuation">:</span>        nsep <span class="token operator">=</span> <span class="token number">3</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        nsep <span class="token operator">=</span> <span class="token number">2</span>            data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> r <span class="token keyword">in</span> train<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        text <span class="token operator">=</span> r<span class="token punctuation">.</span>pn_history        feature_text <span class="token operator">=</span> r<span class="token punctuation">.</span>feature_text        o <span class="token operator">=</span> tokenizer<span class="token punctuation">(</span>text<span class="token punctuation">,</span> feature_text<span class="token punctuation">,</span>                      add_special_tokens<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span>max_length<span class="token punctuation">,</span>                      truncation<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                      return_offsets_mapping<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token comment"># Input ids</span>        input_ids <span class="token operator">=</span> o<span class="token punctuation">[</span><span class="token string">'input_ids'</span><span class="token punctuation">]</span>        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>input_ids<span class="token punctuation">)</span>        input_ids <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>o<span class="token punctuation">[</span><span class="token string">'input_ids'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>        <span class="token keyword">assert</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>input_ids <span class="token operator">==</span> sep<span class="token punctuation">)</span> <span class="token operator">==</span> nsep  <span class="token comment"># text and feature_text seperated by [SEP]; sep sep for roberta</span>                <span class="token comment"># Attention mask</span>        attention_mask <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>o<span class="token punctuation">[</span><span class="token string">'attention_mask'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">assert</span> np<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span>attention_mask <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'row_id'</span><span class="token punctuation">:</span> r<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>             <span class="token string">'input_ids'</span><span class="token punctuation">:</span> input_ids<span class="token punctuation">,</span>             <span class="token string">'text'</span><span class="token punctuation">:</span> text<span class="token punctuation">,</span>             <span class="token string">'n'</span><span class="token punctuation">:</span> n<span class="token punctuation">,</span>             <span class="token string">'offset_mapping'</span><span class="token punctuation">:</span> o<span class="token punctuation">[</span><span class="token string">'offset_mapping'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Model</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> model_dir<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> dropout<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        config <span class="token operator">=</span> AutoConfig<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>model_dir<span class="token punctuation">,</span> add_pooling_layer<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> pretrained<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>transformer <span class="token operator">=</span> AutoModel<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>model_dir<span class="token punctuation">,</span> config<span class="token operator">=</span>config<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>transformer <span class="token operator">=</span> AutoModel<span class="token punctuation">.</span>from_config<span class="token punctuation">(</span>config<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc_dropout <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>dropout<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>config<span class="token punctuation">.</span>hidden_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_init_weights<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc<span class="token punctuation">,</span> config<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_init_weights</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> module<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span>        module<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>data<span class="token punctuation">.</span>normal_<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> std<span class="token operator">=</span>config<span class="token punctuation">.</span>initializer_range<span class="token punctuation">)</span>        <span class="token keyword">if</span> module<span class="token punctuation">.</span>bias <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            module<span class="token punctuation">.</span>bias<span class="token punctuation">.</span>data<span class="token punctuation">.</span>zero_<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_ids<span class="token punctuation">,</span> attention_mask<span class="token punctuation">)</span><span class="token punctuation">:</span>        out <span class="token operator">=</span> self<span class="token punctuation">.</span>transformer<span class="token punctuation">(</span>input_ids<span class="token punctuation">,</span> attention_mask<span class="token punctuation">)</span>        x <span class="token operator">=</span> out<span class="token punctuation">[</span><span class="token string">'last_hidden_state'</span><span class="token punctuation">]</span>  <span class="token comment"># batch_size x max_length (512) x 768</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc_dropout<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">return</span> x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€"><a href="#ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€" class="headerlink" title="ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€)"></a>ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€)</h4><h5 id="1ã€model"><a href="#1ã€model" class="headerlink" title="1ã€model"></a>1ã€model</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># A CNN model example</span>model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>padding <span class="token operator">=</span> <span class="token string">'Same'</span><span class="token punctuation">,</span>                  activation <span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> input_shape <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>padding <span class="token operator">=</span> <span class="token string">'Same'</span><span class="token punctuation">,</span>                  activation <span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dropout<span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>padding <span class="token operator">=</span> <span class="token string">'Same'</span><span class="token punctuation">,</span>                  activation <span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>padding <span class="token operator">=</span> <span class="token string">'Same'</span><span class="token punctuation">,</span>                  activation <span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dropout<span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"softmax"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2ã€åç»­è¿ä½œæ­¥éª¤"><a href="#2ã€åç»­è¿ä½œæ­¥éª¤" class="headerlink" title="2ã€åç»­è¿ä½œæ­¥éª¤"></a>2ã€åç»­è¿ä½œæ­¥éª¤</h5><p>ä¸€æ—¦æˆ‘ä»¬çš„å±‚è¢«æ·»åŠ åˆ°æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªè¯„åˆ†å‡½æ•°ã€ä¸€ä¸ªæŸå¤±å‡½æ•°å’Œä¸€ä¸ªä¼˜åŒ–ç®—æ³•ã€‚<br>æˆ‘ä»¬å®šä¹‰æŸå¤±å‡½æ•°æ¥è¡¡é‡æˆ‘ä»¬çš„æ¨¡å‹åœ¨å…·æœ‰å·²çŸ¥æ ‡ç­¾çš„å›¾åƒä¸Šçš„è¡¨ç°æœ‰å¤šå·®ã€‚å®ƒæ˜¯è§‚å¯Ÿåˆ°çš„æ ‡ç­¾å’Œé¢„æµ‹çš„æ ‡ç­¾ä¹‹é—´çš„é”™è¯¯ç‡ã€‚æˆ‘ä»¬ä½¿ç”¨ç§°ä¸ºâ€œcategorical crossentropyâ€çš„åˆ†ç±»åˆ†ç±»ï¼ˆ&gt;2 ç±»ï¼‰çš„ç‰¹å®šå½¢å¼ã€‚<br>æœ€é‡è¦çš„åŠŸèƒ½æ˜¯ä¼˜åŒ–å™¨ã€‚è¿™ä¸ªå‡½æ•°å°†è¿­ä»£åœ°æ”¹è¿›å‚æ•°ï¼ˆè¿‡æ»¤æ ¸å€¼ã€æƒé‡å’Œç¥ç»å…ƒçš„åå·®â€¦â€¦ï¼‰ä»¥æœ€å°åŒ–æŸå¤±ã€‚<br>æˆ‘é€‰æ‹©äº† RMSpropï¼ˆå¸¦æœ‰é»˜è®¤å€¼ï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸æœ‰æ•ˆçš„ä¼˜åŒ–å™¨ã€‚ RMSProp æ›´æ–°ä»¥ä¸€ç§éå¸¸ç®€å•çš„æ–¹å¼è°ƒæ•´ Adagrad æ–¹æ³•ï¼Œè¯•å›¾é™ä½å…¶æ¿€è¿›çš„ã€å•è°ƒé€’å‡çš„å­¦ä¹ ç‡ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ (â€˜sgdâ€™) ä¼˜åŒ–å™¨ï¼Œä½†å®ƒæ¯” RMSprop æ…¢ã€‚<br>åº¦é‡å‡½æ•°â€œå‡†ç¡®åº¦â€ç”¨äºè¯„ä¼°æˆ‘ä»¬æ¨¡å‹çš„æ€§èƒ½ã€‚è¯¥åº¦é‡å‡½æ•°ç±»ä¼¼äºæŸå¤±å‡½æ•°ï¼Œåªæ˜¯åœ¨è®­ç»ƒæ¨¡å‹æ—¶ä¸ä½¿ç”¨åº¦é‡è¯„ä¼°çš„ç»“æœï¼ˆä»…ç”¨äºè¯„ä¼°ï¼‰ã€‚</p><pre class="line-numbers language-none"><code class="language-none"># Define the optimizeroptimizer = rmsprop_v2(lr=0.001, rho=0.9, epsilon=1e-08, decay=0.0) # è¿™é‡Œæœ‰ä¸€ç‚¹é—®é¢˜ï¼Œä¸èƒ½æ­£å¸¸è¿è¡Œ# Compile the modelmodel.compile(optimizer = optimizer , loss = "categorical_crossentropy", metrics=["accuracy"])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ºäº†ä½¿ä¼˜åŒ–å™¨æ›´å¿«æ”¶æ•›å¹¶æœ€æ¥è¿‘æŸå¤±å‡½æ•°çš„å…¨å±€æœ€å°å€¼ï¼Œæˆ‘ä½¿ç”¨äº†å­¦ä¹ ç‡ï¼ˆLRï¼‰çš„é€€ç«æ–¹æ³•ã€‚<br>LR æ˜¯ä¼˜åŒ–å™¨éå†â€œæŸå¤±æƒ…å†µâ€çš„æ­¥éª¤ã€‚ LRè¶Šé«˜ï¼Œæ­¥æ•°è¶Šå¤§ï¼Œæ”¶æ•›è¶Šå¿«ã€‚ç„¶è€Œï¼Œé«˜ LR çš„é‡‡æ ·éå¸¸å·®ï¼Œä¼˜åŒ–å™¨å¯èƒ½ä¼šé™·å…¥å±€éƒ¨æœ€å°å€¼ã€‚<br>æœ€å¥½åœ¨è®­ç»ƒæœŸé—´é™ä½å­¦ä¹ ç‡ï¼Œä»¥æœ‰æ•ˆåœ°è¾¾åˆ°æŸå¤±å‡½æ•°çš„å…¨å±€æœ€å°å€¼ã€‚<br>ä¸ºäº†ä¿æŒé«˜ LR çš„å¿«é€Ÿè®¡ç®—æ—¶é—´çš„ä¼˜åŠ¿ï¼Œæˆ‘æ¯ X æ­¥ï¼ˆæ—¶æœŸï¼‰åŠ¨æ€é™ä½ LRï¼Œè¿™å–å†³äºæ˜¯å¦æœ‰å¿…è¦ï¼ˆå½“ç²¾åº¦æ²¡æœ‰æé«˜æ—¶ï¼‰ã€‚<br>ä½¿ç”¨ Keras.callbacks ä¸­çš„ ReduceLROnPlateau å‡½æ•°ï¼Œå¦‚æœ 3 ä¸ª epoch åç²¾åº¦æ²¡æœ‰æé«˜ï¼Œæˆ‘é€‰æ‹©å°† LR å‡å°‘ä¸€åŠã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Set a learning rate annealer</span>learning_rate_reduction <span class="token operator">=</span> ReduceLROnPlateau<span class="token punctuation">(</span>monitor<span class="token operator">=</span><span class="token string">'val_acc'</span><span class="token punctuation">,</span>                                             patience<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>                                             verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>                                             factor<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                                             min_lr<span class="token operator">=</span><span class="token number">0.00001</span><span class="token punctuation">)</span>epochs <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment"># Turn epochs to 30 to get 0.9967 accuracy</span>batch_size <span class="token operator">=</span> <span class="token number">86</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="3ã€æ•°æ®å¢åŠ "><a href="#3ã€æ•°æ®å¢åŠ " class="headerlink" title="3ã€æ•°æ®å¢åŠ "></a>3ã€æ•°æ®å¢åŠ </h5><p>ä¸ºäº†é¿å…è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦äººä¸ºåœ°æ‰©å±•æˆ‘ä»¬çš„æ‰‹å†™æ•°å­—æ•°æ®é›†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿æ‚¨ç°æœ‰çš„æ•°æ®é›†æ›´å¤§ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯é€šè¿‡å°çš„è½¬æ¢æ¥æ”¹å˜è®­ç»ƒæ•°æ®ï¼Œä»¥é‡ç°å½“æœ‰äººå†™æ•°å­—æ—¶å‘ç”Ÿçš„å˜åŒ–ã€‚<br>æ¯”å¦‚æ•°å­—ä¸å±…ä¸­ æ¯”ä¾‹ä¸ä¸€æ ·ï¼ˆæœ‰äº›äººç”¨å¤§/å°æ•°å­—å†™ï¼‰ å›¾åƒæ—‹è½¬â€¦<br>ä»¥æ”¹å˜æ•°ç»„è¡¨ç¤ºåŒæ—¶ä¿æŒæ ‡ç­¾ç›¸åŒçš„æ–¹å¼æ”¹å˜è®­ç»ƒæ•°æ®çš„æ–¹æ³•è¢«ç§°ä¸ºæ•°æ®å¢å¼ºæŠ€æœ¯ã€‚äººä»¬ä½¿ç”¨çš„ä¸€äº›æµè¡Œçš„å¢å¼ºæ˜¯ç°åº¦ã€æ°´å¹³ç¿»è½¬ã€å‚ç›´ç¿»è½¬ã€éšæœºè£å‰ªã€é¢œè‰²æŠ–åŠ¨ã€å¹³ç§»ã€æ—‹è½¬ç­‰ç­‰ã€‚<br>é€šè¿‡å°†è¿™äº›è½¬æ¢ä¸­çš„å‡ ä¸ªåº”ç”¨äºæˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å°†è®­ç»ƒç¤ºä¾‹çš„æ•°é‡å¢åŠ ä¸€å€æˆ–ä¸‰å€ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ¨¡å‹ã€‚<br>æ”¹è¿›å¾ˆé‡è¦ï¼š<br>åœ¨æ²¡æœ‰æ•°æ®å¢å¼ºçš„æƒ…å†µä¸‹ï¼Œæˆ‘è·å¾—äº† 98.114% çš„å‡†ç¡®ç‡<br>é€šè¿‡æ•°æ®å¢å¼ºï¼Œæˆ‘è¾¾åˆ°äº† 99.67% çš„å‡†ç¡®ç‡</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># With data augmentation to prevent overfitting (accuracy 0.99286)</span>datagen <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>        featurewise_center<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># set input mean to 0 over the dataset</span>        samplewise_center<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># set each sample mean to 0</span>        featurewise_std_normalization<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># divide inputs by std of the dataset</span>        samplewise_std_normalization<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># divide each input by its std</span>        zca_whitening<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># apply ZCA whitening</span>        rotation_range<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>  <span class="token comment"># randomly rotate images in the range (degrees, 0 to 180)</span>        zoom_range <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token comment"># Randomly zoom image </span>        width_shift_range<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>  <span class="token comment"># randomly shift images horizontally (fraction of total width)</span>        height_shift_range<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>  <span class="token comment"># randomly shift images vertically (fraction of total height)</span>        horizontal_flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># randomly flip images</span>        vertical_flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># randomly flip images</span>datagen<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹äºæ•°æ®æ‰©å……ï¼Œæˆ‘é€‰æ‹©ï¼š<br>å°†ä¸€äº›è®­ç»ƒå›¾åƒéšæœºæ—‹è½¬ 10 åº¦<br>ä¸€äº›è®­ç»ƒå›¾åƒéšæœºç¼©æ”¾ 10%<br>å°†å›¾åƒæ°´å¹³éšæœºç§»åŠ¨ 10% çš„å®½åº¦<br>éšæœºå°†å›¾åƒå‚ç›´ç§»åŠ¨ 10% çš„é«˜åº¦<br>æˆ‘æ²¡æœ‰åº”ç”¨vertical_flip æˆ–horizontal_flipï¼Œå› ä¸ºå®ƒå¯èƒ½å¯¼è‡´é”™è¯¯åˆ†ç±»å¯¹ç§°æ•°å­—ï¼Œä¾‹å¦‚6 å’Œ9ã€‚<br>ä¸€æ—¦æˆ‘ä»¬çš„æ¨¡å‹å‡†å¤‡å¥½ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹Ÿåˆè®­ç»ƒæ•°æ®é›†ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Fit the model</span>history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>datagen<span class="token punctuation">.</span>flow<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>Y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">)</span><span class="token punctuation">,</span>                              epochs <span class="token operator">=</span> epochs<span class="token punctuation">,</span> validation_data <span class="token operator">=</span> <span class="token punctuation">(</span>X_val<span class="token punctuation">,</span>Y_val<span class="token punctuation">)</span><span class="token punctuation">,</span>                              verbose <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> steps_per_epoch<span class="token operator">=</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">//</span> batch_size                              <span class="token punctuation">,</span> callbacks<span class="token operator">=</span><span class="token punctuation">[</span>learning_rate_reduction<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å››ã€è¯„ä¼°æ¨¡å‹"><a href="#å››ã€è¯„ä¼°æ¨¡å‹" class="headerlink" title="å››ã€è¯„ä¼°æ¨¡å‹"></a>å››ã€è¯„ä¼°æ¨¡å‹</h4><h5 id="1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training-and-validation-curves"><a href="#1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training-and-validation-curves" class="headerlink" title="1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training and validation curves"></a>1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training and validation curves</h5><pre class="line-numbers language-none"><code class="language-none"># Plot the loss and accuracy curves for training and validation fig, ax = plt.subplots(2,1)ax[0].plot(history.history['loss'], color='b', label="Training loss")ax[0].plot(history.history['val_loss'], color='r', label="validation loss",axes =ax[0])legend = ax[0].legend(loc='best', shadow=True)ax[1].plot(history.history['acc'], color='b', label="Training accuracy")ax[1].plot(history.history['val_acc'], color='r',label="Validation accuracy")legend = ax[1].legend(loc='best', shadow=True)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.æ··æ·†çŸ©é˜µ</p><p>æ··æ·†çŸ©é˜µå¯¹äºæŸ¥çœ‹æ‚¨çš„æ¨¡å‹ç¼ºé™·éå¸¸æœ‰å¸®åŠ©ã€‚<br>æˆ‘ç»˜åˆ¶äº†éªŒè¯ç»“æœçš„æ··æ·†çŸ©é˜µã€‚</p><pre class="line-numbers language-none"><code class="language-none"># Look at confusion matrix def plot_confusion_matrix(cm, classes,                          normalize=False,                          title='Confusion matrix',                          cmap=plt.cm.Blues):    """    This function prints and plots the confusion matrix.    Normalization can be applied by setting `normalize=True`.    """    plt.imshow(cm, interpolation='nearest', cmap=cmap)    plt.title(title)    plt.colorbar()    tick_marks = np.arange(len(classes))    plt.xticks(tick_marks, classes, rotation=45)    plt.yticks(tick_marks, classes)    if normalize:        cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]    thresh = cm.max() / 2.    for i, j in itertools.product(range(cm.shape[0]), range(cm.shape[1])):        plt.text(j, i, cm[i, j],                 horizontalalignment="center",                 color="white" if cm[i, j] &gt; thresh else "black")    plt.tight_layout()    plt.ylabel('True label')    plt.xlabel('Predicted label')# Predict the values from the validation datasetY_pred = model.predict(X_val)# Convert predictions classes to one hot vectors Y_pred_classes = np.argmax(Y_pred,axis = 1) # Convert validation observations to one hot vectorsY_true = np.argmax(Y_val,axis = 1) # compute the confusion matrixconfusion_mtx = confusion_matrix(Y_true, Y_pred_classes) # plot the confusion matrixplot_confusion_matrix(confusion_mtx, classes = range(10)) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè€ƒè™‘åˆ°éªŒè¯é›†ï¼ˆ4200 å¼ å›¾åƒï¼‰çš„å¤§å°ï¼Œæˆ‘ä»¬çš„ CNN åœ¨æ‰€æœ‰æ•°å­—ä¸Šçš„è¡¨ç°éƒ½éå¸¸å¥½ï¼Œå‡ ä¹æ²¡æœ‰é”™è¯¯ã€‚<br>ä½†æ˜¯ï¼Œæˆ‘ä»¬çš„ CNN ä¼¼ä¹åœ¨ 4 ä½ä¸Šæœ‰ä¸€äº›å°é—®é¢˜ï¼Œå˜¿å˜¿è¢«è¯¯åˆ†ç±»ä¸º 9ã€‚æœ‰æ—¶å½“æ›²çº¿å¹³æ»‘æ—¶å¾ˆéš¾æ•æ‰åˆ° 4 å’Œ 9 ä¹‹é—´çš„å·®å¼‚ã€‚</p><p>è®©æˆ‘ä»¬è°ƒæŸ¥ä¸€ä¸‹é”™è¯¯ã€‚<br>æˆ‘æƒ³çœ‹çœ‹æœ€é‡è¦çš„é”™è¯¯ã€‚ä¸ºæ­¤ï¼Œæˆ‘éœ€è¦å¾—åˆ°ç»“æœä¸­å®é™…å€¼æ¦‚ç‡ä¸é¢„æµ‹å€¼æ¦‚ç‡ä¹‹é—´çš„å·®å¼‚ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Display some error results </span><span class="token comment"># Errors are difference between predicted labels and true labels</span>errors <span class="token operator">=</span> <span class="token punctuation">(</span>Y_pred_classes <span class="token operator">-</span> Y_true <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>Y_pred_classes_errors <span class="token operator">=</span> Y_pred_classes<span class="token punctuation">[</span>errors<span class="token punctuation">]</span>Y_pred_errors <span class="token operator">=</span> Y_pred<span class="token punctuation">[</span>errors<span class="token punctuation">]</span>Y_true_errors <span class="token operator">=</span> Y_true<span class="token punctuation">[</span>errors<span class="token punctuation">]</span>X_val_errors <span class="token operator">=</span> X_val<span class="token punctuation">[</span>errors<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">display_errors</span><span class="token punctuation">(</span>errors_index<span class="token punctuation">,</span>img_errors<span class="token punctuation">,</span>pred_errors<span class="token punctuation">,</span> obs_errors<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">""" This function shows 6 images with their predicted and real labels"""</span>    n <span class="token operator">=</span> <span class="token number">0</span>    nrows <span class="token operator">=</span> <span class="token number">2</span>    ncols <span class="token operator">=</span> <span class="token number">3</span>    fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>nrows<span class="token punctuation">,</span>ncols<span class="token punctuation">,</span>sharex<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>sharey<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nrows<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>ncols<span class="token punctuation">)</span><span class="token punctuation">:</span>            error <span class="token operator">=</span> errors_index<span class="token punctuation">[</span>n<span class="token punctuation">]</span>            ax<span class="token punctuation">[</span>row<span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token punctuation">(</span>img_errors<span class="token punctuation">[</span>error<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ax<span class="token punctuation">[</span>row<span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Predicted label :{}\nTrue label :{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>pred_errors<span class="token punctuation">[</span>error<span class="token punctuation">]</span><span class="token punctuation">,</span>obs_errors<span class="token punctuation">[</span>error<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            n <span class="token operator">+=</span> <span class="token number">1</span><span class="token comment"># Probabilities of the wrong predicted numbers</span>Y_pred_errors_prob <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>Y_pred_errors<span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># Predicted probabilities of the true values in the error set</span>true_prob_errors <span class="token operator">=</span> np<span class="token punctuation">.</span>diagonal<span class="token punctuation">(</span>np<span class="token punctuation">.</span>take<span class="token punctuation">(</span>Y_pred_errors<span class="token punctuation">,</span> Y_true_errors<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Difference between the probability of the predicted label and the true label</span>delta_pred_true_errors <span class="token operator">=</span> Y_pred_errors_prob <span class="token operator">-</span> true_prob_errors<span class="token comment"># Sorted list of the delta prob errors</span>sorted_dela_errors <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>delta_pred_true_errors<span class="token punctuation">)</span><span class="token comment"># Top 6 errors </span>most_important_errors <span class="token operator">=</span> sorted_dela_errors<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment"># Show the top 6 errors</span>display_errors<span class="token punctuation">(</span>most_important_errors<span class="token punctuation">,</span> X_val_errors<span class="token punctuation">,</span> Y_pred_classes_errors<span class="token punctuation">,</span> Y_true_errors<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€é‡è¦çš„é”™è¯¯ä¹Ÿæ˜¯æœ€ç‹¡çŒ¾çš„ã€‚<br>å¯¹äºè¿™å…­ä¸ªæ¡ˆä¾‹ï¼Œè¯¥æ¨¡å‹å¹¶ä¸è’è°¬ã€‚å…¶ä¸­ä¸€äº›é”™è¯¯ä¹Ÿå¯èƒ½æ˜¯äººä¸ºçš„ï¼Œç‰¹åˆ«æ˜¯å¯¹äºéå¸¸æ¥è¿‘ 4 çš„ 9ã€‚æœ€åçš„ 9 ä¹Ÿå¾ˆå®¹æ˜“äº§ç”Ÿè¯¯å¯¼ï¼Œå¯¹æˆ‘æ¥è¯´ä¼¼ä¹æ˜¯ 0ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># predict results</span>results <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token comment"># select the indix with the maximum probability</span>results <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>results<span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>results <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>results<span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">"Label"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">submission <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28001</span><span class="token punctuation">)</span><span class="token punctuation">,</span>name <span class="token operator">=</span> <span class="token string">"ImageId"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>results<span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>submission<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">"cnn_mnist_datagen.csv"</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kaggle </tag>
            
            <tag> å¸¸è§æ•°æ®å¤„ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-Lists</title>
      <link href="/2022/03/25/pe-lists/"/>
      <url>/2022/03/25/pe-lists/</url>
      
        <content type="html"><![CDATA[<h4 id="One-Resolution"><a href="#One-Resolution" class="headerlink" title="One Resolution"></a>One Resolution</h4><p>check method : aspect / entry / weight</p><p>å¨±ä¹ï¼šå’Œæœ‹å‹ä¸€èµ·å‚åŠ ä¸€æ¬¡å•¤é…’èŠ‚ / 3</p><p>å¨±ä¹ï¼šå…»ä¸¤åªå® ç‰©ï¼Œä¸€åªæ©˜çŒ«ï¼Œä¸€åªè¾¹ç‰§ / 2</p><p>å¨±ä¹ï¼šç‹¬è‡ªè¿›è¡Œä¸€æ¬¡æœåœ£ / 3</p><p>å¨±ä¹ï¼šæ—è§‚å‚åŠ ä¸€æ¬¡ DEFCON ä¼šè®®ï¼Œå¼¥è¡¥é—æ†¾ / 3</p><p>å¨±ä¹ï¼šå¸Œæœ›å»å‚åŠ èµ›è½¦[æ‘©æ‰˜ / å››é©±]æ¯”èµ›  / 3</p><p>å·¥ä½œï¼šå»æ‹œè®¿ gilbert strangï¼Œåœ¨æ•°å­¦è¿™æ–¹é¢ä»–ç»™æˆ‘é€ æˆäº†ä¸€äº›å½±å“ï¼Œä¸»è¦æ˜¯ä»–çœ‹èµ·æ¥æ¯”è¾ƒæœ‰è¶£  / 4</p><p>å·¥ä½œï¼šç ”ç©¶ç”Ÿæƒ³å»å¾®è½¯äºšæ´²ç ”ç©¶æ‰€ï¼ˆMSRAï¼‰å®ä¹  ï¼Œå®ä¹ æ–¹å‘å¤§è‡´æ˜¯ å¼ºåŒ–å­¦ä¹ ..AIç³»ç»Ÿå¼€å‘/ç ”ç©¶ / 5</p><p>å·¥ä½œï¼šå» google 42å±‚å·¥ä½œä¸€æ®µæ—¶é—´ï¼Œå¦å¤–æœ‰å¯èƒ½å°±å» google brain lab é‚£é‡Œçœ‹çœ‹ï¼Œé•¿é•¿é¢†åŸŸè§è¯†ï¼Œé¢†æ•™å„ç•Œå¤§ç¥é£é‡‡ / 5</p><p>å·¥ä½œï¼šåšå£«é˜¶æ®µèƒ½åœ¨ MIT é‚£é‡Œåšä¸€æ®µç ”ç©¶ï¼Œå¯¼å¸ˆï¼š aram harrowï¼ŒåŸå› æ˜¯è¿‘äº›å¹´ HHL é‚£ç¯‡paper è¾ƒä¸ºå‡ºåï¼Œç»„ä¹Ÿåœ¨æ‹›äºº / 5</p><p>å·¥ä½œï¼šå¸Œæœ›æœ‰ä¸€ä¸ªåœ¨å­¦ä¸šä¸Šä¸€ç›´æŒ‘æˆ‘æ¯›ç—…çš„â€æœ‹å‹â€œï¼Œç§‘ç ”å¯¹æ‰‹ / 5</p><p>å·¥ä½œï¼šæ¯•ä¸šå‰å®Œæˆæˆ‘çš„è®¾è®¡ / 3</p><p>å·¥ä½œï¼šæ¯•ä¸šå‰åœ¨kaggleä¸Šçº§åˆ«è¾¾åˆ° grandmaster ,è¿™ä¸ªå¯èƒ½ä¼šæ”¹å˜ï¼Œä¸ç¡®å®šå› ç´  / 4</p><p>å¨±ä¹ï¼šæ¯å¤©è¹­æœ‹å‹è½¦åœ¨å¤•é˜³ä¸‹å¼¹ä¸€é¦–ç¬¦åˆå¿ƒæƒ…çš„æ°‘è°£å›å®¶ï¼ˆä¸å–œæ¬¢å¼€è½¦ï¼Œä½†çƒ­è¡·æƒ³å¼€èµ›è½¦ï¼Œæ— è¯é©¾é©¶ï¼ï¼‰</p><p>~~åç»­è¡¥å……</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>æœ€å¤§æœ€å¤§çš„å¥¢æœ›å°±æ˜¯ è¯ºè´å°”ç‰©ç†å¥–æˆ–è€…å›¾çµå¥– / max</p><p>è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šåæ¯›ç—…ï¼Œä¸æƒ³æ”¹äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Personal </tag>
            
            <tag> Willing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-RingingRunåˆ¶ä½œ</title>
      <link href="/2022/03/17/pe-ringingrun-zhi-zuo/"/>
      <url>/2022/03/17/pe-ringingrun-zhi-zuo/</url>
      
        <content type="html"><![CDATA[<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>è¿™æ˜¯ä¸€ç¯‡æ¸¸æˆåˆ¶ä½œçš„è¿‡ç¨‹è®°å½•ä»¥åŠæˆ‘çš„ä¸€äº›ç®€é™‹å¦™è®¡</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>Game Design V1.0</p><p>å®šä½ï¼šä¸€æ¬¾é›†ä¹ç¬¦ã€è·‘é…·ã€å£°éŸ³ã€åƒç´ ã€ç”»é£äºä¸€ä½“çš„ä¼‘é—²æ¸¸æˆï¼Œå¸æ”¶éƒ¨åˆ† Mario çš„ç‰¹ç‚¹</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>äººç‰©ï¼šåƒç´ å°äººï¼Œè·‘åŠ¨æ—¶ä¼šæœ‰è‡ªå·±çš„åŠ¨ä½œï¼Œæ ¹æ®è‡ªå·±çš„å¤–è²Œè‡ªç»˜</p><p>ä¹ç¬¦ï¼šå°† mp3 ç­‰å…¶ä»–æ ¼å¼è½¬æ¢æˆ midi ï¼Œæ ¹æ® midi æ–‡ä»¶åˆ†è§£å‡ºç›¸åº”éŸ³ç¬¦æ¥ç”Ÿæˆå„ç§å„æ ·è‡ªç»˜çš„ä¹ç¬¦å’Œå›¾æ¡ˆï¼Œäº§ç”Ÿçš„éŸ³ç¬¦æŒ‰èŠ‚å¥åˆ†å¸ƒåœ¨åœ°å›¾çš„è·‘é“ä¸Š</p><p>è·‘é…·ï¼šMario æ¸¸æˆç‰¹ç‚¹ï¼Œè§’è‰²å¯ä»¥ä¸è·Ÿéšæ¸¸æˆèŠ‚å¥å‰è¿›æˆ–è€…åé€€</p><p>å£°éŸ³ï¼šéƒ¨åˆ†æ¨¡å—æ”¯æŒéº¦å…‹é£æ¥å°†å£°éŸ³åé¦ˆåˆ°æ¸¸æˆï¼Œä»¥æ­¤è·å¾—æ›´å¥½çš„ä½“éªŒ</p><p>åƒç´ ï¼šå…¨å±€çš„ä½“éªŒéƒ½æ˜¯åƒç´ é£æ ¼ï¼Œä»¿ç…§ Mario</p><p>ç”»é£ï¼šæ”¯æŒ æ²¹ç”»ï¼Œé»‘ç™½ç­‰ç»˜ç”»èƒŒæ™¯</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>æŠ€æœ¯éš¾ç‚¹ï¼š</p><p>1.ç½‘æ˜“éŸ³ä¹ .npm è½¬æ¢æˆ .mp3 åå˜æˆè°±åä¹å™¨éŸ³ç¬¦å’Œå’Œå¼¦ä¼šå˜å¾—å¾ˆç³Ÿç³•ï¼Œå¯¹äºè¿™å—å¯ä»¥å» çˆ±ç»™ç½‘ä¸‹è½½ midi æ¥è½¬æ¢æˆè°±</p><p>2.python åº“å¯¹ midi å¤„ç†çš„ä¸æ˜¯å¾ˆå¥½ï¼Œä¸èƒ½å°†ä¸€é¦– å¯¼å…¥çš„ midi æ–‡ä»¶å¤„ç†æˆä¸€ä¸ªä¸€ä¸ªéŸ³ç¬¦æ¥æ¼”å¥ï¼Œéœ€è¦è‡ªå·±æ¥é‡æ–°å†™å¯¹åº”æ­Œæ›²çš„ä»£ç </p><p>3.åæœŸæˆ‘æƒ³æ·»åŠ ä¸€éƒ¨åˆ† å¼ºåŒ–å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„éƒ¨åˆ†ï¼Œæ·±åº¦å­¦ä¹ æ¥æŠŠmidié‡Œé¢çš„æ–‡ä»¶æå–å‡ºæ¥ï¼Œå¼ºåŒ–å­¦ä¹ æ¥å®Œæˆè·‘é…·æ¸¸æˆçš„å®Œç¾è¡¨ç°</p>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸¸æˆåˆ¶ä½œ </tag>
            
            <tag> éŸ³æ¸¸è·‘é…· </tag>
            
            <tag> ç‹¬ç«‹è‡ªåˆ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-ASampleModel</title>
      <link href="/2022/03/17/ml-dl-asamplemodel/"/>
      <url>/2022/03/17/ml-dl-asamplemodel/</url>
      
        <content type="html"><![CDATA[<h4 id="lt-é€é¥æ¸¸-gt"><a href="#lt-é€é¥æ¸¸-gt" class="headerlink" title="<é€é¥æ¸¸>"></a>&lt;é€é¥æ¸¸&gt;</h4><p> åœ¨ kaggle courseaä¸Šå†™çš„ä¸€ä¸ªç®€æ˜“æ¨¡å‹ï¼Œæ²¡æœ‰åŒ…å«å¤ªå¤šçš„æŠ€æœ¯æ°´å¹³ï¼Œå‡‰è¿™äº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># linear algebra</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd <span class="token comment"># data processing, CSV file I/O (e.g. pd.read_csv)</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeRegressor  <span class="token comment"># å†³ç­–æ ‘</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_absolute_error <span class="token comment"># ç»å¯¹å‡å€¼è¯¯å·®</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split <span class="token comment"># è®­ç»ƒæµ‹è¯•åˆ†ç¦»</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestRegressor <span class="token comment"># éšæœºæ£®æ—</span><span class="token comment"># è¯»å…¥æ•°æ®</span>train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./train.csv'</span><span class="token punctuation">)</span>test <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./test.csv'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">train<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è®­ç»ƒé›†çš„ç»Ÿè®¡</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">test<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è¦é¢„æµ‹  SalePrice</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">train<span class="token punctuation">.</span>columns  <span class="token comment"># check columns infos</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">test<span class="token punctuation">.</span>columns <span class="token comment"># here have benn means to  predict "SalePrice"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">feature_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"LotArea"</span><span class="token punctuation">,</span><span class="token string">"YearBuilt"</span><span class="token punctuation">,</span><span class="token string">"1stFlrSF"</span><span class="token punctuation">,</span><span class="token string">"2ndFlrSF"</span><span class="token punctuation">,</span>                 <span class="token string">"FullBath"</span><span class="token punctuation">,</span><span class="token string">"BedroomAbvGr"</span><span class="token punctuation">,</span><span class="token string">"TotRmsAbvGrd"</span><span class="token punctuation">]</span>X <span class="token operator">=</span> train<span class="token punctuation">[</span>feature_names<span class="token punctuation">]</span>y <span class="token operator">=</span> train<span class="token punctuation">.</span>SalePrice<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">X<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">wrong_model <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># build model</span><span class="token comment"># fit the model</span>wrong_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># make predictions</span>predictions <span class="token operator">=</span> wrong_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>predictions<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># split in and uncomment</span>train_X<span class="token punctuation">,</span> val_X<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> val_y <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># specify the model</span>after_model <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># fit after_model with training data.</span>after_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_X<span class="token punctuation">,</span>train_y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">val_predictions <span class="token operator">=</span> after_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>val_X<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>val_predictions<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>val_y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">val_mae <span class="token operator">=</span> mean_absolute_error<span class="token punctuation">(</span>val_y<span class="token punctuation">,</span>val_predictions<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>val_mae<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># we will write the mean_absolute_error as a function</span><span class="token keyword">def</span> <span class="token function">get_mae</span><span class="token punctuation">(</span>max_leaf_nodes<span class="token punctuation">,</span>train_X<span class="token punctuation">,</span>val_X<span class="token punctuation">,</span>train_y<span class="token punctuation">,</span>val_y<span class="token punctuation">)</span><span class="token punctuation">:</span>    model <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span>max_leaf_nodes<span class="token operator">=</span>max_leaf_nodes<span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_X<span class="token punctuation">,</span>train_y<span class="token punctuation">)</span>    preds_val <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>val_X<span class="token punctuation">)</span>    mae <span class="token operator">=</span> mean_absolute_error<span class="token punctuation">(</span>val_y<span class="token punctuation">,</span>preds_val<span class="token punctuation">)</span>    <span class="token keyword">return</span> mae<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">candidate_max_leaf_nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">]</span><span class="token comment"># write loop to find the ideal tree size</span><span class="token comment"># intermediate for loop writing</span>scores <span class="token operator">=</span> <span class="token punctuation">{</span>leaf_size<span class="token punctuation">:</span> get_mae<span class="token punctuation">(</span>leaf_size<span class="token punctuation">,</span>train_X<span class="token punctuation">,</span>val_X<span class="token punctuation">,</span>train_y<span class="token punctuation">,</span>val_y<span class="token punctuation">)</span> <span class="token keyword">for</span> leaf_size <span class="token keyword">in</span> candidate_max_leaf_nodes<span class="token punctuation">}</span>best_tree_size <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>scores<span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> scores<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>best_tree_size<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># write the final model with fill n arguments</span>final_model <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span>max_leaf_nodes<span class="token operator">=</span>best_tree_size<span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>final_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span>final_test <span class="token operator">=</span> final_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>val_X<span class="token punctuation">)</span>final_test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># try use the rf-model</span>rf_model <span class="token operator">=</span> RandomForestRegressor<span class="token punctuation">(</span><span class="token punctuation">)</span>rf_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_X<span class="token punctuation">,</span>train_y<span class="token punctuation">)</span><span class="token comment"># this is me write down a corresponding right trick</span>rf_val_mae <span class="token operator">=</span> mean_absolute_error<span class="token punctuation">(</span>rf_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>val_X<span class="token punctuation">)</span><span class="token punctuation">,</span>val_y<span class="token punctuation">)</span>rf_val_mae<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">final_predictions <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token comment"># check the predictions</span>final_predictions<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">output <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Id'</span><span class="token punctuation">:</span> test_data<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>                       <span class="token string">'SalePrice'</span><span class="token punctuation">:</span> test_preds<span class="token punctuation">}</span><span class="token punctuation">)</span>output<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'submission.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="æäº¤"><a href="#æäº¤" class="headerlink" title="æäº¤"></a>æäº¤</h4>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kaggle </tag>
            
            <tag> ML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-logisticå›å½’åŸºæœ¬æ¦‚å¿µ</title>
      <link href="/2022/03/11/ml-dl-logistic-hui-gui-ji-ben-gai-nian/"/>
      <url>/2022/03/11/ml-dl-logistic-hui-gui-ji-ben-gai-nian/</url>
      
        <content type="html"><![CDATA[<h4 id="logisticå›å½’"><a href="#logisticå›å½’" class="headerlink" title="logisticå›å½’"></a>logisticå›å½’</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">##  åŸºç¡€å‡½æ•°åº“</span><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment">## å¯¼å…¥ç”»å›¾åº“</span><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns<span class="token comment">## å¯¼å…¥é€»è¾‘å›å½’æ¨¡å‹å‡½æ•°</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QC-Solutions</title>
      <link href="/2022/03/10/qc-solutions/"/>
      <url>/2022/03/10/qc-solutions/</url>
      
        <content type="html"><![CDATA[<h4 id="ä¸€ã€Realize-global-information"><a href="#ä¸€ã€Realize-global-information" class="headerlink" title="ä¸€ã€Realize global information"></a>ä¸€ã€Realize global information</h4><p>Quantum Computation and Quantum Information by Nielsen and Chuang(QCQI)</p><p>â€”QCQI Solutions(<a href="https://serab.net/docs/qcqi">https://serab.net/docs/qcqi</a>)</p><p>é‡å­é€šä¿¡å’Œé‡å­è®¡ç®—-ææ‰¿ç¥–</p><p>é‡å­è®¡ç®—å¯¼è®º-è°­æ™“é’ã€å®‹å©·å©·ã€ç¿å»º</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>é—²ä½™è¯»ç‰©ï¼ˆå¿½ç•¥ä¸è®¡ï¼‰</p><p>é‡å­è®¡ç®—æœºç¼–ç¨‹ï¼šä»å…¥é—¨åˆ°å®è·µ-åŸƒé‡Œå…‹â€¦</p><h4 id="äºŒã€Verification-platform-with-using-lib"><a href="#äºŒã€Verification-platform-with-using-lib" class="headerlink" title="äºŒã€Verification platform with using lib"></a>äºŒã€Verification platform with using lib</h4><p>IBM Quantum</p><h4 id="ä¸‰ã€Concerning-subjects"><a href="#ä¸‰ã€Concerning-subjects" class="headerlink" title="ä¸‰ã€Concerning subjects"></a>ä¸‰ã€Concerning subjects</h4><p>Math : Linear algebra &amp;&amp; Calculus &amp;&amp; Probability theory &amp;&amp; Group &amp;&amp;  Matrix &amp;&amp; Number theory &amp;&amp; Function analysis  (needing to master many subjects) </p><p>Computer Science : basic information process and program with pythonâ€¦etc </p><p>Physical : Quantum mechanics </p><p>PS : might need a method of mathematical physics to understand better in these different subjects </p><h4 id="å››ã€QC-amp-amp-QI-in-funny-point-field"><a href="#å››ã€QC-amp-amp-QI-in-funny-point-field" class="headerlink" title="å››ã€QC &amp;&amp; QI in funny point field"></a>å››ã€QC &amp;&amp; QI in funny point field</h4><p>ML : have some acceleration algos is more interesting .HHL/QSVD/QPCA/QSVM ..&gt; QNN</p><p>Acceleration classical algorithm :  in these algos , shor is the famous, but after understanding the principle inside,  final found this direction is a big pit </p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>last words is my little immature opinionï¼ŒQC algos is a bit rubbish ingredient inside,  very strange, you donâ€™t know how come from where, and it is described using complex number, lead to questions become more complicated. </p>]]></content>
      
      
      <categories>
          
          <category> QC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> QCQI </tag>
            
            <tag> data </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML-DL-kaggle-Part1</title>
      <link href="/2022/03/09/ml-dl-kaggle-part1/"/>
      <url>/2022/03/09/ml-dl-kaggle-part1/</url>
      
        <content type="html"><![CDATA[<h4 id="kaggleé‡Œè¦å¦‚ä½•èåˆæ¨¡å‹åŠä¸€èˆ¬çš„æ“ä½œæ–¹å¼"><a href="#kaggleé‡Œè¦å¦‚ä½•èåˆæ¨¡å‹åŠä¸€èˆ¬çš„æ“ä½œæ–¹å¼" class="headerlink" title="kaggleé‡Œè¦å¦‚ä½•èåˆæ¨¡å‹åŠä¸€èˆ¬çš„æ“ä½œæ–¹å¼"></a>kaggleé‡Œè¦å¦‚ä½•èåˆæ¨¡å‹åŠä¸€èˆ¬çš„æ“ä½œæ–¹å¼</h4><p>åŸå€ï¼škaggleä¸Šæ‰¾ä¸åˆ°äº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy  <span class="token comment"># linear algebra</span><span class="token keyword">import</span> pandas <span class="token comment"># æ•°æ®æ¸…æ´—ï¼Œåˆé˜¶å·¥ä½œéƒ¨åˆ†æ¥å¤„ç†csvéƒ¨åˆ†</span><span class="token keyword">import</span> os <span class="token comment"># è¯»å–æ–‡ä»¶è·¯å¾„</span><span class="token comment"># æ­¤åœºæ™¯ç”¨äºkaggleæä¾›çš„notebook</span><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'../input'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/(kaggle competition name)/train.csv'</span><span class="token punctuation">)</span>test <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/(kaggle competition name)/test.csv'</span><span class="token punctuation">)</span><span class="token comment"># æŸ¥çœ‹æ•°æ®çš„ç»´åº¦</span>train<span class="token punctuation">.</span>shape <span class="token comment"># print('Train set size:',train.shape)</span><span class="token comment"># å¯¹äºä¸€äº›æ— æ•ˆçš„æ•°æ®éœ€è¦è¿›è¡Œä¸å¯é¿å…çš„å¤„ç†,æ¯”å¦‚æ‰”æ‰</span>train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'æ ‡ç­¾åˆ—'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">#å¯¼å…¥è®¡ç®—æ¨¡å—ï¼Œå¯¹æ¨¡å—å¤§è‡´åŠŸèƒ½æ³¨è§£ï¼š</span><span class="token comment">#numpyæ”¯æŒçŸ©é˜µè¿ç®—</span><span class="token comment">#pandasç”¨æ¥åšæ•°æ®æ¸…æ´—ï¼Œåƒæ˜¯pythonä¸­çš„excelï¼ˆæ”¯æŒå°†æ•°æ®ä»¥.csvæ ¼å¼è¾“å‡ºè‡³æœ¬åœ°ï¼‰</span><span class="token comment">#sklearnç”¨æ¥è¿›ä¸€æ­¥åˆ¶ä½œæ•°æ®é›†ï¼ˆæ”¯æŒæ•°æ®çš„å¯¼å…¥å’Œæ•°æ®çš„å¯¼å‡ºï¼‰ï¼Œå«æœ‰SVMæ”¯æŒå‘é‡æœºã€DTå†³ç­–æ ‘ã€KNNè¿‘é‚»ã€LRé€»è¾‘å›å½’ç­‰å°è£…å¥½çš„æ¨¡å‹ï¼Œæ”¯æŒå¯¹æ•°æ®è¿›è¡Œäº¤å‰éªŒè¯ä»¥è°ƒå‚ã€‚</span><span class="token comment">#mlxtendç”¨æ¥å®ç°é›†æˆå­¦ä¹ ï¼šbagging, boosting, stacking</span><span class="token comment">#lightgbmå†…æœ‰boosting treeï¼ˆç›¸æ¯”xgboostï¼Œæ”¹è¿›äº†ç”ŸæˆèŠ‚ç‚¹çš„æ–¹å¼ï¼‰</span><span class="token comment">#xgboostå†…æœ‰boosting tree</span><span class="token comment">#osç”¨æ¥è¯»å–æ–‡ä»¶</span><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  <span class="token comment"># linear algebra</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  <span class="token comment">#</span><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">import</span> skew  <span class="token comment"># for some statistics</span><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>special <span class="token keyword">import</span> boxcox1p<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">import</span> boxcox_normmax<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> ElasticNetCV<span class="token punctuation">,</span> LassoCV<span class="token punctuation">,</span> RidgeCV<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> GradientBoostingRegressor<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVR<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> make_pipeline<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> RobustScaler<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> KFold<span class="token punctuation">,</span> cross_val_score<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token keyword">from</span> mlxtend<span class="token punctuation">.</span>regressor <span class="token keyword">import</span> StackingCVRegressor<span class="token keyword">from</span> xgboost <span class="token keyword">import</span> XGBRegressor<span class="token keyword">from</span> lightgbm <span class="token keyword">import</span> LGBMRegressor<span class="token keyword">import</span> os<span class="token comment">#######################################################æ•°æ®å¯¼å…¥å’Œç‰¹å¾æå–-ã€å¼€å§‹ã€‘################################################################################</span><span class="token comment">#æ˜¾ç¤ºå½“å‰ç¼–è¯‘å™¨çš„Draft Environmentä¸‹çš„æ–‡ä»¶ï¼›å°†æ–‡ä»¶å¤¹ä¸‹çš„å¯¹åº”åç§°csvæ–‡ä»¶å‚¨å­˜ä¸ºçŸ©é˜µå¯¹è±¡ã€‚</span><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">"../input"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/house-prices-advanced-regression-techniques/train.csv'</span><span class="token punctuation">)</span>test <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/house-prices-advanced-regression-techniques/test.csv'</span><span class="token punctuation">)</span><span class="token comment">#æ˜¾ç¤ºçŸ©é˜µå¯¹è±¡çš„ç»´æ•°ï¼Œæ ¸æŸ¥æ˜¯å¦å¯¼å…¥æˆåŠŸ</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train set size:"</span><span class="token punctuation">,</span> train<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Test set size:"</span><span class="token punctuation">,</span> test<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment">#è®°å½•è¿ç®—å¼€å§‹çš„æ—¶é—´</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'START data processing'</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token comment">#å–å‡ºtrainçŸ©é˜µï¼ˆæˆ–è€…ç§°ä¹‹ä¸ºâ€œæ•°æ®å¸§â€dataframeï¼‰ä¸­titleä¸º'Id'çš„åˆ—ï¼Œèµ‹å€¼ç»™train_IDã€‚æ‰€ä»¥train_IDæ˜¯ä¸€ç»´åˆ—å‘é‡äº†ã€‚test_IDç±»ä¼¼ã€‚</span><span class="token comment">#train_IDå’Œtest_IDæ ¹æœ¬å°±æ²¡æœ‰ä½¿ç”¨ï¼Œå®Œå…¨å¯ä»¥åˆ é™¤ã€‚</span><span class="token comment">#train_ID = train['Id']</span><span class="token comment">#test_ID = test['Id']</span><span class="token comment">##################åˆ é™¤è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„æ ‡ç­¾åˆ—-ã€å¼€å§‹ã€‘#################</span><span class="token comment">#å°†trainçŸ©é˜µä¸­çš„'Id'åˆ—åˆ é™¤ï¼ˆåŸåœ°åˆ é™¤ï¼Œæ•…å°†inplaceè®¾ä¸ºtrueï¼‰ï¼Œå› ä¸ºåŸå§‹æ•°æ®ä¸­çš„æ•°æ®ç´¢å¼•å’Œé¢„æµ‹æ¨¡å‹çš„æ„å»ºæ²¡æœ‰å…³ç³»ã€‚</span><span class="token comment">#testçŸ©é˜µç±»ä¼¼ã€‚</span>train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>test<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">##################åˆ é™¤è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„æ ‡ç­¾åˆ—-ã€ç»“æŸã€‘#################</span><span class="token comment">###############åˆ é™¤è®­ç»ƒé›†ä¸­çš„æç«¯å€¼å’Œè¿›è¡Œæ•°æ®indexæ›´æ–°-ã€å¼€å§‹ã€‘#########</span><span class="token comment">#ä½¿ç”¨æ¡ä»¶ç­›é€‰æ“ä½œï¼Œé€šè¿‡è¦†å€¼çš„æ–¹å¼å‰”é™¤åŸå§‹æ•°æ®trainçŸ©é˜µä¸­çš„æç«¯å€¼ï¼ˆæç«¯å€¼ä¹Ÿè¢«ç§°ä¸ºoutliersï¼‰ï¼Œå¸®åŠ©é¢„é˜²æˆ¿ä»·é¢„æµ‹æ¨¡å‹å‡ºç°è¿‡æ‹Ÿåˆã€‚å‰”é™¤æ“ä½œä¹Ÿå¯ä»¥è§†ä¸ºå‰å‰ªæã€‚</span>train <span class="token operator">=</span> train<span class="token punctuation">[</span>train<span class="token punctuation">.</span>GrLivArea <span class="token operator">&lt;</span> <span class="token number">4500</span><span class="token punctuation">]</span><span class="token comment">#ç”±äºåˆ å»äº†éƒ¨åˆ†è¡Œï¼Œæ•…æ­¤æ—¶trainçŸ©é˜µä¸­çš„indexåˆ—å¹¶ä¸è¿ç»­ã€‚ä½¿ç”¨reset_indexå‘½ä»¤ï¼Œåœ¨å›ºå®šéindexæ•°æ®çš„é¡ºåºçš„å‰æä¸‹ï¼ˆinplace=Trueï¼‰ï¼Œé‡æ–°å¯¹indexç¼–å·ï¼ˆdrop=Trueï¼‰ã€‚</span>train<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">###############åˆ é™¤è®­ç»ƒé›†ä¸­çš„æç«¯å€¼å’Œè¿›è¡Œæ•°æ®indexæ›´æ–°-ã€ç»“æŸã€‘#########</span><span class="token comment">##########å¯¹é¢„æµ‹ç›®æ ‡æ•°å€¼è¿›è¡Œå¯¹æ•°å˜æ¢å’Œç‰¹å¾çŸ©é˜µå¯¹è±¡çš„åˆ›å»º-ã€å¼€å§‹ã€‘#######</span><span class="token comment"># log1på°±æ˜¯log(1+x)ï¼Œç”¨æ¥å¯¹æˆ¿ä»·æ•°æ®è¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼Œå®ƒçš„å¥½å¤„æ˜¯è½¬åŒ–åçš„æ•°æ®æ›´åŠ æœä»é«˜æ–¯åˆ†å¸ƒï¼Œæœ‰åˆ©äºåç»­çš„åˆ†ç±»ç»“æœã€‚</span><span class="token comment"># éœ€è¦æ³¨æ„ï¼Œæœ€åéœ€è¦å°†é¢„æµ‹å‡ºçš„å¹³æ»‘æ•°æ®è¿˜åŸï¼Œè€Œè¿˜åŸè¿‡ç¨‹å°±æ˜¯log1pçš„é€†è¿ç®—expm1ã€‚</span>train<span class="token punctuation">[</span><span class="token string">"SalePrice"</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>log1p<span class="token punctuation">(</span>train<span class="token punctuation">[</span><span class="token string">"SalePrice"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#å•ç‹¬å–å‡ºè®­ç»ƒæ•°æ®ä¸­çš„æˆ¿ä»·åˆ—ä¿¡æ¯ï¼Œå­˜å…¥yå¯¹è±¡ã€‚</span><span class="token comment">#y = train.SalePrice.reset_index(drop=True) #.reset_index(drop=True)æ–¹æ³•ï¼šåœ¨åŸæœ‰çš„ç´¢å¼•åˆ—é‡ç½®ç´¢å¼•ï¼Œä¸å†å¦å¤–æ·»åŠ æ–°åˆ—ã€‚æœ‰å¿…è¦ä½¿ç”¨reset_indexå—ï¼Ÿæœ‰å¿…è¦çš„ï¼Œä¸è¿™æ ·åšyå°†æœ‰ä¸¤å¥—indexï¼Œä½œä¸ºdfçš„yå°†æœ‰ä¸¤åˆ—ã€‚</span>y <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'SalePrice'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#å¯¹ä¸Šå¼çš„æ”¹å†™</span><span class="token comment">#æ²¿ç€æ°´å¹³çš„æ–¹å‘å¯»æ‰¾åˆ—åä¸º'SalePrice'çš„åˆ—ï¼ˆä»¬ï¼‰ï¼ŒæŠŠå®ƒä»¬å¯¹åº”çš„åˆ—ç»Ÿç»Ÿåˆ æ‰ã€‚å¾—åˆ°äº†å•çº¯çš„ç‰¹å¾çŸ©é˜µï¼Œå­˜å…¥train_featureså¯¹è±¡ä¸­ã€‚</span>train_features <span class="token operator">=</span> train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'SalePrice'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#testæœ¬æ¥å°±æ²¡æœ‰æˆ¿ä»·åˆ—ï¼Œæ‰€ä»¥å®ƒæœ¬æ¥å°±æ˜¯å•çº¯çš„ç‰¹å¾çŸ©é˜µã€‚</span>test_features <span class="token operator">=</span> test<span class="token comment">##########å¯¹é¢„æµ‹ç›®æ ‡æ•°å€¼è¿›è¡Œå¯¹æ•°å˜æ¢å’Œç‰¹å¾çŸ©é˜µå¯¹è±¡çš„åˆ›å»º-ã€ç»“æŸã€‘#######</span><span class="token comment">##åˆå¹¶è®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µä¸æµ‹è¯•æ•°æ®ç‰¹å¾çŸ©é˜µï¼Œä»¥ä¾¿ç»Ÿä¸€è¿›è¡Œç‰¹å¾å¤„ç†-ã€å¼€å§‹ã€‘##</span><span class="token comment">#å°†è®­ç»ƒæ•°æ®ä¸­çš„ç‰¹å¾çŸ©é˜µå’Œæµ‹è¯•æ•°æ®ä¸­çš„ç‰¹å¾çŸ©é˜µåˆå¹¶ï¼ˆ.concat[çŸ©é˜µ1,çŸ©é˜µ2]ï¼‰ï¼Œå¹¶å¯¹åˆå¹¶åçš„çŸ©é˜µindexé‡æ–°ç¼–å·ï¼ˆ.reset_index(drop=True)ï¼‰ã€‚</span>features <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>train_features<span class="token punctuation">,</span> test_features<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">#æ£€æŸ¥åˆå¹¶åçš„çŸ©é˜µçš„ç»´æ•°ï¼Œæ ¸æŸ¥åˆå¹¶ç»“æœã€‚</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å‰”é™¤è®­ç»ƒæ•°æ®ä¸­çš„æç«¯å€¼åï¼Œå°†å…¶ç‰¹å¾çŸ©é˜µå’Œæµ‹è¯•æ•°æ®ä¸­çš„ç‰¹å¾çŸ©é˜µåˆå¹¶ï¼Œç»´åº¦ä¸º:"</span><span class="token punctuation">,</span>features<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment">##åˆå¹¶è®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µä¸æµ‹è¯•æ•°æ®ç‰¹å¾çŸ©é˜µï¼Œä»¥ä¾¿ç»Ÿä¸€è¿›è¡Œç‰¹å¾å¤„ç†-ã€ç»“æŸã€‘##</span><span class="token comment">#######################################################æ•°æ®å¯¼å…¥å’Œç‰¹å¾æå–-ã€ç»“æŸã€‘################################################################################</span><span class="token comment">##############################################################ç‰¹å¾å¤„ç†-ã€å¼€å§‹ã€‘###################################################################################</span><span class="token comment">#å¯¹äºåˆ—åä¸º'MSSubClass'ã€'YrSold'ã€'MoSold'çš„ç‰¹å¾åˆ—ï¼Œå°†åˆ—ä¸­çš„æ•°æ®ç±»å‹è½¬åŒ–ä¸ºstringæ ¼å¼ã€‚</span>features<span class="token punctuation">[</span><span class="token string">'MSSubClass'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'MSSubClass'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'YrSold'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'YrSold'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'MoSold'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'MoSold'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token comment">###############################å¡«å……ç©ºå€¼-ã€å¼€å§‹ã€‘##########################</span><span class="token comment">#æŒ‰ç…§ä»¥ä¸‹å„ä¸ªç‰¹å¾åˆ—çš„å®é™…æƒ…å†µï¼Œä¾æ¬¡å¤„ç†å„ä¸ªç‰¹å¾åˆ—ä¸­çš„ç©ºå€¼ï¼ˆ.fillna()æ–¹æ³•ï¼‰</span>features<span class="token punctuation">[</span><span class="token string">'Functional'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'Functional'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'Typ'</span><span class="token punctuation">)</span> <span class="token comment">#ç©ºå€¼å¡«å……ä¸ºstrå‹æ•°æ®'Typ'</span>features<span class="token punctuation">[</span><span class="token string">'Electrical'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'Electrical'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">"SBrkr"</span><span class="token punctuation">)</span> <span class="token comment">#ç©ºå€¼å¡«å……ä¸ºstrå‹æ•°æ®"SBrkr"</span>features<span class="token punctuation">[</span><span class="token string">'KitchenQual'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'KitchenQual'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">"TA"</span><span class="token punctuation">)</span> <span class="token comment">#ç©ºå€¼å¡«å……ä¸ºstrå‹æ•°æ®"TA"</span>features<span class="token punctuation">[</span><span class="token string">"PoolQC"</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">"PoolQC"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">"None"</span><span class="token punctuation">)</span> <span class="token comment">#ç©ºå€¼å¡«å……ä¸ºstrå‹æ•°æ®"None"</span><span class="token comment">#å¯¹äºåˆ—åä¸º'Exterior1st'ã€'Exterior2nd'ã€'SaleType'çš„ç‰¹å¾åˆ—ï¼Œä½¿ç”¨åˆ—ä¸­çš„ä¼—æ•°å¡«å……ç©ºå€¼ã€‚</span><span class="token comment">#1.å…ˆæŸ¥æ‰¾æ•°æ®åˆ—ä¸­çš„ä¼—æ•°ï¼šä½¿ç”¨df.mode()[]æ–¹æ³•</span><span class="token comment">#  è§£é‡Šï¼šdf.mode(0æˆ–1,0è¡¨ç¤ºå¯¹åˆ—æŸ¥æ‰¾ï¼Œ1è¡¨ç¤ºå¯¹è¡ŒæŸ¥æ‰¾)[éœ€è¦æŸ¥æ‰¾ä¼—æ•°çš„dfåˆ—çš„indexï¼ˆå°±æ˜¯dfä¸­çš„ç¬¬å‡ åˆ—ï¼‰]ï¼Œå°†è¿”å›æ•°æ®åˆ—ä¸­çš„ä¼—æ•°</span><span class="token comment">#2.ä½¿ç”¨.fillna()æ–¹æ³•è¿›è¡Œå¡«å……</span>features<span class="token punctuation">[</span><span class="token string">'Exterior1st'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'Exterior1st'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token string">'Exterior1st'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> features<span class="token punctuation">[</span><span class="token string">'Exterior2nd'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'Exterior2nd'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token string">'Exterior2nd'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'SaleType'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'SaleType'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token string">'SaleType'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#å¯¹äºåˆ—åä¸º'GarageYrBlt', 'GarageArea', 'GarageCars'çš„ç‰¹å¾åˆ—ï¼Œä½¿ç”¨0å¡«å……ç©ºå€¼ã€‚</span><span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'GarageYrBlt'</span><span class="token punctuation">,</span> <span class="token string">'GarageArea'</span><span class="token punctuation">,</span> <span class="token string">'GarageCars'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    features<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">#å¯¹äºåˆ—åä¸º'GarageType', 'GarageFinish', 'GarageQual', 'GarageCond'çš„ç‰¹å¾åˆ—ï¼Œä½¿ç”¨å­—ç¬¦ä¸²'None'å¡«å……ç©ºå€¼ã€‚</span><span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'GarageType'</span><span class="token punctuation">,</span> <span class="token string">'GarageFinish'</span><span class="token punctuation">,</span> <span class="token string">'GarageQual'</span><span class="token punctuation">,</span> <span class="token string">'GarageCond'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    features<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'None'</span><span class="token punctuation">)</span><span class="token comment">#å¯¹äºåˆ—åä¸º'BsmtQual', 'BsmtCond', 'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2'çš„ç‰¹å¾åˆ—ï¼Œä½¿ç”¨å­—ç¬¦ä¸²'None'å¡«å……ç©ºå€¼ã€‚</span><span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'BsmtQual'</span><span class="token punctuation">,</span> <span class="token string">'BsmtCond'</span><span class="token punctuation">,</span> <span class="token string">'BsmtExposure'</span><span class="token punctuation">,</span> <span class="token string">'BsmtFinType1'</span><span class="token punctuation">,</span> <span class="token string">'BsmtFinType2'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    features<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'None'</span><span class="token punctuation">)</span><span class="token comment">#èšåˆå‡½æ•°ï¼ˆæŒ‰æŸä¸€åˆ—å…³é”®å­—åˆ†ç»„ï¼‰groupbyï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šå°†è¿”å›ä¸ä¼ å…¥æ–¹æ³•çš„çŸ©é˜µç»´åº¦ç›¸åŒçš„å•ä¸ªåºåˆ—ã€‚</span><span class="token comment">#transformæ˜¯ä¸groupbyï¼ˆpandasä¸­æœ€æœ‰ç”¨çš„æ“ä½œä¹‹ä¸€ï¼‰é€šå¸¸ç»„åˆä½¿ç”¨ï¼Œå®ƒå¯¹ä¼ å…¥æ–¹æ³•çš„çŸ©é˜µè¿›è¡Œç»´åº¦ä¸å˜çš„å˜æ¢ã€‚å…·ä½“å˜æ¢æ–¹æ³•å†™åœ¨æ‹¬å·ä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨åŒ¿åå‡½æ•°ï¼Œå¯¹ä¼ å…¥çŸ©é˜µçš„æ‰€æœ‰å…ƒç´ è¿›è¡Œæ“ä½œã€‚</span><span class="token comment">#å¯¹äºfeaturesçŸ©é˜µï¼ŒæŒ‰ç…§'MSSubClass'åˆ—ä¸­çš„å…ƒç´ åˆ†å¸ƒè¿›è¡Œåˆ†ç»„ï¼Œè¢«åˆ†ç»„çš„æ•°æ®åˆ—æ˜¯'MSZoning'åˆ—ã€‚feature.groupby(è¢«ä½œä¸ºç´¢å¼•çš„åˆ—çš„åç§°)[è¢«åˆ†ç»„çš„æ•°æ®åˆ—çš„åç§°]</span><span class="token comment">#features.groupby('MSSubClass')['MSZoning']åï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªä»¥'MSSubClass'ä¸ºç´¢å¼•ï¼Œä»¥'MSZoning'ä¸ºæ•°æ®åˆ—çš„çŸ©é˜µã€‚</span><span class="token comment">#.transform()æ–¹æ³•å°†å¯¹'MSZoning'æ•°æ®åˆ—è¿›è¡Œ()å†…çš„å˜æ¢ï¼Œå®ƒå°†è¿”å›å’Œä¼ å…¥çŸ©é˜µåŒæ ·ç»´åº¦çš„çŸ©é˜µã€‚</span><span class="token comment">#æ‹¬å·å†…æ˜¯åŒ¿åå‡½æ•°ï¼Œå°†å¯¹ä¼ å…¥çŸ©é˜µä¸­çš„ç©ºå€¼è¿›è¡Œå¡«å……ï¼Œä½¿ç”¨çš„å¡«å……å…ƒç´ æ˜¯ä¼ å…¥çŸ©é˜µä¸­çš„ä¼—æ•°ã€‚</span>features<span class="token punctuation">[</span><span class="token string">'MSZoning'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'MSSubClass'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'MSZoning'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>x<span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#åˆ¤æ–­å‡ºfeaturesçŸ©é˜µä¸­åˆ—ä¸ºå¯¹è±¡çš„åˆ—ï¼Œå°†åˆ—åå­˜å…¥objectså”ç¥–ã€‚å¯¹äºfeaturesçŸ©é˜µä¸­çš„å„ä¸ªåˆ—å¯¹è±¡ï¼Œå°†å…¶åˆ—ä¸­çš„ç©ºå€¼å¡«å……ä¸º'None'</span>objects <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> features<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>    <span class="token keyword">if</span> features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>dtype <span class="token operator">==</span> <span class="token builtin">object</span><span class="token punctuation">:</span>        objects<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>features<span class="token punctuation">.</span>update<span class="token punctuation">(</span>features<span class="token punctuation">[</span>objects<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'None'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#ä½¿ç”¨ä¼ å…¥çŸ©é˜µï¼ˆ'LotFrontage'åˆ—ï¼‰çš„ä¸­ä½æ•°å¯¹ä¼ å…¥çŸ©é˜µä¸­çš„ç©ºå€¼è¿›è¡Œå¡«å……ã€‚</span><span class="token comment">#å…ˆä»¥'Neighborhood'ä¸ºæ ‡ç­¾ï¼Œä»¥'LotFrontage'ä¸ºè¢«æ±‡æ€»åºåˆ—ã€‚ç„¶åä½¿ç”¨è¢«æ±‡æ€»åºåˆ—ä¸­çš„ä¸­ä½æ•°ï¼Œå¯¹åŸå§‹çŸ©é˜µ'LotFrontage'åˆ—ä¸­çš„ç©ºå€¼è¿›è¡Œå¡«å……ã€‚</span><span class="token comment">#transformçš„ç‰¹æ€§æ˜¯åŒç»´æ“ä½œï¼Œæœ€åè¾“å‡ºç»“æœçš„é¡ºåºå’ŒåŸå§‹æ•°æ®åœ¨åºå·ä¸Šå®Œå…¨åŒ¹é…ã€‚</span>features<span class="token punctuation">[</span><span class="token string">'LotFrontage'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Neighborhood'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'LotFrontage'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>x<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å¯¹äºæ•´å‹å’Œæµ®ç‚¹å‹æ•°æ®åˆ—ï¼Œä½¿ç”¨0å¡«å……å…¶ä¸­çš„ç©ºå€¼ã€‚</span>numeric_dtypes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'int16'</span><span class="token punctuation">,</span> <span class="token string">'int32'</span><span class="token punctuation">,</span> <span class="token string">'int64'</span><span class="token punctuation">,</span> <span class="token string">'float16'</span><span class="token punctuation">,</span> <span class="token string">'float32'</span><span class="token punctuation">,</span> <span class="token string">'float64'</span><span class="token punctuation">]</span>numerics <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> features<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>    <span class="token keyword">if</span> features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>dtype <span class="token keyword">in</span> numeric_dtypes<span class="token punctuation">:</span>        numerics<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>features<span class="token punctuation">.</span>update<span class="token punctuation">(</span>features<span class="token punctuation">[</span>numerics<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">###############################å¡«å……ç©ºå€¼-ã€ç»“æŸã€‘##########################</span><span class="token comment">######################æ•°å­—å‹æ•°æ®åˆ—ååº¦æ ¡æ­£-ã€å¼€å§‹ã€‘#######################</span><span class="token comment">#ä½¿ç”¨skew()æ–¹æ³•ï¼Œè®¡ç®—æ‰€æœ‰æ•´å‹å’Œæµ®ç‚¹å‹æ•°æ®åˆ—ä¸­ï¼Œæ•°æ®åˆ†å¸ƒçš„ååº¦ï¼ˆskewnessï¼‰ã€‚</span><span class="token comment">#ååº¦æ˜¯ç»Ÿè®¡æ•°æ®åˆ†å¸ƒåæ–œæ–¹å‘å’Œç¨‹åº¦çš„åº¦é‡ï¼Œæ˜¯ç»Ÿè®¡æ•°æ®åˆ†å¸ƒéå¯¹ç§°ç¨‹åº¦çš„æ•°å­—ç‰¹å¾ã€‚äº¦ç§°åæ€ã€åæ€ç³»æ•°ã€‚ </span>numeric_dtypes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'int16'</span><span class="token punctuation">,</span> <span class="token string">'int32'</span><span class="token punctuation">,</span> <span class="token string">'int64'</span><span class="token punctuation">,</span> <span class="token string">'float16'</span><span class="token punctuation">,</span> <span class="token string">'float32'</span><span class="token punctuation">,</span> <span class="token string">'float64'</span><span class="token punctuation">]</span>numerics2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> features<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>    <span class="token keyword">if</span> features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>dtype <span class="token keyword">in</span> numeric_dtypes<span class="token punctuation">:</span>        numerics2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>skew_features <span class="token operator">=</span> features<span class="token punctuation">[</span>numerics2<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> skew<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token comment">#ä»¥0.5ä½œä¸ºåŸºå‡†ï¼Œç»Ÿè®¡ååº¦è¶…è¿‡æ­¤æ•°å€¼çš„é«˜ååº¦åˆ†å¸ƒæ•°æ®åˆ—ï¼Œè·å–è¿™äº›æ•°æ®åˆ—çš„indexã€‚</span>high_skew <span class="token operator">=</span> skew_features<span class="token punctuation">[</span>skew_features <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">]</span>skew_index <span class="token operator">=</span> high_skew<span class="token punctuation">.</span>index<span class="token comment">#å¯¹é«˜ååº¦æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå°†å…¶è½¬åŒ–ä¸ºæ­£æ€åˆ†å¸ƒã€‚</span><span class="token comment">#Boxå’ŒCoxæå‡ºçš„å˜æ¢å¯ä»¥ä½¿çº¿æ€§å›å½’æ¨¡å‹æ»¡è¶³çº¿æ€§æ€§ã€ç‹¬ç«‹æ€§ã€æ–¹å·®é½æ¬¡ä»¥åŠæ­£æ€æ€§çš„åŒæ—¶ï¼Œåˆä¸ä¸¢å¤±ä¿¡æ¯ã€‚</span><span class="token keyword">for</span> i <span class="token keyword">in</span> skew_index<span class="token punctuation">:</span>    features<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> boxcox1p<span class="token punctuation">(</span>features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> boxcox_normmax<span class="token punctuation">(</span>features<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è¿™æ˜¯boxcox1pçš„ä½¿ç”¨æ–¹æ³•ï¼Œå‚æ•°çš„å…·ä½“æ„ä¹‰æš‚æ—¶ä¸è§£é‡Š</span><span class="token comment">######################æ•°å­—å‹æ•°æ®åˆ—ååº¦æ ¡æ­£-ã€ç»“æŸã€‘#######################</span><span class="token comment">######################ç‰¹å¾åˆ é™¤å’Œèåˆåˆ›å»ºæ–°ç‰¹å¾-ã€å¼€å§‹ã€‘###################</span><span class="token comment">#åˆ é™¤ä¸€äº›ç‰¹å¾ã€‚df.dropï¼ˆâ€˜åˆ—åâ€™, axis=1ï¼‰ä»£è¡¨å°†â€˜åˆ—åâ€™å¯¹åº”çš„åˆ—æ ‡ç­¾ï¼ˆä»¬ï¼‰æ²¿ç€æ°´å¹³çš„æ–¹å‘ä¾æ¬¡åˆ æ‰ã€‚</span>features <span class="token operator">=</span> features<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Utilities'</span><span class="token punctuation">,</span> <span class="token string">'Street'</span><span class="token punctuation">,</span> <span class="token string">'PoolQC'</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#èåˆå¤šä¸ªç‰¹å¾ï¼Œç”Ÿæˆæ–°ç‰¹å¾ã€‚</span>features<span class="token punctuation">[</span><span class="token string">'YrBltAndRemod'</span><span class="token punctuation">]</span><span class="token operator">=</span>features<span class="token punctuation">[</span><span class="token string">'YearBuilt'</span><span class="token punctuation">]</span><span class="token operator">+</span>features<span class="token punctuation">[</span><span class="token string">'YearRemodAdd'</span><span class="token punctuation">]</span>features<span class="token punctuation">[</span><span class="token string">'TotalSF'</span><span class="token punctuation">]</span><span class="token operator">=</span>features<span class="token punctuation">[</span><span class="token string">'TotalBsmtSF'</span><span class="token punctuation">]</span> <span class="token operator">+</span> features<span class="token punctuation">[</span><span class="token string">'1stFlrSF'</span><span class="token punctuation">]</span> <span class="token operator">+</span> features<span class="token punctuation">[</span><span class="token string">'2ndFlrSF'</span><span class="token punctuation">]</span>features<span class="token punctuation">[</span><span class="token string">'Total_sqr_footage'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token string">'BsmtFinSF1'</span><span class="token punctuation">]</span> <span class="token operator">+</span> features<span class="token punctuation">[</span><span class="token string">'BsmtFinSF2'</span><span class="token punctuation">]</span> <span class="token operator">+</span>                                 features<span class="token punctuation">[</span><span class="token string">'1stFlrSF'</span><span class="token punctuation">]</span> <span class="token operator">+</span> features<span class="token punctuation">[</span><span class="token string">'2ndFlrSF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'Total_Bathrooms'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token string">'FullBath'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">*</span> features<span class="token punctuation">[</span><span class="token string">'HalfBath'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span>                               features<span class="token punctuation">[</span><span class="token string">'BsmtFullBath'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">*</span> features<span class="token punctuation">[</span><span class="token string">'BsmtHalfBath'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'Total_porch_sf'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token string">'OpenPorchSF'</span><span class="token punctuation">]</span> <span class="token operator">+</span> features<span class="token punctuation">[</span><span class="token string">'3SsnPorch'</span><span class="token punctuation">]</span> <span class="token operator">+</span>                              features<span class="token punctuation">[</span><span class="token string">'EnclosedPorch'</span><span class="token punctuation">]</span> <span class="token operator">+</span> features<span class="token punctuation">[</span><span class="token string">'ScreenPorch'</span><span class="token punctuation">]</span> <span class="token operator">+</span>                              features<span class="token punctuation">[</span><span class="token string">'WoodDeckSF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#ç®€åŒ–ç‰¹å¾ã€‚å¯¹äºæŸäº›åˆ†å¸ƒå•è°ƒï¼ˆæ¯”å¦‚100ä¸ªæ•°æ®ä¸­æœ‰99ä¸ªçš„æ•°å€¼æ˜¯0.9ï¼Œå¦1ä¸ªæ˜¯0.1ï¼‰çš„æ•°å­—å‹æ•°æ®åˆ—ï¼Œè¿›è¡Œ01å–å€¼å¤„ç†ã€‚</span>features<span class="token punctuation">[</span><span class="token string">'haspool'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'PoolArea'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'has2ndfloor'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'2ndFlrSF'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'hasgarage'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'GarageArea'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'hasbsmt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'TotalBsmtSF'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'hasfireplace'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'Fireplaces'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">#æ£€æŸ¥ç‰¹å¾å¤„ç†åï¼Œç‰¹å¾çŸ©é˜µçš„ç»´æ•°ï¼Œæ ¸æŸ¥ç‰¹å¾å¤„ç†ç»“æœã€‚</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤äº†3ä¸ªç‰¹å¾ï¼Œåˆèåˆåˆ›å»ºäº†10ä¸ªæ–°ç‰¹å¾ï¼Œå¤„ç†ä¹‹åçš„ç‰¹å¾çŸ©é˜µç»´åº¦ä¸º:"</span><span class="token punctuation">,</span>features<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment">######################ç‰¹å¾åˆ é™¤å’Œèåˆåˆ›å»ºæ–°ç‰¹å¾-ã€ç»“æŸã€‘###################</span><span class="token comment">####################ç‰¹å¾æŠ•å½±ã€ç‰¹å¾çŸ©é˜µæ‹†è§£å’Œæˆªå–-ã€å¼€å§‹ã€‘#################</span><span class="token comment">#ä½¿ç”¨.get_dummies()æ–¹æ³•å¯¹ç‰¹å¾çŸ©é˜µè¿›è¡Œç±»ä¼¼â€œåæ ‡æŠ•å½±â€æ“ä½œã€‚è·å¾—åœ¨æ–°ç©ºé—´ä¸‹çš„ç‰¹å¾è¡¨è¾¾ã€‚</span>final_features <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>features<span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">#æ‰“å°æ–°ç©ºé—´ä¸‹çš„ç‰¹å¾ç»´æ•°ï¼Œä¹Ÿæ˜¯æ–°ç©ºé—´çš„ç»´æ•°ã€‚</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ä½¿ç”¨get_dummies()æ–¹æ³•â€œæŠ•å½±â€ç‰¹å¾çŸ©é˜µï¼Œå³åˆ†è§£å‡ºæ›´å¤šç‰¹å¾ï¼Œå¾—åˆ°æ›´å¤šåˆ—ã€‚æŠ•å½±åçš„ç‰¹å¾çŸ©é˜µç»´åº¦ä¸º:"</span><span class="token punctuation">,</span>final_features<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment">#è¿›è¡Œç‰¹å¾ç©ºé—´é™é˜¶ã€‚æˆªå–å‰len(y)è¡Œï¼Œå­˜å…¥Xé˜µï¼ˆå› ä¸ºä¹‹å‰è¿›è¡Œäº†è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®çš„åˆå¹¶ï¼Œæ‰€ä»¥ä»åˆå¹¶çŸ©é˜µä¸­å–å‡ºå‰len(y)è¡Œï¼Œå°±å¾—åˆ°äº†è®­ç»ƒæ•°æ®é›†çš„å¤„ç†åçš„ç‰¹å¾çŸ©é˜µï¼‰ã€‚</span><span class="token comment">#æˆªå–å‰©ä½™éƒ¨åˆ†ï¼Œå³ä»åºå·ä¸ºlen(y)çš„è¡Œå¼€å§‹ï¼Œè‡³çŸ©é˜µç»“å°¾çš„å„è¡Œï¼Œå­˜å…¥X_subé˜µã€‚æ­¤ä¸ºå®Œæˆç‰¹å¾å˜æ¢åçš„æµ‹è¯•é›†ç‰¹å¾çŸ©é˜µã€‚</span><span class="token comment">#æ³¨ï¼šlen(df)æ˜¯è¡Œè®¡æ•°æ–¹æ³•</span>X <span class="token operator">=</span> final_features<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment">#yæ˜¯åˆ—å‘é‡ï¼Œå­˜å‚¨äº†è®­ç»ƒæ•°æ®ä¸­çš„æˆ¿ä»·åˆ—ä¿¡æ¯ã€‚æˆªå–åå¾—åˆ°çš„Xé˜µçš„ç»´åº¦æ˜¯len(y)*(final_featuresçš„åˆ—æ•°)ã€‚</span>X_sub <span class="token operator">=</span> final_features<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment">#ä½¿ç”¨lenå‘½ä»¤ï¼Œæ±‚çŸ©é˜µXçš„é•¿åº¦ï¼Œå¾—åˆ°çš„æ˜¯çŸ©é˜µå¯¹è±¡çš„é•¿åº¦ï¼Œå³æœ‰çŸ©é˜µä¸­æœ‰å¤šå°‘åˆ—ï¼Œè€Œä¸æ˜¯æ¯åˆ—ä¸Šæœ‰å¤šå°‘è¡Œã€‚</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤äº†3ä¸ªç‰¹å¾ï¼Œåˆèåˆåˆ›å»ºäº†10ä¸ªæ–°ç‰¹å¾ï¼Œå¤„ç†ä¹‹åçš„ç‰¹å¾çŸ©é˜µç»´åº¦ä¸º:"</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> <span class="token string">'X_sub'</span><span class="token punctuation">,</span> X_sub<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment">#åœ¨æ–°ç”Ÿç‰¹å¾ç©ºé—´ä¸­ï¼Œå‰”é™¤Xé˜µå’Œyé˜µä¸­æœ‰ç€æç«¯å€¼çš„å„è¡Œæ•°æ®ï¼ˆå› ä¸ºXå’Œyé˜µåœ¨æ°´å¹³æ–¹å‘ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥è¦ä¸€èµ·åˆ é™¤åŒæ ·çš„è¡Œï¼‰ã€‚outliersæ•°å€¼ä¸­ç»™å‡ºäº†æç«¯å€¼çš„åˆ—åºå·ã€‚</span><span class="token comment">#df.drop(df.index[åºå·])å°†åˆ é™¤æŒ‡å®šåºå·çš„å„è¡Œã€‚å†ä½¿ç”¨=å¯¹dfè¦†å€¼ã€‚</span>outliers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">462</span><span class="token punctuation">,</span> <span class="token number">631</span><span class="token punctuation">,</span> <span class="token number">1322</span><span class="token punctuation">]</span>X <span class="token operator">=</span> X<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>X<span class="token punctuation">.</span>index<span class="token punctuation">[</span>outliers<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#å› ä¸ºXé˜µæ˜¯ç»è¿‡å¯¹ç‰¹å¾çŸ©é˜µè¿›è¡Œç±»ä¼¼â€œåæ ‡æŠ•å½±â€æ“ä½œåå¾—åˆ°çš„ï¼Œåˆ—å‘é‡yä¸­çš„è¡Œå·å¯¹åº”ç€Xé˜µä¸­çš„åˆ—å·ã€‚</span>y <span class="token operator">=</span> y<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>y<span class="token punctuation">.</span>index<span class="token punctuation">[</span>outliers<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">####################ç‰¹å¾æŠ•å½±ã€ç‰¹å¾çŸ©é˜µæ‹†è§£å’Œæˆªå–-ã€ç»“æŸã€‘#################</span><span class="token comment">######################æ¶ˆé™¤æˆªå–åç‰¹å¾çŸ©é˜µçš„è¿‡æ‹Ÿåˆ-ã€å¼€å§‹ã€‘#######################  è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯å¤„ç†Xé˜µå’ŒX_subé˜µã€‚</span><span class="token comment">#åœ¨æ–°ç”Ÿç‰¹å¾ç©ºé—´ä¸­ï¼Œåˆ é™¤å°†äº§ç”Ÿè¿‡æ‹Ÿåˆçš„æ•°æ®åˆ—ã€‚</span><span class="token comment">#è¿™ç§æ•°æ®åˆ—å…·æœ‰å¦‚ä¸‹ç‰¹å¾ï¼š</span>overfit <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment">#ç”¨æ¥è®°å½•äº§ç”Ÿè¿‡æ‹Ÿåˆçš„æ•°æ®åˆ—çš„åºå·</span><span class="token keyword">for</span> i <span class="token keyword">in</span> X<span class="token punctuation">.</span>columns<span class="token punctuation">:</span><span class="token comment">#éå†æˆªå–åç‰¹å¾çŸ©é˜µçš„æ¯ä¸€åˆ—</span>    counts <span class="token operator">=</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#ä½¿ç”¨.value_counts()æ–¹æ³•ï¼ŒæŸ¥çœ‹åœ¨XçŸ©é˜µçš„ç¬¬iåˆ—ä¸­ï¼Œä¸åŒçš„å–å€¼åˆ†åˆ«å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œé»˜è®¤æŒ‰æ¬¡æ•°æœ€é«˜åˆ°æœ€ä½åšé™åºæ’åˆ—ã€‚è¿”å›ä¸€ä¸ªdfã€‚</span>    zeros <span class="token operator">=</span> counts<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token comment">#é€šè¿‡è¡Œå·ç´¢å¼•è¡Œæ•°æ®ï¼Œå–å‡ºcountsåˆ—ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå³å‡ºç°æ¬¡æ•°æœ€å¤šçš„å–å€¼åˆ°åº•æ˜¯å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œå­˜å…¥zeros</span>    <span class="token keyword">if</span> zeros <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">&gt;</span> <span class="token number">99.94</span><span class="token punctuation">:</span><span class="token comment">#åˆ¤æ–­æŸä¸€åˆ—æ˜¯å¦å°†äº§ç”Ÿè¿‡æ‹Ÿåˆçš„æ¡ä»¶ï¼š</span><span class="token comment">#æˆªå–åçš„ç‰¹å¾çŸ©é˜µæœ‰len(X)åˆ—ï¼Œå¦‚æœæŸä¸€åˆ—ä¸­çš„æŸä¸ªå€¼å‡ºç°çš„æ¬¡æ•°é™¤ä»¥ç‰¹å¾çŸ©é˜µçš„åˆ—æ•°è¶…è¿‡99.94%ï¼Œå³å…¶å‡ ä¹åœ¨è¢«æŠ•å½±çš„å„ä¸ªç»´åº¦ä¸Šéƒ½æœ‰ç€åŒæ ·çš„å–å€¼ï¼Œå¹¶ä¸å…·æœ‰â€œä¸»æˆåˆ†â€çš„æ€§è´¨ï¼Œåˆ™è®°ä¸ºè¿‡æ‹Ÿåˆåˆ—ã€‚</span>        overfit<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token comment">#æ‰¾åˆ°å°†äº§ç”Ÿè¿‡æ‹Ÿåˆçš„æ•°æ®åˆ—çš„ä½ç½®åï¼Œåœ¨ç‰¹å¾çŸ©é˜µä¸­è¿›è¡Œåˆ é™¤æ“ä½œã€‚</span>overfit <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>overfit<span class="token punctuation">)</span><span class="token comment">#overfit.append('MSZoning_C (all)')#è¿™æ¡è¯­å¥æœ‰ç”¨å—ï¼Ÿæ˜¯è¦æŠŠè®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µXä¸­çš„åˆ—æ ‡ç­¾ä¸º'MSZoning_C (all)'çš„åˆ—ä¹Ÿåˆ é™¤å—ï¼Ÿä½†æ˜¯è®­ç»ƒæ•°æ®ä¸­å¹¶æ²¡æœ‰ä»»ä½•ä¸€ä¸ªåˆ—æ ‡ç­¾åç§°ä¸ºMSZoning_C (all)ã€‚</span>X <span class="token operator">=</span> X<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>overfit<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#.copy()#åˆ é™¤æˆªå–åç‰¹å¾çŸ©é˜µXä¸­çš„è¿‡æ‹Ÿåˆåˆ—ã€‚å› ä¸ºdropå¹¶ä¸å½±å“åŸæ•°æ®ï¼Œæ‰€ä»¥ä½¿ç”¨copyã€‚ç›´æ¥è¦†å€¼åº”è¯¥ä¹Ÿå¯ä»¥ã€‚</span>X_sub <span class="token operator">=</span> X_sub<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>overfit<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#.copy()</span><span class="token comment">######################æ¶ˆé™¤æˆªå–åç‰¹å¾çŸ©é˜µçš„è¿‡æ‹Ÿåˆ-ã€ç»“æŸã€‘#######################</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤æç«¯å€¼åŠè¿‡æ‹Ÿåˆåˆ—åï¼Œè®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µçš„ç»´æ•°ä¸ºï¼Œç‰¹å¾ï¼š"</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> <span class="token string">'å¯¹åº”äºç‰¹å¾çš„å¯¹æ•°å˜æ¢åçš„æˆ¿ä»·y'</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> <span class="token string">'æµ‹è¯•æ•°æ®çš„ç‰¹å¾çŸ©é˜µï¼ˆå®ƒåº”è¯¥åœ¨è¡Œã€åˆ—ä¸Šæœªè¢«åˆ å‡ï¼‰X_sub'</span><span class="token punctuation">,</span> X_sub<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment">##############################################################ç‰¹å¾å¤„ç†-ã€ç»“æŸã€‘###################################################################################</span><span class="token comment">##############################################################æœºå™¨å­¦ä¹ -ã€å¼€å§‹ã€‘###################################################################################</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç‰¹å¾å¤„ç†å·²ç»å®Œæˆã€‚å¼€å§‹å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œæœºå™¨å­¦ä¹ '</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è®¾ç½®kæŠ˜äº¤å‰éªŒè¯çš„å‚æ•°ã€‚</span>kfolds <span class="token operator">=</span> KFold<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token comment">#å®šä¹‰å‡æ–¹æ ¹å¯¹æ•°è¯¯å·®ï¼ˆRoot Mean Squared Logarithmic Error ï¼ŒRMSLEï¼‰</span><span class="token keyword">def</span> <span class="token function">rmsle</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>mean_squared_error<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#åˆ›å»ºæ¨¡å‹è¯„åˆ†å‡½æ•°ï¼Œæ ¹æ®ä¸åŒæ¨¡å‹çš„è¡¨ç°æ‰“åˆ†</span><span class="token comment">#cvè¡¨ç¤ºCross-validation,äº¤å‰éªŒè¯çš„æ„æ€ã€‚</span><span class="token keyword">def</span> <span class="token function">cv_rmse</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> X<span class="token operator">=</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>    rmse <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token operator">-</span>cross_val_score<span class="token punctuation">(</span>model<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> scoring<span class="token operator">=</span><span class="token string">"neg_mean_squared_error"</span><span class="token punctuation">,</span> cv<span class="token operator">=</span>kfolds<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>rmse<span class="token punctuation">)</span><span class="token comment">#############ä¸ªä½“æœºå™¨å­¦ä¹ æ¨¡å‹çš„åˆ›å»ºï¼ˆå³æ¨¡å‹å£°æ˜å’Œå‚æ•°è®¾ç½®ï¼‰-ã€å¼€å§‹ã€‘############</span>alphas_alt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">14.5</span><span class="token punctuation">,</span> <span class="token number">14.6</span><span class="token punctuation">,</span> <span class="token number">14.7</span><span class="token punctuation">,</span> <span class="token number">14.8</span><span class="token punctuation">,</span> <span class="token number">14.9</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15.1</span><span class="token punctuation">,</span> <span class="token number">15.2</span><span class="token punctuation">,</span> <span class="token number">15.3</span><span class="token punctuation">,</span> <span class="token number">15.4</span><span class="token punctuation">,</span> <span class="token number">15.5</span><span class="token punctuation">]</span>alphas2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5e-05</span><span class="token punctuation">,</span> <span class="token number">0.0001</span><span class="token punctuation">,</span> <span class="token number">0.0002</span><span class="token punctuation">,</span> <span class="token number">0.0003</span><span class="token punctuation">,</span> <span class="token number">0.0004</span><span class="token punctuation">,</span> <span class="token number">0.0005</span><span class="token punctuation">,</span> <span class="token number">0.0006</span><span class="token punctuation">,</span> <span class="token number">0.0007</span><span class="token punctuation">,</span> <span class="token number">0.0008</span><span class="token punctuation">]</span>e_alphas <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.0001</span><span class="token punctuation">,</span> <span class="token number">0.0002</span><span class="token punctuation">,</span> <span class="token number">0.0003</span><span class="token punctuation">,</span> <span class="token number">0.0004</span><span class="token punctuation">,</span> <span class="token number">0.0005</span><span class="token punctuation">,</span> <span class="token number">0.0006</span><span class="token punctuation">,</span> <span class="token number">0.0007</span><span class="token punctuation">]</span>e_l1ratio <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.95</span><span class="token punctuation">,</span> <span class="token number">0.99</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token comment">#å®šä¹‰ridgeå²­å›å½’æ¨¡å‹ï¼ˆä½¿ç”¨äºŒèŒƒæ•°ä½œä¸ºæ­£åˆ™åŒ–é¡¹ã€‚ä¸è®ºæ˜¯ä½¿ç”¨ä¸€èŒƒæ•°è¿˜æ˜¯äºŒèŒƒæ•°ï¼Œæ­£åˆ™åŒ–é¡¹çš„å¼•å…¥å‡æ˜¯ä¸ºäº†é™ä½è¿‡æ‹Ÿåˆé£é™©ã€‚ï¼‰</span><span class="token comment">#æ³¨ï¼šæ­£åˆ™åŒ–é¡¹å¦‚æœä½¿ç”¨äºŒèŒƒæ•°ï¼Œé‚£ä¹ˆå¯¹äºä»»ä½•éœ€è¦å¯»ä¼˜çš„å‚æ•°å€¼ï¼Œåœ¨å¯»ä¼˜ç»ˆæ­¢æ—¶ï¼Œå®ƒéƒ½æ— æ³•å°†æŸäº›å‚æ•°å€¼å˜ä¸ºä¸¥æ ¼çš„0ï¼Œå°½ç®¡æŸäº›å‚æ•°ä¼°è®¡å€¼å˜å¾—éå¸¸å°ä»¥è‡³äºå¯ä»¥å¿½ç•¥ã€‚å³ä½¿ç”¨äºŒèŒƒæ•°ä¼šä¿ç•™å˜é‡çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä¸ä¼šè¿›è¡Œç±»ä¼¼PCAçš„å˜é‡å‡¸æ˜¾ã€‚</span><span class="token comment">#æ³¨ï¼šæ­£åˆ™åŒ–é¡¹å¦‚æœä½¿ç”¨ä¸€èŒƒæ•°ï¼Œå®ƒæ¯”L2èŒƒæ•°æ›´æ˜“äºè·å¾—â€œç¨€ç–(sparse)â€è§£ï¼Œå³å®ƒçš„æ±‚è§£ç»“æœä¼šæœ‰æ›´å¤šçš„é›¶åˆ†é‡ã€‚</span>ridge <span class="token operator">=</span> make_pipeline<span class="token punctuation">(</span>RobustScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RidgeCV<span class="token punctuation">(</span>alphas<span class="token operator">=</span>alphas_alt<span class="token punctuation">,</span> cv<span class="token operator">=</span>kfolds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å®šä¹‰LASSOæ”¶ç¼©æ¨¡å‹ï¼ˆä½¿ç”¨L1èŒƒæ•°ä½œä¸ºæ­£åˆ™åŒ–é¡¹ï¼‰ï¼ˆç”±äºå¯¹ç›®æ ‡å‡½æ•°çš„æ±‚è§£ç»“æœä¸­å°†å¾—åˆ°å¾ˆå¤šçš„é›¶åˆ†é‡ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºæ”¶ç¼©æ¨¡å‹ã€‚ï¼‰</span><span class="token comment">#æ³¨ï¼šæ­£åˆ™åŒ–é¡¹å¦‚æœä½¿ç”¨äºŒèŒƒæ•°ï¼Œé‚£ä¹ˆå¯¹äºä»»ä½•éœ€è¦å¯»ä¼˜çš„å‚æ•°å€¼ï¼Œåœ¨å¯»ä¼˜ç»ˆæ­¢æ—¶ï¼Œå®ƒéƒ½æ— æ³•å°†æŸäº›å‚æ•°å€¼å˜ä¸ºä¸¥æ ¼çš„0ï¼Œå°½ç®¡æŸäº›å‚æ•°ä¼°è®¡å€¼å˜å¾—éå¸¸å°ä»¥è‡³äºå¯ä»¥å¿½ç•¥ã€‚å³ä½¿ç”¨äºŒèŒƒæ•°ä¼šä¿ç•™å˜é‡çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä¸ä¼šè¿›è¡Œç±»ä¼¼PCAçš„å˜é‡å‡¸æ˜¾ã€‚</span><span class="token comment">#æ³¨ï¼šæ­£åˆ™åŒ–é¡¹å¦‚æœä½¿ç”¨ä¸€èŒƒæ•°ï¼Œå®ƒæ¯”L2èŒƒæ•°æ›´æ˜“äºè·å¾—â€œç¨€ç–(sparse)â€è§£ï¼Œå³å®ƒçš„æ±‚è§£ç»“æœä¼šæœ‰æ›´å¤šçš„é›¶åˆ†é‡ã€‚</span>lasso <span class="token operator">=</span> make_pipeline<span class="token punctuation">(</span>RobustScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> LassoCV<span class="token punctuation">(</span>max_iter<span class="token operator">=</span><span class="token number">1e7</span><span class="token punctuation">,</span> alphas<span class="token operator">=</span>alphas2<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span> cv<span class="token operator">=</span>kfolds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å®šä¹‰elastic netå¼¹æ€§ç½‘ç»œæ¨¡å‹ï¼ˆå¼¹æ€§ç½‘ç»œå®é™…ä¸Šæ˜¯ç»“åˆäº†å²­å›å½’å’Œlassoçš„ç‰¹ç‚¹ï¼ŒåŒæ—¶ä½¿ç”¨äº†L1å’ŒL2ä½œä¸ºæ­£åˆ™åŒ–é¡¹ã€‚ï¼‰</span>elasticnet <span class="token operator">=</span> make_pipeline<span class="token punctuation">(</span>RobustScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ElasticNetCV<span class="token punctuation">(</span>max_iter<span class="token operator">=</span><span class="token number">1e7</span><span class="token punctuation">,</span> alphas<span class="token operator">=</span>e_alphas<span class="token punctuation">,</span> cv<span class="token operator">=</span>kfolds<span class="token punctuation">,</span> l1_ratio<span class="token operator">=</span>e_l1ratio<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å®šä¹‰SVMæ”¯æŒå‘é‡æœºæ¨¡å‹                                     </span>svr <span class="token operator">=</span> make_pipeline<span class="token punctuation">(</span>RobustScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SVR<span class="token punctuation">(</span>C<span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> epsilon<span class="token operator">=</span> <span class="token number">0.008</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.0003</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å®šä¹‰GBæ¢¯åº¦æå‡æ¨¡å‹ï¼ˆå±•å¼€åˆ°ä¸€é˜¶å¯¼æ•°ï¼‰</span>gbr <span class="token operator">=</span> GradientBoostingRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">3000</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> max_depth<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> max_features<span class="token operator">=</span><span class="token string">'sqrt'</span><span class="token punctuation">,</span> min_samples_leaf<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> min_samples_split<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> loss<span class="token operator">=</span><span class="token string">'huber'</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>                             <span class="token comment">#å®šä¹‰lightgbmæ¨¡å‹</span>lightgbm <span class="token operator">=</span> LGBMRegressor<span class="token punctuation">(</span>objective<span class="token operator">=</span><span class="token string">'regression'</span><span class="token punctuation">,</span>                                        num_leaves<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>                                       learning_rate<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>                                        n_estimators<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">,</span>                                       max_bin<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>                                        bagging_fraction<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">,</span>                                       bagging_freq<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>                                        bagging_seed<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>                                       feature_fraction<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>                                       feature_fraction_seed<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>                                       verbose<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                                       <span class="token comment">#min_data_in_leaf=2,</span>                                       <span class="token comment">#min_sum_hessian_in_leaf=11</span>                                       <span class="token punctuation">)</span><span class="token comment">#å®šä¹‰xgboostæ¨¡å‹ï¼ˆå±•å¼€åˆ°äºŒé˜¶å¯¼æ•°ï¼‰                                      </span>xgboost <span class="token operator">=</span> XGBRegressor<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> n_estimators<span class="token operator">=</span><span class="token number">3460</span><span class="token punctuation">,</span>                                     max_depth<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> min_child_weight<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                                     gamma<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> subsample<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>                                     colsample_bytree<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>                                     objective<span class="token operator">=</span><span class="token string">'reg:linear'</span><span class="token punctuation">,</span> nthread<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                                     scale_pos_weight<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> seed<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span>                                     reg_alpha<span class="token operator">=</span><span class="token number">0.00006</span><span class="token punctuation">)</span><span class="token comment">#############ä¸ªä½“æœºå™¨å­¦ä¹ æ¨¡å‹çš„åˆ›å»ºï¼ˆå³æ¨¡å‹å£°æ˜å’Œå‚æ•°è®¾ç½®ï¼‰-ã€ç»“æŸã€‘############</span><span class="token comment">###########################é›†æˆå¤šä¸ªä¸ªä½“å­¦ä¹ å™¨-ã€å¼€å§‹ã€‘##########################</span><span class="token comment">###ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><span class="token comment">###ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><span class="token comment">###ï¼ï¼ï¼regressors=(...)ä¸­å¹¶æ²¡æœ‰çº³å…¥å‰é¢çš„svræ¨¡å‹,æ€ä¹ˆå›äº‹ï¼Ÿ</span><span class="token comment">###ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><span class="token comment">###ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span>stack_gen <span class="token operator">=</span> StackingCVRegressor<span class="token punctuation">(</span>regressors<span class="token operator">=</span><span class="token punctuation">(</span>ridge<span class="token punctuation">,</span> lasso<span class="token punctuation">,</span> elasticnet<span class="token punctuation">,</span> gbr<span class="token punctuation">,</span> xgboost<span class="token punctuation">,</span> lightgbm<span class="token punctuation">)</span><span class="token punctuation">,</span>                                meta_regressor<span class="token operator">=</span>xgboost<span class="token punctuation">,</span>                                use_features_in_secondary<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">#regressors=(...)ä¸­å¹¶æ²¡æœ‰çº³å…¥å‰é¢çš„svræ¨¡å‹</span><span class="token comment">###########################é›†æˆå¤šä¸ªä¸ªä½“å­¦ä¹ å™¨-ã€ç»“æŸã€‘##########################                             </span><span class="token comment">############################è¿›è¡Œäº¤å‰éªŒè¯æ‰“åˆ†-ã€å¼€å§‹ã€‘###########################</span><span class="token comment">#è¿›è¡Œäº¤å‰éªŒè¯ï¼Œå¹¶å¯¹ä¸åŒæ¨¡å‹çš„è¡¨ç°æ‰“åˆ†</span><span class="token comment">#ï¼ˆç”±äºæ˜¯äº¤å‰éªŒè¯ï¼Œå°†ä½¿ç”¨ä¸åŒçš„æ•°æ®é›†å¯¹åŒä¸€æ¨¡å‹è¿›è¡Œè¯„åˆ†ï¼Œæ•…æ¯ä¸ªæ¨¡å‹å¯¹åº”ä¸€ä¸ªå¾—åˆ†åºåˆ—ã€‚å±•ç¤ºæ¨¡å‹å¾—åˆ†åºåˆ—çš„å¹³å‡åˆ†ã€æ ‡å‡†å·®ï¼‰</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'è¿›è¡Œäº¤å‰éªŒè¯ï¼Œè®¡ç®—ä¸åŒæ¨¡å‹çš„å¾—åˆ†TEST score on CV'</span><span class="token punctuation">)</span><span class="token comment">#æ‰“å°äºŒèŒƒæ•°ridegå²­å›å½’æ¨¡å‹çš„å¾—åˆ†</span>score <span class="token operator">=</span> cv_rmse<span class="token punctuation">(</span>ridge<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"äºŒèŒƒæ•°ridegå²­å›å½’æ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> score<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token comment">#æ‰“å°ä¸€èŒƒæ•°LASSOæ”¶ç¼©æ¨¡å‹çš„å¾—åˆ†</span>score <span class="token operator">=</span> cv_rmse<span class="token punctuation">(</span>lasso<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ä¸€èŒƒæ•°LASSOæ”¶ç¼©æ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> score<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token comment">#æ‰“å°elastic netå¼¹æ€§ç½‘ç»œæ¨¡å‹çš„å¾—åˆ†</span>score <span class="token operator">=</span> cv_rmse<span class="token punctuation">(</span>elasticnet<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"elastic netå¼¹æ€§ç½‘ç»œæ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> score<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token comment">#æ‰“å°SVRæ”¯æŒå‘é‡æœºæ¨¡å‹çš„å¾—åˆ†</span>score <span class="token operator">=</span> cv_rmse<span class="token punctuation">(</span>svr<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"SVRæ”¯æŒå‘é‡æœºæ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> score<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token comment">#æ‰“å°lightgbmè½»æ¢¯åº¦æå‡æ¨¡å‹çš„å¾—åˆ†</span>score <span class="token operator">=</span> cv_rmse<span class="token punctuation">(</span>lightgbm<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"lightgbmè½»æ¢¯åº¦æå‡æ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> score<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token comment">#æ‰“å°gbræ¢¯åº¦æå‡å›å½’æ¨¡å‹çš„å¾—åˆ†</span>score <span class="token operator">=</span> cv_rmse<span class="token punctuation">(</span>gbr<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"gbræ¢¯åº¦æå‡å›å½’æ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> score<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token comment">#æ‰“å°xgboostæ¨¡å‹çš„å¾—åˆ†</span>score <span class="token operator">=</span> cv_rmse<span class="token punctuation">(</span>xgboost<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"xgboostæ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> score<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token comment">############################è¿›è¡Œäº¤å‰éªŒè¯æ‰“åˆ†-ã€ç»“æŸã€‘###########################</span><span class="token comment">#########ä½¿ç”¨è®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µä½œä¸ºè¾“å…¥ï¼Œè®­ç»ƒæ•°æ®å¯¹æ•°å¤„ç†åçš„é¢„æµ‹æˆ¿ä»·ä½œä¸ºè¾“å‡ºï¼Œè¿›è¡Œå„ä¸ªæ¨¡å‹çš„è®­ç»ƒ-ã€å¼€å§‹ã€‘#########</span><span class="token comment">#å¼€å§‹é›†åˆæ‰€æœ‰æ¨¡å‹ï¼Œä½¿ç”¨stackingæ–¹æ³•</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'è¿›è¡Œæ¨¡å‹å‚æ•°è®­ç»ƒ START Fit'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'å¯¹stack_gené›†æˆå™¨æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ'</span><span class="token punctuation">)</span>stack_gen_model <span class="token operator">=</span> stack_gen<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'å¯¹elasticnetå¼¹æ€§ç½‘ç»œæ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ'</span><span class="token punctuation">)</span>elastic_model_full_data <span class="token operator">=</span> elasticnet<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'å¯¹ä¸€èŒƒæ•°lassoæ”¶ç¼©æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ'</span><span class="token punctuation">)</span>lasso_model_full_data <span class="token operator">=</span> lasso<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'å¯¹äºŒèŒƒæ•°ridgeå²­å›å½’æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ'</span><span class="token punctuation">)</span>ridge_model_full_data <span class="token operator">=</span> ridge<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'å¯¹svræ”¯æŒå‘é‡æœºæ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ'</span><span class="token punctuation">)</span>svr_model_full_data <span class="token operator">=</span> svr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'å¯¹GradientBoostingæ¢¯åº¦æå‡æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ'</span><span class="token punctuation">)</span>gbr_model_full_data <span class="token operator">=</span> gbr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'å¯¹xgboostäºŒé˜¶æ¢¯åº¦æå‡æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ'</span><span class="token punctuation">)</span>xgb_model_full_data <span class="token operator">=</span> xgboost<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'å¯¹lightgbmè½»æ¢¯åº¦æå‡æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ'</span><span class="token punctuation">)</span>lgb_model_full_data <span class="token operator">=</span> lightgbm<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token comment">#########ä½¿ç”¨è®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µä½œä¸ºè¾“å…¥ï¼Œè®­ç»ƒæ•°æ®å¯¹æ•°å¤„ç†åçš„é¢„æµ‹æˆ¿ä»·ä½œä¸ºè¾“å‡ºï¼Œè¿›è¡Œå„ä¸ªæ¨¡å‹çš„è®­ç»ƒ-ã€ç»“æŸã€‘#########</span><span class="token comment">############################è¿›è¡Œäº¤å‰éªŒè¯æ‰“åˆ†-ã€ç»“æŸã€‘###########################</span><span class="token comment">########å®šä¹‰ä¸ªä½“å­¦ä¹ å™¨çš„é¢„æµ‹å€¼èåˆå‡½æ•°ï¼Œæ£€æµ‹é¢„æµ‹å€¼èåˆç­–ç•¥çš„æ•ˆæœ-ã€å¼€å§‹ã€‘#######</span><span class="token comment">#ç»¼åˆå¤šä¸ªæ¨¡å‹äº§ç”Ÿçš„é¢„æµ‹å€¼ï¼Œä½œä¸ºå¤šæ¨¡å‹ç»„åˆå­¦ä¹ å™¨çš„é¢„æµ‹å€¼</span><span class="token keyword">def</span> <span class="token function">blend_models_predict</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">*</span> elastic_model_full_data<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \            <span class="token punctuation">(</span><span class="token number">0.05</span> <span class="token operator">*</span> lasso_model_full_data<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \            <span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">*</span> ridge_model_full_data<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \            <span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">*</span> svr_model_full_data<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \            <span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">*</span> gbr_model_full_data<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \            <span class="token punctuation">(</span><span class="token number">0.15</span> <span class="token operator">*</span> xgb_model_full_data<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \            <span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">*</span> lgb_model_full_data<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \            <span class="token punctuation">(</span><span class="token number">0.3</span> <span class="token operator">*</span> stack_gen_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#æ‰“å°åœ¨ä¸Šè¿°æ¨¡å‹é…æ¯”ä¸‹ï¼Œå¤šæ¨¡å‹ç»„åˆå­¦ä¹ å™¨çš„å‡æ–¹æ ¹å¯¹æ•°è¯¯å·®ï¼ˆRoot Mean Squared Logarithmic Error ï¼ŒRMSLEï¼‰</span><span class="token comment">#ä½¿ç”¨è®­ç»ƒæ•°æ®å¯¹åˆ›é€ çš„æ¨¡å‹è¿›è¡ŒkæŠ˜äº¤å‰éªŒè¯ï¼Œä»¥è®­ç»ƒåˆ›é€ å‡ºçš„æ¨¡å‹çš„å‚æ•°é…ç½®ã€‚äº¤å‰éªŒè¯è®­ç»ƒè¿‡ç¨‹ç»“æŸåï¼Œå°†å¾—åˆ°æ¨¡å‹çš„å‚æ•°é…ç½®ã€‚ä½¿ç”¨å¾—å‡ºçš„å‚æ•°é…ç½®ä¸‹ï¼Œåœ¨å…¨ä½“è®­ç»ƒæ•°æ®ä¸Šè¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯æ¨¡å‹å¯¹å…¨ä½“è®­ç»ƒæ•°æ®é‡æ„çš„è¯¯å·®ã€‚</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'èåˆåçš„è®­ç»ƒæ¨¡å‹å¯¹åŸæ•°æ®é‡æ„æ—¶çš„å‡æ–¹æ ¹å¯¹æ•°è¯¯å·®RMSLE score on train data:'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>rmsle<span class="token punctuation">(</span>y<span class="token punctuation">,</span> blend_models_predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">########å®šä¹‰ä¸ªä½“å­¦ä¹ å™¨çš„é¢„æµ‹å€¼èåˆå‡½æ•°ï¼Œæ£€æµ‹é¢„æµ‹å€¼èåˆç­–ç•¥çš„æ•ˆæœ-ã€ç»“æŸã€‘#######</span><span class="token comment">########å°†æµ‹è¯•é›†çš„ç‰¹å¾çŸ©é˜µä½œä¸ºè¾“å…¥ï¼Œä¼ å…¥è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¾—å‡ºçš„è¾“å‡ºå†™å…¥.csvæ–‡ä»¶çš„ç¬¬2åˆ—-ã€å¼€å§‹ã€‘########</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ä½¿ç”¨æµ‹è¯•é›†ç‰¹å¾è¿›è¡Œæˆ¿ä»·é¢„æµ‹ Predict submission'</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>submission <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../input/house-prices-advanced-regression-techniques/sample_submission.csv"</span><span class="token punctuation">)</span><span class="token comment">#å‡½æ•°æ³¨é‡Šï¼š.iloc[:,1]æ˜¯åŸºäºç´¢å¼•ä½æ¥é€‰å–æ•°æ®é›†ï¼Œ[ç´¢å¼•1:ç´¢å¼•2]ï¼Œå·¦é—­å³å¼€ã€‚</span>submission<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>expm1<span class="token punctuation">(</span>blend_models_predict<span class="token punctuation">(</span>X_sub<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">########å°†æµ‹è¯•é›†çš„ç‰¹å¾çŸ©é˜µä½œä¸ºè¾“å…¥ï¼Œä¼ å…¥è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¾—å‡ºçš„è¾“å‡ºå†™å…¥.csvæ–‡ä»¶çš„ç¬¬2åˆ—-ã€ç»“æŸã€‘########</span><span class="token comment">#---------------------------------------------------------------------------------------------------------------------------#</span><span class="token comment">#---------------------------------------------------------------------------------------------------------------------------#</span><span class="token comment">#---------------------------------------------------------------------------------------------------------------------------#</span><span class="token comment"># å½“å¯¹å¹³å°æœªå…¬å¼€çš„æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹æ—¶ï¼Œå‰è¿°æ¨¡å‹çš„è¯¯å·®æ˜¯0.114 this kernel gave a score 0.114</span><span class="token comment"># ä¸ºäº†æé«˜æ¨¡å‹çš„å¾—åˆ†ï¼Œå¼•å…¥å…¶ä»–æ¨¡å‹çš„ä¼˜ç§€é¢„æµ‹ç»“æœï¼Œä¸å‰è¿°æ¨¡å‹çš„é¢„æµ‹ç»“æœè¿›è¡Œæ··åˆï¼ˆæœ‰ç‚¹ç±»ä¼¼æŠ„åˆ«äººçš„ç­”æ¡ˆï¼Œä½†å®è´¨æ˜¯æ‰©å¤§é›†æˆæ¨¡å‹çš„è§„æ¨¡ï¼Œå¼•å…¥æ›´å¤šçš„æ¨¡å‹ï¼‰ let's up it by mixing with the top kernels</span><span class="token comment">######################æ¨¡å‹è¾“å‡ºç»“æœèåˆ-ã€å¼€å§‹ã€‘#############################</span><span class="token comment">#åœ¨å¤šæ¨¡å‹é›†æˆå­¦ä¹ å™¨é¢„æµ‹ç»“æœçš„åŸºç¡€ä¸Šï¼Œèåˆå…¶ä»–ä¼˜ç§€æ¨¡å‹ï¼ˆå³å¹³å°ä¸Šå…¶ä»–å‡æ–¹æ ¹å¯¹æ•°è¯¯å·®å°çš„æ¨¡å‹ï¼‰çš„é¢„æµ‹ç»“æœã€‚</span><span class="token comment">#è¿™æ­¥æ“ä½œæ˜¯ä¸ºäº†é™ä½å¤šæ¨¡å‹é›†æˆå­¦ä¹ å™¨çš„æ–¹å·®ã€‚</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'èåˆå…¶ä»–ä¼˜ç§€æ¨¡å‹çš„é¢„æµ‹ç»“æœ Blend with Top Kernals submissions'</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>sub_1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/top-10-0-10943-stacking-mice-and-brutal-force/House_Prices_submit.csv'</span><span class="token punctuation">)</span>sub_2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/hybrid-svm-benchmark-approach-0-11180-lb-top-2/hybrid_solution.csv'</span><span class="token punctuation">)</span>sub_3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../input/lasso-model-for-regression-problem/lasso_sol22_Median.csv'</span><span class="token punctuation">)</span>submission<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>floor<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.25</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>expm1<span class="token punctuation">(</span>blend_models_predict<span class="token punctuation">(</span>X_sub<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>                                 <span class="token punctuation">(</span><span class="token number">0.25</span> <span class="token operator">*</span> sub_1<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span>                                 <span class="token punctuation">(</span><span class="token number">0.25</span> <span class="token operator">*</span> sub_2<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span>                                 <span class="token punctuation">(</span><span class="token number">0.25</span> <span class="token operator">*</span> sub_3<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">######################æ¨¡å‹è¾“å‡ºç»“æœèåˆ-ã€ç»“æŸã€‘#############################      </span><span class="token comment">####################èåˆç»“æœçš„æç«¯å€¼å‰”é™¤-ã€å¼€å§‹ã€‘###########################  </span><span class="token comment">#å¤„ç†èåˆåç»“æœä¸­çš„æç«¯å€¼ã€‚æŠŠå¤ªå¤§çš„æ•°å€¼ï¼ˆé™åºæ’åˆ—æ—¶ï¼Œä½äºé¡¶éƒ¨å¾€ä¸‹0.005çš„æ•°å€¼ï¼Œå°±æ˜¯åªæœ‰0.005çš„æ•°æ¯”å®ƒå¤§ï¼‰ç¼©å°ä¸€ç‚¹ï¼ˆä¹˜ä»¥0.77ï¼‰ï¼ŒæŠŠå¤ªå°çš„æ•°å€¼ï¼ˆé™åºæ’åˆ—æ—¶ï¼Œä½äºé¡¶éƒ¨å¾€ä¸‹0.99çš„æ•°å€¼ï¼‰æ”¾å¤§ä¸€ç‚¹ï¼ˆä¹˜ä»¥1.1ï¼‰</span>q1 <span class="token operator">=</span> submission<span class="token punctuation">[</span><span class="token string">'SalePrice'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">0.005</span><span class="token punctuation">)</span>q2 <span class="token operator">=</span> submission<span class="token punctuation">[</span><span class="token string">'SalePrice'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">0.995</span><span class="token punctuation">)</span>submission<span class="token punctuation">[</span><span class="token string">'SalePrice'</span><span class="token punctuation">]</span> <span class="token operator">=</span> submission<span class="token punctuation">[</span><span class="token string">'SalePrice'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token keyword">if</span> x <span class="token operator">&gt;</span> q1 <span class="token keyword">else</span> x<span class="token operator">*</span><span class="token number">0.77</span><span class="token punctuation">)</span>submission<span class="token punctuation">[</span><span class="token string">'SalePrice'</span><span class="token punctuation">]</span> <span class="token operator">=</span> submission<span class="token punctuation">[</span><span class="token string">'SalePrice'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token keyword">if</span> x <span class="token operator">&lt;</span> q2 <span class="token keyword">else</span> x<span class="token operator">*</span><span class="token number">1.1</span><span class="token punctuation">)</span><span class="token comment">####################èåˆç»“æœçš„æç«¯å€¼å‰”é™¤-ã€ç»“æŸã€‘###########################</span><span class="token comment">#ä»¥csvæ–‡ä»¶çš„å½¢å¼è¾“å‡ºé¢„æµ‹å€¼</span>submission<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">"House_price_submission.csv"</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'èåˆç»“æœ.csvæ–‡ä»¶è¾“å‡ºæˆåŠŸ Save submission'</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ML-DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kaggle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PE-DreamMemory</title>
      <link href="/2022/02/16/pe-dreammemory/"/>
      <url>/2022/02/16/pe-dreammemory/</url>
      
        <content type="html"><![CDATA[<h4 id="å†…ç¯‡-amp-amp-é€é¥æ¸¸"><a href="#å†…ç¯‡-amp-amp-é€é¥æ¸¸" class="headerlink" title="å†…ç¯‡&amp;&amp;é€é¥æ¸¸"></a>å†…ç¯‡&amp;&amp;é€é¥æ¸¸</h4><p>è®°å¾—ä¸€ä¸ªç¦»å¥‡çš„æ¢¦ï¼Œå¾ˆæœ‰æ„æ€çš„ï¼Œæ˜¯ä¸€ä¸ªå°ç²¾çµæ¸¸è¡å››æ–¹åœ¨å“ªé‡Œï¼Œä¼¼ä¹â€¦å¥½åƒæ˜¯åœ¨ä¸€å®¶åº—ï¼Œä¸çŸ¥åçš„ä¸€å®¶åº—ï¼Œå¹²äº†ä¸€äº›å¥‡å¦™çš„äº‹ï¼Œä¹ æƒ¯ç«™åœ¨æˆ‘çš„å³è‚©ä¸Šï¼Œæœ‰æ—¶å€™æ˜¯è¢–å­é‡Œï¼Œå¥¹çˆ¶äº²å¾ˆé­æ¢§ï¼Œä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·å‘¢&lt;æˆ‘çš„æ½œæ„è¯†é‡Œæ˜¯è¿™æ ·è®¤è¯†çš„å—&gt;ï¼Œç¦»å¼€æ—¶ç’ç€çˆ¶äº²ï¼Œæœ¬åº”è¯¥è¦å›å®¶çš„ï¼Œå´è¦å·å·æ‘¸æ‘¸çš„åˆé’»è¿›äº†æˆ‘çš„è¢–å­ï¼Œè¿™æ ·çš„ä¸€ä¸ªå¯çˆ±åˆè°ƒçš®çš„å°å®¶ä¼™ï¼Œè·¯é€”é¥è¿œæ¯ç‡¥å¤ªæ¼«é•¿ï¼Œåº”è¯¥ä¼šæœ‰ä¹è¶£</p>]]></content>
      
      
      <categories>
          
          <category> Personal </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è’è¯çš„æ•…äº‹ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
