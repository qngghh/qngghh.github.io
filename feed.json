{
    "version": "https://jsonfeed.org/version/1",
    "title": "Supernova",
    "description": "å°æ´¾è¿‡æ°”ç”»å®¶",
    "home_page_url": "https://www.kitx86.com",
    "items": [
        {
            "id": "https://www.kitx86.com/2022/05/09/ml-dl-kaggle-zheng-que-yong-fa/",
            "url": "https://www.kitx86.com/2022/05/09/ml-dl-kaggle-zheng-que-yong-fa/",
            "title": "ML-Dl-kaggleæ­£ç¡®ç”¨æ³•",
            "date_published": "2022-05-09T08:19:32.000Z",
            "content_html": "<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>æƒ³å†™çš„æ—¶å€™å°±æ¥ï¼Œä¸æƒ³ push è‡ªå·±ï¼Œæ²¡æœ‰æ–°æ„</p>\n",
            "tags": [
                "Noince",
                "advance"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/05/07/pe-update-2/",
            "url": "https://www.kitx86.com/2022/05/07/pe-update-2/",
            "title": "PE-update-2",
            "date_published": "2022-05-07T08:35:00.000Z",
            "content_html": "<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>ä»Šå¤©çš„æ„Ÿjoæ˜¯æ²¡å¾—ä»€ä¹ˆèƒ½å¤Ÿæ‹¦ä½æˆ‘ï¼Œæ€ç»ªé£˜åœ¨äº†å›ºå®šçš„æ–¹å‘ï¼Œæœ‰å¤ªå¤šå¤ªå¤šæƒ³å»åšçš„å•¦ã€‚</p>\n<p>æƒ³å»ºç«‹ä¸€ä¸ªå·¥ä½œå®¤ç»™å¤§å®¶å¸¦æ¥å¿«ä¹ï¼Œæƒ³å»åˆ›ä¸šå»ºç«‹æˆ‘çš„æ—¶ä»£ï¼Œæƒ³å»å’Œé‚£äº›äº’è”ç½‘å¤´ç›®ç¢°æ’ï¼Œæƒ³å®‰å¿ƒåœ¨å­¦æœ¯æ°›å›´æµ“åšçš„åœ°æ–¹åšç ”ç©¶</p>\n",
            "tags": [
                "æ—¥è®°"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/05/04/pe-niao-lei-si-yang-ji/",
            "url": "https://www.kitx86.com/2022/05/04/pe-niao-lei-si-yang-ji/",
            "title": "PE-é¸Ÿç±»é¥²å…»è®°",
            "date_published": "2022-05-04T08:38:21.000Z",
            "content_html": "<h3 id=\"è‡´å›é€†çš„-Big-Birdï¼š\"><a href=\"#è‡´å›é€†çš„-Big-Birdï¼š\" class=\"headerlink\" title=\"è‡´å›é€†çš„ Big Birdï¼š\"></a>è‡´å›é€†çš„ Big Birdï¼š</h3><p>çœ‹èµ·æ¥ä¼¼ä¹å¥½æ´»æ³¼å¥½åŠ¨ï¼Œå´æ¯«ä¸ä¸ºæˆ‘æ‰€æä¾›çš„å…­æ˜Ÿçº§è±ªååˆ«å¢…æ‰€åŠ¨ï¼Œæ»¡çœ¼éƒ½å´‡å°šå¤–é¢çš„ç‚¹æ»´ä¸€æ–¹ä¸–ç•Œï¼Œç•™ä¸ä½çš„ä¹Ÿä¼šè«åçš„æµéœ²å‡ºä¸€ä¸ä¸ä¸å¿å¿ƒã€‚</p>\n<p>è‡ªç§çš„çƒ­åˆ‡å…³å¿ƒå¹¶ä¸ä¼šæ”¹å˜ä»€ä¹ˆï¼Œæˆ‘å¹¶ä¸å¤±è½ï¼Œå› ä¸ºè¿™ç»“æœæˆ‘å¯ä»¥é¢„è§ï¼Œå¦ä¸€ç§ç»“æœæ˜¯æ¯«ä¸ç•™æƒ…ç›´æ¥ç‚–äº†ï¼Œä¾èµ–è¾¾å°”æ–‡æ‰€è¯´çš„ç”Ÿç‰©è¿›åŒ–çš„åŸºç¡€æ˜¯è‡ªç„¶é€‰æ‹©ï¼Œè¿™å¹¶ä¸æ®‹å¿</p>\n<p>ä½†ä¸ºä»€ä¹ˆäº§ç”Ÿäº†ä¸€ç‚¹ç‚¹ç©ºè™šå‘¢ï¼Œè§£æä¸å‡ºæ¥ã€‚</p>\n<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>\n<p>ä»ä¸€åªé¸Ÿçš„è§‚å¯Ÿè”ç³»åˆ°äººé™…äº¤æµï¼Œå…³å¿ƒä¼šå¯¹ä¸€ä¸ªäººä»˜å‡ºè‡ªå·±è„†è½çš„ç‰ç’ƒå¿ƒï¼Œå³ä½¿æ˜¯å­¤èµ–è°ƒçš®çš„äººä¹Ÿä¸ä¾‹å¤–ã€‚</p>\n<p><img src=\"/IMG_20220504_155927.jpg\"></p>\n",
            "tags": [
                "é¥²å…»è®°"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/05/02/pe-zhen-zhi-zhi-yi/",
            "url": "https://www.kitx86.com/2022/05/02/pe-zhen-zhi-zhi-yi/",
            "title": "PE-æœ•ä¹‹æ—¨æ„",
            "date_published": "2022-05-02T07:37:26.000Z",
            "content_html": "<h3 id=\"å†…ç¯‡-amp-amp-é€é¥æ¸¸\"><a href=\"#å†…ç¯‡-amp-amp-é€é¥æ¸¸\" class=\"headerlink\" title=\"å†…ç¯‡&amp;&amp;é€é¥æ¸¸\"></a>å†…ç¯‡&amp;&amp;é€é¥æ¸¸</h3><p>ä»¥åå°è¯•å»å†™å‡ æœ¬ä¹¦</p>\n<p>ä¸€æœ¬è®²æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„ï¼Œä¸€å®šä¸è¦å†™çš„å¤ªåšï¼Œå› ä¸ºå¯¹äºåƒæˆ‘è¿™æ ·æ…¢æ€§ç²¾è¯»çš„äººæ¥è¯´å°±éå¸¸æŠ˜ç£¨ï¼Œè¿˜æ²¡åˆ°è·Ÿè‡ªå·±è¿‡ä¸å»çš„æ—¶å€™ã€‚</p>\n<p>ä¸€æœ¬è®²æˆ‘å¯¹é‡å­è®¡ç®—ä¸ä¿¡æ¯çš„æ¢ç´¢ï¼Œè¿™æ˜¯ä¸ªå¤§è¯¾é¢˜ï¼Œå¾—å¾ˆä¹…å•¦ã€‚</p>\n<p>æœ€åä¸€æœ¬æ˜¯æˆ‘çš„æ‰‹ç»˜æœ¬ï¼Œæƒ³äº†ä¸€ä¸ªæ¯”è¾ƒä¸­äºŒçš„åå­—ï¼Œ[ç ”ç©¶è€…çš„æ‰‹ç»˜æœ¬ï¼šå¼‚æ„è®¤è¯†ä¸–ç•Œ]</p>\n<p>æœ€åçš„ä¸€ç‚¹ç‚¹æ˜¯ï¼Œå³ä½¿æœ‰æƒ³æ”¾å¼ƒå½“åˆçš„éƒ¨åˆ†çƒ­è¡·ï¼Œè¦ç‡ƒèµ·å¯¹è‡ªå·±çš„çƒ­çˆ±ï¼Œå› ä¸ºè¿˜æœ‰å¯èƒ½ï¼Œæˆ‘å¯ç»™ä»¥æ— èŠçš„ä¸–ç•Œå¸¦æ¥ä¹è¶£ã€‚</p>\n",
            "tags": [
                "å¾®ä¸è¶³é“çš„è´¡çŒ®"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/05/02/pe-update-0/",
            "url": "https://www.kitx86.com/2022/05/02/pe-update-0/",
            "title": "PE-update-0",
            "date_published": "2022-05-01T16:34:01.000Z",
            "content_html": "<h3 id=\"å†…ç¯‡-amp-amp-äººé—´ä¸–\"><a href=\"#å†…ç¯‡-amp-amp-äººé—´ä¸–\" class=\"headerlink\" title=\"å†…ç¯‡&amp;&amp;äººé—´ä¸–\"></a>å†…ç¯‡&amp;&amp;äººé—´ä¸–</h3><p>æ¯å¤©æ—©ä¸Šè¿·è¿·ç³Šç³Šçš„èµ·åºŠæ’é˜ŸæŠ¢æ˜¾å¡æ˜¾å¾—æˆ‘å¾ˆçª˜è¿«ã€å¤šä½™ï¼Œç°åœ¨æ˜¯æ—©ä¸Š 0.36ï¼Œä¸Šçº¿æ’é˜Ÿç­‰ TPUä¸­â€¦â€¦</p>\n",
            "tags": [
                "æ—¥è®°"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/04/26/pe-update-1/",
            "url": "https://www.kitx86.com/2022/04/26/pe-update-1/",
            "title": "PE-update-1",
            "date_published": "2022-04-26T06:39:01.000Z",
            "content_html": "<h3 id=\"å¾€æ—¥ç»­è°ˆ\"><a href=\"#å¾€æ—¥ç»­è°ˆ\" class=\"headerlink\" title=\"å¾€æ—¥ç»­è°ˆ\"></a>å¾€æ—¥ç»­è°ˆ</h3><p>å¹´è½»çš„æ—¶å€™å½“ç„¶ä¼šè§‰å¾—åš hacker æ˜¯æœ€å¸…çš„ï¼Œä¼šå†™ä»£ç è´Ÿè·æ”»å‡»ï¼Œæ¸¸è¡åœ¨å¤–é¢å±é™©è€Œåˆè¿·äººçš„ç¥ç§˜èƒŒå½±æ€èƒ½ä¸è®©äººå¿ƒåŠ¨ã€‚</p>\n",
            "tags": [
                "æ—¥è®°"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/04/15/ml-dl-kfold-yan-zheng/",
            "url": "https://www.kitx86.com/2022/04/15/ml-dl-kfold-yan-zheng/",
            "title": "ML-DL-kFoldéªŒè¯",
            "date_published": "2022-04-14T19:17:12.000Z",
            "content_html": "<h3 id=\"è®­ç»ƒæ–¹æ³•\"><a href=\"#è®­ç»ƒæ–¹æ³•\" class=\"headerlink\" title=\"è®­ç»ƒæ–¹æ³•\"></a>è®­ç»ƒæ–¹æ³•</h3><p>k-foldéªŒè¯æ˜¯åœ¨è®­ç»ƒæ¨¡å‹çš„æ—¶å€™æ™®éä½¿ç”¨çš„ç­–ç•¥ï¼Œåœ¨è®­ç»ƒé›†ä¸Šéšæœºåˆ’åˆ†æ•°ä¸ªæ¨¡å—ï¼Œä¸€èˆ¬åˆ†ä¸º5æŠ˜ï¼Œå…¶ä¸­ä¸€æŠ˜æ˜¯éªŒè¯é›†ï¼Œå¦å¤–å››æŠ˜æ˜¯è®­ç»ƒé›†ï¼Œå¾ªç¯è¿­ä»£5æ¬¡ï¼Œæœ€åå¯¹åšæ¨¡å‹é›†æˆåŠ æƒå¹³å‡ï¼Œç‰¹å¾å·¥ç¨‹é‡Œå¯¹äºåˆ’åˆ†ä¹Ÿæœ‰å¾ˆç»†è‡´çš„åˆ’åˆ†ï¼Œä½†è¿™é‡Œå°±ä¸è¯¦ç»†è¿°è¯´äº†ï¼Œæœ‰åŸºç¡€çš„è¯»è€…åº”è¯¥çŸ¥é“ã€‚</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">create_folds</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> num_splits<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># we create a new column called kfold and fill it with -1</span>\n    data<span class=\"token punctuation\">[</span><span class=\"token string\">\"fold\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n    \n    <span class=\"token comment\"># the next step is to randomize the rows of the data</span>\n    <span class=\"token comment\"># data = data.sample(frac=1).reset_index(drop=True)</span>\n\n    <span class=\"token comment\"># calculate number of bins by Sturge's rule</span>\n    <span class=\"token comment\"># I take the floor of the value, you can also</span>\n    <span class=\"token comment\"># just round it</span>\n    <span class=\"token comment\"># num_bins = int(np.floor(1 + np.log2(len(data))))</span>\n    \n    <span class=\"token comment\"># bin targets</span>\n    data<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bins\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>cut<span class=\"token punctuation\">(</span>\n        data<span class=\"token punctuation\">[</span><span class=\"token string\">\"score\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> bins<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> labels<span class=\"token operator\">=</span><span class=\"token boolean\">False</span>\n    <span class=\"token punctuation\">)</span>\n    \n    <span class=\"token comment\"># initiate the kfold class from model_selection module</span>\n    kf <span class=\"token operator\">=</span> StratifiedKFold<span class=\"token punctuation\">(</span>n_splits<span class=\"token operator\">=</span>num_splits<span class=\"token punctuation\">,</span> shuffle<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token comment\"># fill the new kfold column</span>\n    <span class=\"token comment\"># note that, instead of targets, we use bins!</span>\n    <span class=\"token keyword\">for</span> f<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>t_<span class=\"token punctuation\">,</span> v_<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>kf<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>X<span class=\"token operator\">=</span>data<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>data<span class=\"token punctuation\">.</span>bins<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        data<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>v_<span class=\"token punctuation\">,</span> <span class=\"token string\">'fold'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> f\n    \n    <span class=\"token comment\"># drop the bins column</span>\n    data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span><span class=\"token string\">\"bins\"</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># return dataframe with folds</span>\n    <span class=\"token keyword\">return</span> data<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n",
            "tags": [
                "ML",
                "DL"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/04/13/hello-world/",
            "url": "https://www.kitx86.com/2022/04/13/hello-world/",
            "title": "Hello World",
            "date_published": "2022-04-12T23:50:55.187Z",
            "content_html": "<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo new <span class=\"token string\">\"My New Post\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo server<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo generate<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo deploy<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n",
            "tags": []
        },
        {
            "id": "https://www.kitx86.com/2022/04/11/ml-dl-kagglecompetem/",
            "url": "https://www.kitx86.com/2022/04/11/ml-dl-kagglecompetem/",
            "title": "ML-DL-KaggleCompeTem",
            "date_published": "2022-04-11T04:24:15.000Z",
            "content_html": "<h2 id=\"1ã€The-most-common-classes-CV\"><a href=\"#1ã€The-most-common-classes-CV\" class=\"headerlink\" title=\"1ã€The most common classes - CV\"></a>1ã€The most common classes - CV</h2><p>è¡¥å……ç»†åˆ†ç±»åˆ«</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># ä»¥USPPPMä¸ºä¾‹å­</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Dataset</span><span class=\"token punctuation\">:</span>\n    \n    \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CFG</span><span class=\"token punctuation\">:</span>\n\n    \n    <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"2ã€The-second-classes-NLP\"><a href=\"#2ã€The-second-classes-NLP\" class=\"headerlink\" title=\"2ã€The second classes - NLP\"></a>2ã€The second classes - NLP</h2><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>\n<p>è¡¥å……ç»†åˆ†ç±»åˆ«</p>\n<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"3ã€Machine-learning-Competitions\"><a href=\"#3ã€Machine-learning-Competitions\" class=\"headerlink\" title=\"3ã€Machine learning Competitions\"></a>3ã€Machine learning Competitions</h2>",
            "tags": [
                "kaggle",
                "ç«èµ›æ¨¡æ¿",
                "å¸¸ç”¨tricks"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/04/08/ml-dl-datavisualtion/",
            "url": "https://www.kitx86.com/2022/04/08/ml-dl-datavisualtion/",
            "title": "ML-Dl-DataVisualtion",
            "date_published": "2022-04-08T13:30:11.000Z",
            "content_html": "<pre class=\"line-numbers language-none\"><code class=\"language-none\">import pandas as pd\npd.plotting.register_matplotlib_converters()\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n",
            "tags": [
                "data vistualtion"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/04/07/ml-dl-you-hua-suan-fa-yi-wen/",
            "url": "https://www.kitx86.com/2022/04/07/ml-dl-you-hua-suan-fa-yi-wen/",
            "title": "ML-DL-ä¼˜åŒ–ç®—æ³•ç–‘é—®",
            "date_published": "2022-04-07T09:14:18.000Z",
            "content_html": "<h4 id=\"ä¼˜åŒ–ç®—æ³•ç–‘é—®\"><a href=\"#ä¼˜åŒ–ç®—æ³•ç–‘é—®\" class=\"headerlink\" title=\"ä¼˜åŒ–ç®—æ³•ç–‘é—®\"></a>ä¼˜åŒ–ç®—æ³•ç–‘é—®</h4><p>å‰ä¸€æ®µæ—¶é—´äº†è§£äº†ç”¨äºæ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–ç®—æ³•ï¼Œå¯æƒœæœ‰ä¸€äº›ç–‘é—®æ²¡èƒ½åŠæ—¶è®°å½•ä¸‹æ¥ï¼Œä¸ç„¶ arxiv ä¼šè¯ç”Ÿå‡ºä¸€ç¯‡æ–°çš„å…³äºä½¿ç”¨å°æ‰¹é‡ä¼˜åŒ–æ¢¯åº¦çš„åä¸½æ–‡ç« </p>\n<p>ä¸‹é¢çš„ç®—æ³•è®°å½•å’Œè°ƒåŒ…ä¾ è¡Œä¸ºæ— å¼‚ï¼Œå¯¹äºæœ‰åŸºç¡€çš„é“å‹å¯ä»¥è·³åˆ°ä»£ç éƒ¨åˆ†</p>\n<p>1.æœ´ç´ çš„ SGD</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SGD</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>lr<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">=</span> lr\n        self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">,</span>self<span class=\"token punctuation\">.</span>grads <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>params<span class=\"token punctuation\">,</span>grads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            params<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">-=</span> self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">*</span> grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>2.ç‰©ç†ä¸–ç•Œçš„ Momentum</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Momentum</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>lr<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span>momentum<span class=\"token operator\">=</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">=</span> lr\n        self<span class=\"token punctuation\">.</span>momentum <span class=\"token operator\">=</span> momentum\n        self<span class=\"token punctuation\">.</span>v <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>params<span class=\"token punctuation\">,</span>grads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>v <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>v <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># v point to direct vector</span>\n            <span class=\"token keyword\">for</span> param <span class=\"token keyword\">in</span> params<span class=\"token punctuation\">:</span>\n                self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>zeros_like<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>momentum <span class=\"token operator\">*</span> self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">*</span> grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n            params<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>3.ä¸çŸ¥é“è¯¥æ€ä¹ˆæè¿° Nesterov</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Nesterov</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># è¿™ä¸ªæ–¹æ³•ä¸å¤ªç†Ÿæ‚‰</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>lr<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span>momentum<span class=\"token operator\">=</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">=</span> lr\n        self<span class=\"token punctuation\">.</span>momentum <span class=\"token operator\">=</span> momentum\n        self<span class=\"token punctuation\">.</span>v <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>params<span class=\"token punctuation\">,</span>grads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>v <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>v <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">for</span> param <span class=\"token keyword\">in</span> params<span class=\"token punctuation\">:</span>\n                self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>zeros_like<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>momentum <span class=\"token operator\">*</span> self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">*</span> grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n            params<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>4.å¤§å®¶æ™®éä½¿ç”¨çš„ AdaGrad</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">AdaGrad</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>lr<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">=</span> lr\n        self<span class=\"token punctuation\">.</span>h <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>params<span class=\"token punctuation\">,</span>grads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>h <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>h <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">for</span> param <span class=\"token keyword\">in</span> params<span class=\"token punctuation\">:</span>\n                self<span class=\"token punctuation\">.</span>h<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>zeros_like<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>h<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n            params<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">-=</span> self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">*</span> grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>sqrt<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>h<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1e-7</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>5.ä¹Ÿæ˜¯å¤§å®¶å¸¸ä½¿ç”¨çš„ RMSprop</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">RMSprop</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__int__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>lr<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span>decay_rate<span class=\"token operator\">=</span><span class=\"token number\">0.99</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">=</span> lr\n        self<span class=\"token punctuation\">.</span>decay_rate <span class=\"token operator\">=</span> decay_rate\n        self<span class=\"token punctuation\">.</span>h <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>params<span class=\"token punctuation\">,</span>grads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>h <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>h <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">for</span> param <span class=\"token keyword\">in</span> params<span class=\"token punctuation\">:</span>\n                self<span class=\"token punctuation\">.</span>h<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>zeros_like<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                self<span class=\"token punctuation\">.</span>h<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">*=</span> self<span class=\"token punctuation\">.</span>decay_rate\n                self<span class=\"token punctuation\">.</span>h<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>decay_rate<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n                params<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">-=</span> self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">*</span> grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>sqrt<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>h<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1e-7</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>6.è¿˜æ˜¯å¤§å®¶å¸¸ä½¿ç”¨çš„ Adam </p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Adam</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>lr<span class=\"token operator\">=</span><span class=\"token number\">0.001</span><span class=\"token punctuation\">,</span>beta1<span class=\"token operator\">=</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span>beta2<span class=\"token operator\">=</span><span class=\"token number\">0.999</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">=</span> lr\n        self<span class=\"token punctuation\">.</span>beta1 <span class=\"token operator\">=</span> beta1\n        self<span class=\"token punctuation\">.</span>beta2 <span class=\"token operator\">=</span> beta2\n        self<span class=\"token punctuation\">.</span><span class=\"token builtin\">iter</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n        self<span class=\"token punctuation\">.</span>m <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n        self<span class=\"token punctuation\">.</span>v <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>params<span class=\"token punctuation\">,</span>grads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>m <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>m<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>v <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">for</span> param <span class=\"token keyword\">in</span> params<span class=\"token punctuation\">:</span>\n                self<span class=\"token punctuation\">.</span>m<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>zeros_like<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>zeros_like<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span><span class=\"token builtin\">iter</span> <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        lr_t <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>lr <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>sqrt<span class=\"token punctuation\">(</span><span class=\"token number\">1.0</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>beta2<span class=\"token operator\">**</span>self<span class=\"token punctuation\">.</span><span class=\"token builtin\">iter</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1.0</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>beta1<span class=\"token operator\">**</span>self<span class=\"token punctuation\">.</span><span class=\"token builtin\">iter</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>m<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>beta1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>m<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>beta2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>grads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n            params <span class=\"token operator\">-=</span> lr_t <span class=\"token operator\">*</span> self<span class=\"token punctuation\">.</span>m<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>sqrt<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1e-7</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"reference\"><a href=\"#reference\" class=\"headerlink\" title=\"reference\"></a>reference</h4><p>ä»£ç æºè‡ªï¼š æ–‹è—¤åº·æ¯…çš„ã€Šæ·±åº¦å­¦ä¹ è¿›é˜¶ï¼šè‡ªç„¶è¯­è¨€å¤„ç†ã€‹ï¼Œæœ‰å…´è¶£çš„é“å‹å¯ä»¥å»ç¿»çœ‹ï¼Œå¾ˆå¥½çš„ä¸€æœ¬ä¹¦ã€‚</p>\n",
            "tags": [
                "SGD",
                "RMSProp",
                "Adam"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/04/07/pe-lun-wen-xie-zuo/",
            "url": "https://www.kitx86.com/2022/04/07/pe-lun-wen-xie-zuo/",
            "title": "PE-è®ºæ–‡å†™ä½œ",
            "date_published": "2022-04-07T00:46:47.000Z",
            "content_html": "<h2 id=\"è®ºæ–‡å†™ä½œè¦æ±‚\"><a href=\"#è®ºæ–‡å†™ä½œè¦æ±‚\" class=\"headerlink\" title=\"è®ºæ–‡å†™ä½œè¦æ±‚\"></a>è®ºæ–‡å†™ä½œè¦æ±‚</h2><p>1.æ ‡é¢˜ + ä½œè€…</p>\n<p>2.æ‘˜è¦ - Abstract</p>\n<p>3.å¯¼è¨€ - Introduction </p>\n<p>4.ç›¸å…³å·¥ä½œ - Related Work</p>\n<p>Example : 5.æ¨¡å‹ - Deep Residual Learning - 5.1 &gt; 5.2 â€¦</p>\n<p>6.ç†è®º</p>\n<p>7.å®éªŒ + æ€»ç»“ - Experiments + Conclusion</p>\n<p>8.è¯„è®º</p>\n<p>å¼•ç”¨ï¼šReferences</p>\n",
            "tags": [
                "è®ºæ–‡å†™ä½œ"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/04/04/ml-dl-python-yong-fa-zhu-yi/",
            "url": "https://www.kitx86.com/2022/04/04/ml-dl-python-yong-fa-zhu-yi/",
            "title": "ML-DL-pythonç”¨æ³•æ³¨æ„",
            "date_published": "2022-04-04T02:02:31.000Z",
            "content_html": "<h2 id=\"Python\"><a href=\"#Python\" class=\"headerlink\" title=\"Python\"></a>Python</h2><h3 id=\"åˆ‡ç‰‡æ“ä½œçš„å°å—è§£é‡Š\"><a href=\"#åˆ‡ç‰‡æ“ä½œçš„å°å—è§£é‡Š\" class=\"headerlink\" title=\"åˆ‡ç‰‡æ“ä½œçš„å°å—è§£é‡Š\"></a>åˆ‡ç‰‡æ“ä½œçš„å°å—è§£é‡Š</h3><ul>\n<li>[-1]ï¼šè·å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç±»ä¼¼äºmatlabä¸­çš„endï¼›</li>\n<li>[:-1]ï¼šé™¤äº†æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè·å–å…¶ä»–æ‰€æœ‰çš„å…ƒç´ ï¼›</li>\n<li>[::-1]ï¼šå¯¹ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ è¿›è¡Œå€’åºä¹‹åå–å‡ºï¼›</li>\n<li>[n::-1]ï¼šå¯¹ç¬¬ä¸€ä¸ªåˆ°ç¬¬nä¸ªå…ƒç´ è¿›è¡Œå€’åºåå–å‡º</li>\n</ul>\n<h2 id=\"enumerate\"><a href=\"#enumerate\" class=\"headerlink\" title=\"enumerate()\"></a>enumerate()</h2><p>enumerate() å‡½æ•°ç”¨äºå°†ä¸€ä¸ªå¯éå†çš„æ•°æ®å¯¹è±¡ç»„åˆæˆä¸€ä¸ªç´¢å¼•åºåˆ—ï¼ŒåŒæ—¶åˆ—å‡ºæ•°æ®å’Œæ•°æ®ä¸‹æ ‡</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">train_score <span class=\"token operator\">=</span> train<span class=\"token punctuation\">[</span><span class=\"token string\">'score'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">del</span> train<span class=\"token punctuation\">[</span><span class=\"token string\">'score'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n",
            "tags": []
        },
        {
            "id": "https://www.kitx86.com/2022/04/02/ml-dl-zhu-yi-li-ji-zhi/",
            "url": "https://www.kitx86.com/2022/04/02/ml-dl-zhu-yi-li-ji-zhi/",
            "title": "ML-DL-æ³¨æ„åŠ›æœºåˆ¶",
            "date_published": "2022-04-02T15:20:41.000Z",
            "content_html": "<h2 id=\"æ³¨æ„åŠ›æœºåˆ¶-Attention-Mechanism\"><a href=\"#æ³¨æ„åŠ›æœºåˆ¶-Attention-Mechanism\" class=\"headerlink\" title=\"æ³¨æ„åŠ›æœºåˆ¶ - Attention Mechanism\"></a>æ³¨æ„åŠ›æœºåˆ¶ - Attention Mechanism</h2><h3 id=\"ä¸€ã€attention-è¿™é¡¹å·¥ä½œçš„å‡ºç°\"><a href=\"#ä¸€ã€attention-è¿™é¡¹å·¥ä½œçš„å‡ºç°\" class=\"headerlink\" title=\"ä¸€ã€attention è¿™é¡¹å·¥ä½œçš„å‡ºç°\"></a>ä¸€ã€attention è¿™é¡¹å·¥ä½œçš„å‡ºç°</h3><h3 id=\"äºŒã€é’ˆå¯¹æ³¨æ„åŠ›æœºåˆ¶æ‰€åŒ…å«çš„ä¸€äº›åŒºåˆ†\"><a href=\"#äºŒã€é’ˆå¯¹æ³¨æ„åŠ›æœºåˆ¶æ‰€åŒ…å«çš„ä¸€äº›åŒºåˆ†\" class=\"headerlink\" title=\"äºŒã€é’ˆå¯¹æ³¨æ„åŠ›æœºåˆ¶æ‰€åŒ…å«çš„ä¸€äº›åŒºåˆ†\"></a>äºŒã€é’ˆå¯¹æ³¨æ„åŠ›æœºåˆ¶æ‰€åŒ…å«çš„ä¸€äº›åŒºåˆ†</h3><p>1ã€è½¯æ³¨æ„ï¼Œä¾§é‡äºå¸å–çš„ä¿¡æ¯ç›¸å¯¹æ¥è¯´ä¼šåå‘å…¨é¢</p>\n<p>2ã€ç¡¬æ³¨æ„ï¼Œä¼šç›´æ¥èˆå¼ƒéƒ¨åˆ†ä¿¡æ¯æ¥ä¿ç•™è®¡ç®—çš„è½»ä¾¿</p>\n<p>3ã€è‡ªæ³¨æ„æœºåˆ¶ï¼Œç”±è¾“å…¥æƒé‡æ¥ç›¸äº’ä½œç”¨ï¼Œå…¶å®è¿™æ ·çš„çŠ¶å†µæ˜¯ç”±å†…éƒ¨æ¥å†³å®šï¼Œ</p>\n<p>é¢„è®­ç»ƒæ¨¡å‹çœ‹èµ·æ¥å’Œ Transformer æœ‰ç€å¾ˆå¤§çš„å¹²ç³»ï¼Œå¯ä»¥è¯´æ˜¯è¯­è¨€æ¨¡å‹çš„æ ¸å¿ƒç½‘ç»œï¼Œ</p>\n<p>transformer åœ¨æˆ‘è¿™é‡Œç»™å‡ºçš„è§£é‡Šæ˜¯ï¼Œä¸€æ®µè¯ä½œä¸ºè¾“å…¥ï¼Œé¦–å…ˆå°†è¾“å…¥ä¸­çš„å„ä¸ªè¯åœ¨self-attention æœºåˆ¶ä¸‹å˜æˆè¯å‘é‡ï¼ŒåŒæ—¶ä¼šå«æœ‰ä¸€è¿ä¸²çš„æ¯ä¸€ä¸ªè¯çš„ä½ç½®å‘é‡ ï¼ˆ ä¸è¡Œï¼Œæˆ‘å®Œå…¨æ˜¯è·Ÿç€åˆ«äººèµ°çš„ï¼‰</p>\n",
            "tags": [
                "æ·±åº¦å­¦ä¹ ",
                "å¾ªç¯ç¥ç»ç½‘ç»œ"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/04/02/ml-dl-readingpaper/",
            "url": "https://www.kitx86.com/2022/04/02/ml-dl-readingpaper/",
            "title": "ML-DL-ReadingPaper",
            "date_published": "2022-04-02T03:41:23.000Z",
            "content_html": "<h2 id=\"Awesome-Deep-Learning-amp-Quantum-Computing\"><a href=\"#Awesome-Deep-Learning-amp-Quantum-Computing\" class=\"headerlink\" title=\"Awesome Deep Learning &amp; Quantum Computing\"></a>Awesome Deep Learning &amp; Quantum Computing</h2><p>æˆ‘çš„å°ä»“åº“ğŸ˜ğŸ˜ : <a href=\"https://www.aliyundrive.com/s/CELiSXuKc8e\">https://www.aliyundrive.com/s/CELiSXuKc8e</a></p>\n<p>ä¸é”™çš„githubåœ°å€ï¼š</p>\n<p><u>æ·±åº¦å­¦ä¹ </u></p>\n<p><a href=\"https://github.com/floodsung/Deep-Learning-Papers-Reading-Roadmap\">https://github.com/floodsung/Deep-Learning-Papers-Reading-Roadmap</a></p>\n<p><a href=\"https://github.com/mli/paper-reading\">https://github.com/mli/paper-reading</a></p>\n<p><u>é‡å­è®¡ç®—</u></p>\n<p><a href=\"https://github.com/desireevl/awesome-quantum-computing\">https://github.com/desireevl/awesome-quantum-computing</a></p>\n",
            "tags": [
                "paper",
                "deep learning",
                "neural network"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/03/28/ml-dl-xun-huan-shen-jing-wang-luo/",
            "url": "https://www.kitx86.com/2022/03/28/ml-dl-xun-huan-shen-jing-wang-luo/",
            "title": "ML-DL-å¾ªç¯ç¥ç»ç½‘ç»œ",
            "date_published": "2022-03-28T06:37:08.000Z",
            "content_html": "",
            "tags": [
                "RNN",
                "å¾ªç¯ç¥ç»ç½‘ç»œ"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/03/26/ml-dl-pytorch-shi-xian/",
            "url": "https://www.kitx86.com/2022/03/26/ml-dl-pytorch-shi-xian/",
            "title": "ML-DL-Pytorchå®ç°",
            "date_published": "2022-03-26T14:35:40.000Z",
            "content_html": "<h4 id=\"Declaration-ï¼šå€Ÿé‰´äº†-d2l-https-zh-d2l-ai-çš„pytorchå®ç°\"><a href=\"#Declaration-ï¼šå€Ÿé‰´äº†-d2l-https-zh-d2l-ai-çš„pytorchå®ç°\" class=\"headerlink\" title=\"Declaration ï¼šå€Ÿé‰´äº† d2l (https://zh.d2l.ai)çš„pytorchå®ç°\"></a>Declaration ï¼šå€Ÿé‰´äº† d2l (<a href=\"https://zh.d2l.ai)çš„pytorchå®ç°/\">https://zh.d2l.ai)çš„pytorchå®ç°</a></h4>",
            "tags": [
                "pytorch",
                "æ·±åº¦å­¦ä¹ ",
                "æœºå™¨å­¦ä¹ "
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/03/26/pe-shi-xi-yi-xiang/",
            "url": "https://www.kitx86.com/2022/03/26/pe-shi-xi-yi-xiang/",
            "title": "PE-å®ä¹ æ„å‘",
            "date_published": "2022-03-26T10:50:02.000Z",
            "content_html": "<p>ç›®å½•</p>\n<ul>\n<li><p>ä¸€ã€AI for Designç ”å‘å®ä¹ ç”Ÿ</p>\n</li>\n<li><p>äºŒã€Graph Neural Network Researchç ”å‘å®ä¹ ç”Ÿ</p>\n</li>\n<li><p>ä¸‰ã€ä¸Šæµ·AIç³»ç»Ÿç ”ç©¶å®ä¹ ç”Ÿ</p>\n</li>\n<li><p>å››ã€æœºå™¨å­¦ä¹ ç»„AI for Scienceå®ä¹ ç”Ÿ</p>\n</li>\n<li><p>äº”ã€ä¸Šæµ·AIç³»ç»Ÿå¼€å‘å®ä¹ ç”Ÿ</p>\n</li>\n<li><p>å…­ã€æœºå™¨å­¦ä¹ +è®¡ç®—åŒ–å­¦/è®¡ç®—ç‰©ç†ç®—æ³•å®ä¹ ç”Ÿ</p>\n</li>\n<li><p>ä¸ƒã€å¼ºåŒ–å­¦ä¹ ç®—æ³•åº”ç”¨å®ä¹ ç”Ÿ</p>\n</li>\n</ul>\n<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>\n<p>ä¸€ã€AI for Designç ”å‘å®ä¹ ç”Ÿ</p>\n<ul>\n<li>æ‹›è˜äººæ•°ï¼š 1-2</li>\n<li>å·¥ä½œåœ°ç‚¹ï¼š åŒ—äº¬</li>\n</ul>\n<p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p>\n<p>å¾®è½¯äºšæ´²ç ”ç©¶é™¢DKI (Data, Knowledge &amp; Intelligence) Area è‡´åŠ›äºäººå·¥æ™ºèƒ½ã€æ•°æ®åˆ†æã€æ•°æ®äº¤äº’ã€‚æ•°æ®å¯è§†åŒ–çš„ç ”ç©¶ã€‚æ¢ç´¢å…¨æ–°çš„æ•°æ®åˆ†æï¼Œå±•ç¤ºï¼Œäº¤äº’æŠ€æœ¯ï¼Œè®©æ•°æ®å’Œæ•°æ®ä¸­çš„å‘ç°æ•…äº‹è¢«é«˜æ•ˆåœ°ç†è§£ã€å¹¿æ³›åœ°ä¼ æ’­ã€‚æ•°æ®æ™ºèƒ½æ˜¯ä¸€ä¸ªå…¸å‹çš„äº¤å‰é¢†åŸŸï¼Œç»¼åˆäº†è‡ªç„¶è¯­è¨€å¤„ç†ã€å¤šç»´æ•°æ®åˆ†æã€æœºå™¨å­¦ä¹ ã€æ•°æ®å¯è§†åŒ–ã€äººæœºäº¤äº’ã€è®¡ç®—æœºè§†è§‰ç­‰å¤šä¸ªé¢†åŸŸã€‚å›¢é˜Ÿä¸å¾®è½¯æ ¸å¿ƒäº§å“ï¼ˆå¦‚Excelï¼ŒPowerPointç­‰ï¼‰æ·±åº¦åˆä½œï¼Œå¹¶å¸¸å¹´åœ¨å„ä¸ªé¢†åŸŸçš„é¡¶çº§ä¼šè®®å’ŒæœŸåˆŠä¸Šå‘è¡¨å…·æœ‰å½±å“åŠ›çš„è®ºæ–‡ã€‚</p>\n<p><strong>é¡¹ç›®ç®€ä»‹ï¼š</strong></p>\n<p>ä¸»è¦ä»äº‹å°†äººå·¥æ™ºèƒ½ä¸å¹³é¢è®¾è®¡ç›¸ç»“åˆçš„ç ”ç©¶å·¥ä½œï¼Œæ¢ç´¢ä½¿å¾—å¹³é¢è®¾è®¡æ›´åŠ è‡ªåŠ¨åŒ–å’Œæ™ºèƒ½åŒ–çš„æ·±åº¦å­¦ä¹ æ¨¡å‹å’Œæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªè·¨é¢†åŸŸçš„ç ”ç©¶è¯¾é¢˜ï¼Œæ¶‰åŠåˆ°æ·±åº¦å­¦ä¹ ã€è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€å¹³é¢è®¾è®¡ã€è½¯ä»¶å·¥ç¨‹ç­‰ç ”ç©¶é¢†åŸŸã€‚</p>\n<p><strong>å·¥ä½œèŒè´£ï¼š</strong></p>\n<ul>\n<li>ç§¯æè·Ÿè¿›å’Œå…³æ³¨æ·±åº¦å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰çš„å‰æ²¿ç ”ç©¶</li>\n<li>æ¨¡å‹ä¸ç®—æ³•è®¾è®¡å’Œæ”¹è¿›ï¼Œæ•°æ®çš„æ”¶é›†ä¸å¤„ç†ï¼Œå¤§è§„æ¨¡æ¨¡å‹çš„è®­ç»ƒä¸è°ƒè¯•ï¼Œå®éªŒç»“æœåˆ†æä¸æ€»ç»“ï¼Œç­‰ç­‰</li>\n<li>æ’°å†™é«˜æ°´å¹³è®ºæ–‡</li>\n<li>åŸå‹ç³»ç»Ÿçš„å®ç°</li>\n</ul>\n<p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p>\n<ol>\n<li>ç›¸å…³ä¸“ä¸šç¡•å£«åŠä»¥ä¸Šå…¨æ—¥åˆ¶åœ¨è¯»å­¦ç”Ÿ</li>\n<li>ç†Ÿæ‚‰Pythonï¼Œç²¾é€š Huggingface, Fairseq, DeepSpeedç­‰DNNæ¡†æ¶ä¸å·¥å…·</li>\n<li>æœ‰è¾ƒå¼ºçš„æ•°å­¦åŸºç¡€ï¼Œè¾ƒå¼ºçš„ç¼–ç¨‹èƒ½åŠ›ï¼Œèƒ½ç‹¬ç«‹è¿›è¡Œæ•°æ®åˆ†æ</li>\n<li>å…·å¤‡æ·±åº¦å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰çš„ç›¸å…³çŸ¥è¯†</li>\n<li>éœ€è¦å¯¹GANã€CLIPã€DALL-Eã€GPTã€T5ã€BARTç­‰å·¥ä½œåŠç›¸å…³ç ”ç©¶ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªéå¸¸äº†è§£</li>\n<li>æ‹¥æœ‰è®ºæ–‡å¿«é€Ÿæ£€ç´¢å’Œé˜…è¯»èƒ½åŠ›</li>\n<li>æœ‰åœ¨è®¡ç®—æœºè§†è§‰æˆ–NLPæ–¹å‘å›½é™…ä¼šè®®å‘è¡¨è®ºæ–‡ç»å†ï¼Œæˆ–ç¼–ç¨‹æ¯”èµ›ç»å†çš„åŒå­¦ä¼˜å…ˆã€‚</li>\n<li>æœ‰æŠ€æœ¯ç±»åšå®¢æ–‡ç« æ’°å†™ä¹ æƒ¯çš„ä¼˜å…ˆ</li>\n</ol>\n<p>äºŒã€Graph Neural Network Researchç ”å‘å®ä¹ ç”Ÿ</p>\n<ul>\n<li>æ‹›è˜äººæ•°ï¼š 1-2</li>\n<li>å·¥ä½œåœ°ç‚¹ï¼š åŒ—äº¬</li>\n</ul>\n<p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p>\n<p>Data Analytics Researchæ˜¯å¾®è½¯äºšæ´²ç ”ç©¶é™¢DKI (Data, Knowledge &amp; Intelligence) Area ä¸‹ä¸“æ³¨äºæ•°æ®åˆ†æçš„ç ”ç©¶å›¢é˜Ÿï¼Œæ·±åº¦å‚ä¸äº†å¾®è½¯å¤šä¸ªäº§å“ï¼ˆå¦‚Excel, Forms, Bing, Azure, Power BIç­‰ï¼‰ä¸­æ•°æ®åˆ†æå’Œæ™ºèƒ½çš„ç ”å‘å·¥ä½œï¼Œæ·±åˆ»æ”¹å˜äº†äº¿ä¸‡ç”¨æˆ·åˆ†æç†è§£å„é¢†åŸŸæ•°æ®çš„æ–¹å¼ï¼Œå¹¶åœ¨æ•°æ®æŒ–æ˜ã€äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ ã€è½¯ä»¶å·¥ç¨‹ç­‰é¢†åŸŸå¸¸å¹´å‘è¡¨å…·æœ‰å½±å“åŠ›çš„å·¥ä½œã€‚</p>\n<p><strong>é¡¹ç›®ç®€ä»‹ï¼š</strong></p>\n<p>ä¸»è¦ä»äº‹å›¾ç¥ç»ç½‘ç»œç›¸å…³çš„ç ”ç©¶å·¥ä½œï¼Œç€çœ¼äºå›¾ç¥ç»ç½‘ç»œæ¨¡å‹çš„è®¾è®¡ä¸ç†è§£ï¼Œè‡´åŠ›äºæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ä»¥åŠå¯è§£é‡Šæ€§ï¼ŒåŒ…æ‹¬ä½†ä¸ä»…é™äºå›¾ç¥ç»ç½‘ç»œæ–°æ¶æ„è®¾è®¡ï¼Œå›¾æ¨¡å‹æ™®é€‚æ€§åˆ†æï¼ŒåŸºäºå›¾æ€§è´¨çš„é—®é¢˜ç©ºé—´åˆ’åˆ†ï¼Œå›¾è¿ç§»å­¦ä¹ ï¼Œç­‰ç­‰ã€‚æ­¤å¤–ï¼ŒåŸºäºå¯¹å›¾æ¨¡å‹çš„ç†è§£ï¼Œæˆ‘ä»¬ä¹Ÿæ¢ç´¢å›¾ç½‘ç»œåœ¨æ›´å¹¿æ³›é—®é¢˜åœºæ™¯ä¸‹çš„åº”ç”¨å‰æ™¯ï¼Œç”¨å›¾ç½‘ç»œæŠ€æœ¯èµ‹èƒ½æ›´å¤šé¢†åŸŸã€‚</p>\n<p><strong>å·¥ä½œèŒè´£ï¼š</strong></p>\n<ul>\n<li>ç§¯æè·Ÿè¿›å’Œå…³æ³¨å›¾ç½‘ç»œå­¦ä¹ çš„å‰æ²¿ç ”ç©¶</li>\n<li>è¿›è¡Œå›¾ç½‘ç»œæ¨¡å‹ç ”ç©¶ï¼ŒåŒ…æ‹¬è®¾è®¡æ–°çš„å›¾æ¨¡å‹æ¶æ„ä¸å­¦ä¹ ç®—æ³•ï¼Œå›¾æ¨¡å‹å¯è§£é‡Šæ€§ç ”ç©¶ï¼Œæ–°é¢†åŸŸä¸‹çš„å›¾æ¨¡å‹åº”ç”¨ï¼Œç­‰ç­‰</li>\n<li>æ’°å†™é«˜æ°´å¹³è®ºæ–‡å¹¶åœ¨é¡¶çº§ä¼šè®®å’ŒæœŸåˆŠä¸Šè¿›è¡Œå‘è¡¨</li>\n</ul>\n<p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p>\n<ol>\n<li>ç†Ÿæ‚‰Pythonï¼Œç²¾é€š Pytorchæˆ–Tensorflow</li>\n<li>å…·å¤‡æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ çš„ç›¸å…³çŸ¥è¯†</li>\n<li>æ‹¥æœ‰è®ºæ–‡å¿«é€Ÿæ£€ç´¢å’Œé˜…è¯»èƒ½åŠ›</li>\n<li>æœ‰åœ¨å›½é™…ä¼šè®®å‘è¡¨è®ºæ–‡ç»å†ã€ACMæˆ–å…¶ä»–ç¼–ç¨‹æ¯”èµ›ç»å†çš„åŒå­¦ä¼˜å…ˆã€‚</li>\n</ol>\n<p>ä¸‰ã€ä¸Šæµ·AIç³»ç»Ÿç ”ç©¶å®ä¹ ç”Ÿ</p>\n<ul>\n<li>æ‹›è˜äººæ•°ï¼š 2-4</li>\n<li>å·¥ä½œåœ°ç‚¹ï¼š ä¸Šæµ·</li>\n</ul>\n<p><strong>å·¥ä½œèŒè´£ï¼š</strong></p>\n<p>åœ¨ MSRAç ”ç©¶å‘˜ä»¬çš„æŒ‡å¯¼ä¸‹ï¼Œè¿›è¡Œäººå·¥æ™ºèƒ½ç³»ç»Ÿå‰æ²¿æŠ€æœ¯çš„ç ”ç©¶ï¼Œå…·ä½“ç ”ç©¶æ–¹å‘åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>\n<ul>\n<li>é’ˆå¯¹å¤§æ¨¡å‹ã€ç³»æ•°æ¨¡å‹ã€åŠ¨æ€æ¨¡å‹ç­‰å‰æ²¿æ¨¡å‹çš„è®­ç»ƒåŠæ¨ç†ä¼˜åŒ–</li>\n<li>é’ˆå¯¹å„ç§ç«¯ä¾§å’Œäº‘ä¾§è®¾å¤‡è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²ä¼˜åŒ–ï¼ŒåŒ…æ‹¬ç¼–è¯‘ä¼˜åŒ–ï¼Œæ¨¡å‹æ¶æ„ä¼˜åŒ–ä¸å‹ç¼©ï¼Œé¢å‘ç¡¬ä»¶çš„é«˜æ•ˆæ¨¡å‹è®¾è®¡ç­‰</li>\n<li>é¢å‘æ·±åº¦å­¦ä¹ è´Ÿè½½çš„é›†ç¾¤è®¾è®¡ï¼ŒåŒ…æ‹¬è°ƒåº¦ä¼˜åŒ–ï¼Œæ•°æ®ä¸é€šä¿¡ä¼˜åŒ–ç­‰</li>\n</ul>\n<p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p>\n<ul>\n<li>ç¡•å£«æˆ–åšå£«ç ”ç©¶ç”Ÿï¼Œä¸“ä¸šä¸ºè®¡ç®—æœºã€ç”µå­ä¿¡æ¯ç­‰ç›¸å…³ä¸“ä¸šï¼Œå…·æœ‰è¾ƒå¼ºçš„è‹±æ–‡å¬è¯´è¯»å†™èƒ½åŠ›ã€‚</li>\n<li>æœ‰å¼ºçƒˆçš„æ„æ„¿åšä¸–ç•Œå…ˆè¿›çš„ç§‘å­¦ç ”ç©¶å¹¶ä¸”åœ¨é¡¶çº§ä¼šè®®æˆ–æœŸåˆŠå‘è¡¨è®ºæ–‡ã€‚</li>\n<li>å…·å¤‡è‰¯å¥½çš„åŠ¨æ‰‹èƒ½åŠ›ï¼Œä»¥åŠåˆ†æé—®é¢˜è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¿«é€Ÿåœ°è§„åˆ’å‡ºè§£å†³æ–¹æ¡ˆï¼Œå¹¶è¿›è¡ŒéªŒè¯</li>\n<li>æœ‰å›¢é˜Ÿåä½œç²¾ç¥ï¼Œæœ‰è´£ä»»å¿ƒ</li>\n</ul>\n<p><strong>åŠ åˆ†é¡¹ï¼š</strong></p>\n<ul>\n<li>æœ‰æ·±åº¦å­¦ä¹ åŸºç¡€ï¼Œè‡³å°‘å¯¹ä¸€ç§æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆPyTorch ä¼˜å…ˆï¼ŒTensorFlowç­‰ï¼‰å…·æœ‰æ·±å…¥ç†è§£ï¼›å¯¹AIç®—æ³•æœ‰ä¸€å®šäº†è§£ï¼Œæœ‰åœ¨ç›¸å…³é¢†åŸŸé¡¶ä¼šä¸Šå‘è¡¨è¿‡è®ºæ–‡è€…ä¼˜å…ˆ</li>\n<li>å¯¹GPUæ¶æ„å…·æœ‰ä¸€å®šäº†è§£ï¼Œå¹¶æœ‰ä¼˜åŒ–ç»éªŒè€…ä¼˜å…ˆ</li>\n<li>å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿæˆ–æ•°æ®åº“ç³»ç»Ÿæœ‰ä¸€å®šåŸºç¡€ï¼Œå…·æœ‰ç›¸å…³ç ”ç©¶ç»éªŒè€…ä¼˜å…ˆ</li>\n<li>å…·æœ‰AIåŠ é€Ÿå™¨ï¼ˆASIC/FPGAç­‰ï¼‰ç ”ç©¶ç»éªŒè€…ä¼˜å…ˆ</li>\n<li>å‚åŠ è¿‡å­¦æœ¯ç•Œå·¥ä¸šç•Œæœºå™¨å­¦ä¹ ç›¸å…³æ¯”èµ›ï¼ŒCCPC/ICPC ç­‰ç¨‹åºè®¾è®¡ç«èµ›ï¼Œç”µå­è®¾è®¡å¤§èµ›ç­‰ç«èµ›å¹¶è·å¾—ä¼˜å¼‚æˆç»©è€…ä¼˜å…ˆ</li>\n<li></li>\n</ul>\n<p>å››ã€æœºå™¨å­¦ä¹ ç»„AI for Scienceå®ä¹ ç”Ÿ</p>\n<ul>\n<li>æ‹›è˜äººæ•°ï¼š 3-5</li>\n<li>å·¥ä½œåœ°ç‚¹ï¼š åŒ—äº¬</li>\n</ul>\n<p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p>\n<p>å¾®è½¯äºšæ´²ç ”ç©¶é™¢æœºå™¨å­¦ä¹ ç»„è‡´åŠ›äºä»ç®—æ³•ã€åº”ç”¨å’Œç†è®ºå±‚é¢æ¨è¿›äººå·¥æ™ºèƒ½å‰æ²¿ç ”ç©¶ï¼ŒåŠ é€Ÿäººå·¥æ™ºèƒ½åœ¨è‡ªç„¶ç§‘å­¦å’Œäº§ä¸šåº”ç”¨ä¸­çš„æ¢ç´¢ã€‚æœºå™¨å­¦ä¹ ç»„å¼€å‘äº†Graphormerï¼ŒLightGBMç­‰å¤šä¸ªå—æ¬¢è¿çš„å¼€æºå·¥å…·åŒ…ï¼Œå¤šæ¬¡å¤ºå¾—å›½é™…æ¯”èµ›å† å†›ï¼Œå¹¶æŒç»­äº§å‡ºé«˜è´¨é‡å­¦æœ¯è®ºæ–‡ã€‚</p>\n<p><strong>å·¥ä½œèŒè´£ï¼š</strong></p>\n<p>å‚ä¸AI for Scienceé¡¹ç›®ç§‘ç ”é¡¹ç›®ï¼Œæ’°å†™é«˜è´¨é‡è®ºæ–‡ï¼Œå®Œæˆå‰æ²¿ç®—æ³•çš„è½åœ°ä¸éƒ¨ç½²ï¼Œå¼€å‘ã€ç»´æŠ¤å¼€æºå·¥å…·åŒ…ã€‚å…·ä½“æ–¹å‘åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>\n<ol>\n<li>åŸºäºæ·±åº¦å­¦ä¹ çš„åˆ†å­æ¨¡æ‹Ÿï¼Œå¦‚åˆ†å­åŠ¨åŠ›å­¦ï¼Œåˆ†å­æ€§è´¨é¢„æµ‹ï¼Œåˆ†å­ç”Ÿæˆï¼Œé€†åˆæˆç­‰ã€‚</li>\n<li>æ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨ç®—æ³•åŠç†è®ºå±‚é¢çš„åˆ›æ–°ï¼Œå¦‚å›¾ç¥ç»ç½‘ç»œã€å¤§è§„æ¨¡é¢„è®­ç»ƒç®—æ³•ç­‰ã€‚</li>\n<li>æ·±åº¦å­¦ä¹ åœ¨ææ–™å‘ç°ã€è¯ç‰©å‘ç°ç­‰ä¸­çš„åº”ç”¨ã€‚</li>\n<li>æœºå™¨å­¦ä¹ ä¸æ¹¿å®éªŒç›¸ç»“åˆã€‚</li>\n<li>ä½¿ç”¨æœºå™¨å­¦ä¹ åŠ é€Ÿå¯†åº¦æ³›å‡½ç†è®ºç­‰ã€‚</li>\n</ol>\n<p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p>\n<ol>\n<li>æ‰å®çš„æ•°ç†åŸºç¡€çŸ¥è¯†ã€‚</li>\n<li>ä»»ä¸€ç›¸å…³æ–¹å‘æ‰å®çš„èƒŒæ™¯çŸ¥è¯†ã€‚</li>\n<li>ç†Ÿç»ƒä½¿ç”¨PyTorch/Tensorflowç­‰æ·±åº¦å­¦ä¹ åº“ã€‚</li>\n</ol>\n<p>åŠ åˆ†é¡¹ï¼š</p>\n<ol>\n<li>æœ‰æœºå™¨å­¦ä¹ æ–¹å‘é¡¶ä¼šè®ºæ–‡å‘è¡¨ã€‚æˆ–</li>\n<li>æœ‰ä¸°å¯Œçš„è®¡ç®—ç‰©ç†ã€åŒ–å­¦ã€ç”Ÿç‰©çŸ¥è¯†ï¼Œä¼šç†Ÿç»ƒä½¿ç”¨ç›¸å…³é‡å­åŒ–å­¦è½¯ä»¶ç­‰ã€‚</li>\n<li>å®ä¹ æ—¶é—´ä¸€å¹´åŠä»¥ä¸Šã€‚</li>\n</ol>\n<p>äº”ã€ä¸Šæµ·AIç³»ç»Ÿå¼€å‘å®ä¹ ç”Ÿ</p>\n<ul>\n<li>æ‹›è˜äººæ•°ï¼š 2-4</li>\n<li>å·¥ä½œåœ°ç‚¹ï¼š ä¸Šæµ·</li>\n</ul>\n<p><strong>å·¥ä½œèŒè´£ï¼š</strong></p>\n<p>ä¸ MSRAçš„ç ”ç©¶å‘˜ä»¬åˆä½œï¼Œå…±åŒç ”ç©¶AIå‰æ²¿æŠ€æœ¯ï¼Œè®¾è®¡å¼€å‘äººå·¥æ™ºèƒ½ç³»ç»Ÿä¸å·¥å…·ï¼Œç»´æŠ¤å¼€æºé¡¹ç›®ï¼Œå¹¶å°†å¼€å‘æˆæœåº”ç”¨äºå®é™…åœºæ™¯ã€‚å…¶å…·ä½“å†…å®¹åŒ…æ‹¬ï¼š</p>\n<ul>\n<li>åœ¨æ·±å…¥ç†è§£å‰æ²¿ç®—æ³•ï¼ˆå¦‚NASï¼ŒModel Compressionï¼Œsparsityï¼‰çš„åŸºç¡€ä¸Šï¼Œæ¢ç´¢æœªæ¥çš„å‘å±•æ–¹å‘</li>\n<li>å‚ä¸MSRA å¼€æºé¡¹ç›®ï¼ˆå¦‚ NNIã€nn-meterç­‰ï¼‰çš„è®¾è®¡å’Œå¼€å‘ï¼ŒåŒ…æ‹¬æ¥å£è®¾è®¡ï¼Œç®—æ³•å®ç°ï¼Œç”¨æˆ·äº¤äº’ç­‰</li>\n<li>ä¸å›¢é˜Ÿåˆä½œæ¢ç´¢é¡¹ç›®çš„æ›´å¤šåº”ç”¨åœºæ™¯ï¼Œå¹¶å°†ç³»ç»Ÿä¸å·¥å…·è¿ç”¨äºå®é™…äº§å“ä¸­</li>\n</ul>\n<p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p>\n<ul>\n<li>æœ‰è®¡ç®—æœºç§‘å­¦ã€æ•°æ®ç§‘å­¦æˆ–ç›¸å…³ä¸“ä¸šèƒŒæ™¯ï¼Œæœ¬ç§‘åŠä»¥ä¸Šå­¦å†åœ¨æ ¡å­¦ç”Ÿ</li>\n<li>æœ‰ Pythonç­‰è¯­è¨€çš„ç¼–ç¨‹ç»éªŒï¼Œå¯¹ Tensorflow/PyTorch ç­‰æ·±åº¦å­¦ä¹ æ¡†æ¶æœ‰ä¸€å®šäº†è§£</li>\n<li>å…·å¤‡è‰¯å¥½çš„å·¥ç¨‹èƒ½åŠ›ï¼Œä»¥åŠåˆ†æé—®é¢˜è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¿«é€Ÿåœ°è§„åˆ’å‡ºè§£å†³æ–¹æ¡ˆï¼Œå¹¶å°†æƒ³æ³•è½åœ°</li>\n<li>æœ‰å›¢é˜Ÿåä½œç²¾ç¥ï¼Œæœ‰è´£ä»»å¿ƒ</li>\n</ul>\n<p><strong>åŠ åˆ†é¡¹ï¼š</strong></p>\n<ul>\n<li>å¯¹AIç®—æ³•ï¼ˆAutoML/NAS/Compressionç­‰ï¼‰æœ‰ä¸€å®šäº†è§£ï¼Œæœ‰åœ¨ç›¸å…³é¢†åŸŸé¡¶ä¼šä¸Šå‘è¡¨è¿‡è®ºæ–‡è€…ä¼˜å…ˆ</li>\n<li>å‚åŠ è¿‡å­¦æœ¯ç•Œå·¥ä¸šç•Œæœºå™¨å­¦ä¹ ç›¸å…³æ¯”èµ›å¹¶è·å¾—ä¼˜å¼‚æˆç»©è€…ä¼˜å…ˆ</li>\n<li>å…·æœ‰æ·±åº¦å­¦ä¹ é¡¹ç›®ç»éªŒè€…ä¼˜å…ˆï¼Œç†Ÿæ‚‰åˆ†å¸ƒå¼è®­ç»ƒè€…ä¼˜å…ˆ</li>\n<li>æœ‰ CCPC/ICPC ç­‰ç¨‹åºè®¾è®¡ç«èµ›çš„è·å¥–ç»å†è€…ä¼˜å…ˆ</li>\n<li>æœ‰å¼€æºé¡¹ç›®å¼€å‘æˆ–ç»´æŠ¤ç»å†è€…ä¼˜å…ˆ</li>\n</ul>\n<p>å…­ã€æœºå™¨å­¦ä¹ +è®¡ç®—åŒ–å­¦/è®¡ç®—ç‰©ç†ç®—æ³•å®ä¹ ç”Ÿ</p>\n<ul>\n<li>æ‹›è˜äººæ•°ï¼š 2-4</li>\n</ul>\n<p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p>\n<p>å¾®è½¯äºšæ´²ç ”ç©¶é™¢æœºå™¨å­¦ä¹ é¢†åŸŸä»ç†è®ºã€ç®—æ³•ã€åº”ç”¨ç­‰ä¸åŒå±‚é¢æ¨åŠ¨æœºå™¨å­¦ä¹ çš„å‰æ²¿ã€‚æˆ‘ä»¬çš„ç ”ç©¶å…´è¶£åŒ…å«ï¼šæ·±åº¦å­¦ä¹ ã€å¼ºåŒ–å­¦ä¹ ã€å›¾å­¦ä¹ ã€æ¢¯åº¦æå‡æ ‘ã€åœ¨çº¿å­¦ä¹ ã€é¢„è®­ç»ƒã€åŠ¨æ€å­¦ä¹ ã€å­¦ä¹ ç†è®ºç­‰ã€‚åŒæ—¶ï¼Œ æˆ‘ä»¬ä¹Ÿåœ¨ç§¯ææ¢ç´¢äººå·¥æ™ºèƒ½åœ¨è‡ªç„¶ç§‘å­¦å’Œäº§ä¸šåº”ç”¨ä¸­çš„ä»·å€¼ï¼Œä»è€Œä¸ºç§‘å­¦å·¥ä½œè€…å’Œä¼ ç»Ÿå·¥ä¸šèµ‹èƒ½ï¼ˆå…·ä½“è§ç ”ç©¶æ¦‚å†µï¼‰ã€‚åœ¨è¿‡å»çš„åå‡ å¹´é—´ï¼Œæˆ‘ä»¬åœ¨é¡¶çº§å›½é™…ä¼šè®®å’ŒæœŸåˆŠä¸Šå‘è¡¨äº†å¤§é‡è¢«é«˜åº¦å¼•ç”¨çš„é«˜è´¨é‡è®ºæ–‡ï¼Œå‘å¾®è½¯çš„äº§å“éƒ¨é—¨è½¬åŒ–äº†å¤§é‡æ ¸å¿ƒæŠ€æœ¯ï¼Œå¹¶å¸®åŠ©ä¼—å¤šçš„ä¼ä¸šåˆä½œä¼™ä¼´å®ç°äº†æ•°å­—åŒ–è½¬å‹ã€‚æˆ‘ä»¬ä¹Ÿå‘å¼€æºç¤¾åŒºè´¡çŒ®äº†å¤§é‡é«˜è´¨é‡å¼€æºå·¥å…·ï¼Œä¾‹å¦‚ LightGBMã€LigthLDAã€å¾®è½¯å›¾å¼•æ“ï¼Œå¤šæ™ºèƒ½ä½“èµ„æºä¼˜åŒ–å¹³å°â€œç¾¤ç­– MAROâ€œï¼Œä¸šå†…é¦–ä¸ªAIé‡åŒ–æŠ•èµ„å¹³å°â€œå¾®çŸ¿Qlibâ€ï¼Œä»¥åŠæœ€æ–°çš„æ—¶ç©ºé¢„æµ‹å¹³å°â€FOSTâ€ã€‚</p>\n<p><strong>å·¥ä½œèŒè´£ï¼š</strong></p>\n<ol>\n<li>å¤ç°å·²æœ‰è®ºæ–‡</li>\n<li>æ”¹è¿›ç°æœ‰ä»£ç ã€æ€§èƒ½ä¼˜åŒ–</li>\n</ol>\n<p>å·¥ä½œæ–¹å‘ï¼ˆé€‰å…¶ä¸€ï¼‰</p>\n<ul>\n<li>åˆ©ç”¨å›¾ç¥ç»ç½‘ç»œç­‰ç›¸å…³æ–¹æ³•è¿›è¡Œåˆ†å­ææ–™è¡¨å¾</li>\n<li>ä½¿ç”¨ç”Ÿæˆæ¨¡å‹ã€å¼ºåŒ–å­¦ä¹ ç­‰æ–¹æ³•å®Œæˆåˆ†å­ææ–™è®¾è®¡</li>\n<li>åˆ©ç”¨ç¥ç»ç½‘ç»œåŠ é€Ÿåå¾®åˆ†æ–¹ç¨‹æ±‚è§£</li>\n<li>åˆ©ç”¨ç¥ç»ç½‘ç»œå®Œæˆç§¯åˆ†æ–¹ç¨‹æ±‚è§£</li>\n<li>åˆ©ç”¨cudaè¯­è¨€åŠ é€Ÿ</li>\n</ul>\n<p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p>\n<ol>\n<li>è®¡ç®—æœºã€ç”µå­ã€åŒ–å­¦ã€ç‰©ç†æˆ–ç›¸å…³ä¸“ä¸šï¼ˆæœ¬ç§‘/ç¡•å£«/åšå£«ï¼‰</li>\n<li>æ‰å®çš„æ•°æ®ç»“æ„/ç®—æ³•åŸºç¡€</li>\n<li>ç†Ÿæ‚‰å¸¸è§çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç†Ÿæ‚‰ä½¿ç”¨PyTorchæˆ–TensorFlowç­‰</li>\n<li>ç†Ÿç»ƒçš„ç¼–ç¨‹èƒ½åŠ›</li>\n<li>å¿«é€Ÿå­¦ä¹ èƒ½åŠ›,è‰¯å¥½çš„æ²Ÿé€šä¸åˆä½œèƒ½åŠ›</li>\n</ol>\n<p>ä¸ƒã€å¼ºåŒ–å­¦ä¹ ç®—æ³•åº”ç”¨å®ä¹ ç”Ÿ</p>\n<ul>\n<li>æ‹›è˜äººæ•°ï¼š 2-4</li>\n</ul>\n<p><strong>ç»„åˆ«ç®€ä»‹ï¼š</strong></p>\n<p>å¾®è½¯äºšæ´²ç ”ç©¶é™¢æœºå™¨å­¦ä¹ é¢†åŸŸä»ç†è®ºã€ç®—æ³•ã€åº”ç”¨ç­‰ä¸åŒå±‚é¢æ¨åŠ¨æœºå™¨å­¦ä¹ çš„å‰æ²¿ã€‚æˆ‘ä»¬çš„ç ”ç©¶å…´è¶£åŒ…å«ï¼šæ·±åº¦å­¦ä¹ ã€å¼ºåŒ–å­¦ä¹ ã€å›¾å­¦ä¹ ã€æ¢¯åº¦æå‡æ ‘ã€åœ¨çº¿å­¦ä¹ ã€é¢„è®­ç»ƒã€åŠ¨æ€å­¦ä¹ ã€å­¦ä¹ ç†è®ºç­‰ã€‚åŒæ—¶ï¼Œ æˆ‘ä»¬ä¹Ÿåœ¨ç§¯ææ¢ç´¢äººå·¥æ™ºèƒ½åœ¨è‡ªç„¶ç§‘å­¦å’Œäº§ä¸šåº”ç”¨ä¸­çš„ä»·å€¼ï¼Œä»è€Œä¸ºç§‘å­¦å·¥ä½œè€…å’Œä¼ ç»Ÿå·¥ä¸šèµ‹èƒ½ï¼ˆå…·ä½“è§ç ”ç©¶æ¦‚å†µï¼‰ã€‚åœ¨è¿‡å»çš„åå‡ å¹´é—´ï¼Œæˆ‘ä»¬åœ¨é¡¶çº§å›½é™…ä¼šè®®å’ŒæœŸåˆŠä¸Šå‘è¡¨äº†å¤§é‡è¢«é«˜åº¦å¼•ç”¨çš„é«˜è´¨é‡è®ºæ–‡ï¼Œå‘å¾®è½¯çš„äº§å“éƒ¨é—¨è½¬åŒ–äº†å¤§é‡æ ¸å¿ƒæŠ€æœ¯ï¼Œå¹¶å¸®åŠ©ä¼—å¤šçš„ä¼ä¸šåˆä½œä¼™ä¼´å®ç°äº†æ•°å­—åŒ–è½¬å‹ã€‚æˆ‘ä»¬ä¹Ÿå‘å¼€æºç¤¾åŒºè´¡çŒ®äº†å¤§é‡é«˜è´¨é‡å¼€æºå·¥å…·ï¼Œä¾‹å¦‚ LightGBMã€LigthLDAã€å¾®è½¯å›¾å¼•æ“ï¼Œå¤šæ™ºèƒ½ä½“èµ„æºä¼˜åŒ–å¹³å°â€œç¾¤ç­– MAROâ€œï¼Œä¸šå†…é¦–ä¸ªAIé‡åŒ–æŠ•èµ„å¹³å°â€œå¾®çŸ¿Qlibâ€ï¼Œä»¥åŠæœ€æ–°çš„æ—¶ç©ºé¢„æµ‹å¹³å°â€FOSTâ€ã€‚</p>\n<p><strong>å·¥ä½œèŒè´£ï¼š</strong></p>\n<ol>\n<li>ç§¯æè·Ÿè¿›å’Œå…³æ³¨å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„å‰æ²¿ç ”ç©¶ï¼›</li>\n<li>å‚ä¸æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç‰¹åˆ«æ˜¯å¼ºåŒ–å­¦ä¹ ç›¸å…³ç®—æ³•çš„ç ”ç©¶ï¼›</li>\n<li>å‚ä¸å¼ºåŒ–å­¦ä¹ ç®—æ³•åœ¨ç‰©æµã€èƒ½æºã€å·¥ä¸šæ§åˆ¶ç­‰é¢†åŸŸçš„è½åœ°åº”ç”¨ã€‚</li>\n</ol>\n<p><strong>ä»»èŒè¦æ±‚ï¼š</strong></p>\n<ol>\n<li>è®¡ç®—æœºæˆ–ç›¸å…³ä¸“ä¸šç¡•å£«æˆ–ä»¥ä¸Šå­¦å†ï¼Œæœ‰è¾ƒå¼ºç¼–ç¨‹èƒ½åŠ›çš„ä¼˜ç§€æœ¬ç§‘ç”Ÿä¹Ÿæ¬¢è¿ç”³è¯·ï¼›</li>\n<li>å…·å¤‡è‰¯å¥½çš„æ•°å­¦åŸºç¡€ï¼Œæœºå™¨å­¦ä¹ çŸ¥è¯†ï¼›</li>\n<li>å…·æœ‰è¾ƒå¼ºçš„ç¼–ç¨‹å®ç°èƒ½åŠ›ï¼Œè‰¯å¥½çš„æ²Ÿé€šèƒ½åŠ›å’Œå›¢é˜Ÿåä½œç²¾ç¥ï¼›</li>\n<li>åŠ åˆ†é¡¹ï¼šæœ‰å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„å¼€å‘å’Œç ”ç©¶ç»å†ï¼›é¡¶çº§AIä¼šè®®æ–‡ç« ï¼›ç†Ÿç»ƒæŒæ¡æ·±åº¦å­¦ä¹ æ¡†æ¶(PyTorch, TensorFlow ç­‰)ï¼›æœ‰å¼€æºè½¯ä»¶å¼€å‘ç»å†ç­‰ã€‚</li>\n</ol>\n",
            "tags": [
                "MSRA",
                "å¾®è½¯äºšæ´²ç ”ç©¶é™¢"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/03/26/ml-dl-juan-ji-shen-jing-wang-luo/",
            "url": "https://www.kitx86.com/2022/03/26/ml-dl-juan-ji-shen-jing-wang-luo/",
            "title": "ML-DL-å·ç§¯ç¥ç»ç½‘ç»œ",
            "date_published": "2022-03-26T07:28:39.000Z",
            "content_html": "<h3 id=\"ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œçš„è¯ç”Ÿ\"><a href=\"#ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œçš„è¯ç”Ÿ\" class=\"headerlink\" title=\"ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œçš„è¯ç”Ÿ\"></a>ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œçš„è¯ç”Ÿ</h3><p>1.å¯¹è¯¥ç±»å‹ç½‘ç»œçš„ç ”ç©¶éƒ½æºäºå…¶ä»–äººçš„ï¼Œä¸€æ ·çš„å†…å®¹å°±ä¸åœ¨è¿‡å¤šçš„èµ˜è¿°ï¼š[å›¾åƒå­¦çš„å†…å®¹ä¸å¤ªæ„Ÿå…´è¶£]</p>\n<p>ä¸»è¦ç”¨é€”ï¼šå¤„ç†å›¾åƒæ•°æ®ã€è¡¨æ ¼æ•°æ®ç­‰ç­‰</p>\n<p><u>ç«èµ›å¯é€‰æ‹©ï¼šå›¾åƒè¯†åˆ«ï¼Œç›®æ ‡æ£€æµ‹-è¾¹ç¼˜æ£€æµ‹ï¼Œè¯­ä¹‰åˆ†å‰²</u></p>\n<p>åœ¨å¯¹ DNN çš„æ¶æ„æ·»åŠ äº† å·ç§¯ layer åå°±æ˜¯ CNN ï¼Œè¿™å°±æ˜¯ CNN çš„ç”±æ¥ï¼Œä½† å·ç§¯çš„æ“ä½œæ–¹å¼æœ‰äº›å¥‡æ€ªçš„è¡Œä¸ºè®©äººå¤§è·Œçœ¼é•œ</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># æ„é€ ä¸€ä¸ªäºŒç»´å·ç§¯å±‚ï¼Œå®ƒå…·æœ‰1ä¸ªè¾“å‡ºé€šé“å’Œå½¢çŠ¶ä¸ºï¼ˆ1ï¼Œ2ï¼‰çš„å·ç§¯æ ¸</span>\n\n<span class=\"token comment\"># äºŒç»´å·ç§¯æ ¸ å‚æ•°å½¢å¼ (æ‰¹é‡å¤§å°ï¼Œé€šé“ï¼Œé«˜åº¦ï¼Œå®½åº¦)</span>\nconv2d <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Conv2d<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> bias<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç‰¹æ€§ï¼šç©ºé—´ä¸å˜æ€§</p>\n<ol>\n<li><em>å¹³ç§»ä¸å˜æ€§</em>ï¼ˆtranslation invarianceï¼‰ï¼šä¸ç®¡æ£€æµ‹å¯¹è±¡å‡ºç°åœ¨å›¾åƒä¸­çš„å“ªä¸ªä½ç½®ï¼Œç¥ç»ç½‘ç»œçš„å‰é¢å‡ å±‚åº”è¯¥å¯¹ç›¸åŒçš„å›¾åƒåŒºåŸŸå…·æœ‰ç›¸ä¼¼çš„ååº”ï¼Œå³ä¸ºâ€œå¹³ç§»ä¸å˜æ€§â€ã€‚</li>\n<li><em>å±€éƒ¨æ€§</em>ï¼ˆlocalityï¼‰ï¼šç¥ç»ç½‘ç»œçš„å‰é¢å‡ å±‚åº”è¯¥åªæ¢ç´¢è¾“å…¥å›¾åƒä¸­çš„å±€éƒ¨åŒºåŸŸï¼Œè€Œä¸è¿‡åº¦åœ¨æ„å›¾åƒä¸­ç›¸éš”è¾ƒè¿œåŒºåŸŸçš„å…³ç³»ï¼Œè¿™å°±æ˜¯â€œå±€éƒ¨æ€§â€åŸåˆ™ã€‚æœ€ç»ˆï¼Œå¯ä»¥èšåˆè¿™äº›å±€éƒ¨ç‰¹å¾ï¼Œä»¥åœ¨æ•´ä¸ªå›¾åƒçº§åˆ«è¿›è¡Œé¢„æµ‹ã€‚</li>\n</ol>\n<p>è¾“å‡ºçš„å·ç§¯å±‚ &gt; ç‰¹å¾æ˜ å°„</p>\n<p>æ„Ÿå—é‡ï¼šæŒ‡å‰å‘ä¼ æ’­ä¸­å¯èƒ½å½±å“ x è®¡ç®—çš„æ‰€æœ‰å…ƒç´ </p>\n<p>2ã€å·ç§¯ç¥ç»ç½‘ç»œä¹‹LeNet</p>\n<p>LeNetï¼ˆLeNet-5ï¼‰ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>\n<ul>\n<li>å·ç§¯ç¼–ç å™¨ï¼šç”±ä¸¤ä¸ªå·ç§¯å±‚ç»„æˆ;</li>\n<li>å…¨è¿æ¥å±‚å¯†é›†å—ï¼šç”±ä¸‰ä¸ªå…¨è¿æ¥å±‚ç»„æˆã€‚</li>\n</ul>\n<p><img src=\"/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/lenet.svg\" alt=\"lenet\"></p>\n<h4 id=\"å°ç»“\"><a href=\"#å°ç»“\" class=\"headerlink\" title=\"å°ç»“\"></a>å°ç»“</h4><ul>\n<li>å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æ˜¯ä¸€ç±»ä½¿ç”¨å·ç§¯å±‚çš„ç½‘ç»œã€‚</li>\n<li>åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬ç»„åˆä½¿ç”¨å·ç§¯å±‚ã€éçº¿æ€§æ¿€æ´»å‡½æ•°å’Œæ±‡èšå±‚ã€‚</li>\n<li>ä¸ºäº†æ„é€ é«˜æ€§èƒ½çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬é€šå¸¸å¯¹å·ç§¯å±‚è¿›è¡Œæ’åˆ—ï¼Œé€æ¸é™ä½å…¶è¡¨ç¤ºçš„ç©ºé—´åˆ†è¾¨ç‡ï¼ŒåŒæ—¶å¢åŠ é€šé“æ•°ã€‚</li>\n<li>åœ¨ä¼ ç»Ÿçš„å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œå·ç§¯å—ç¼–ç å¾—åˆ°çš„è¡¨å¾åœ¨è¾“å‡ºä¹‹å‰éœ€ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå…¨è¿æ¥å±‚è¿›è¡Œå¤„ç†ã€‚</li>\n<li>LeNetæ˜¯æœ€æ—©å‘å¸ƒçš„å·ç§¯ç¥ç»ç½‘ç»œä¹‹ä¸€ã€‚</li>\n</ul>\n<h4 id=\"è€ƒæŸ¥\"><a href=\"#è€ƒæŸ¥\" class=\"headerlink\" title=\"è€ƒæŸ¥\"></a>è€ƒæŸ¥</h4><ol>\n<li><p>å°†å¹³å‡æ±‡èšå±‚æ›¿æ¢ä¸ºæœ€å¤§æ±‡èšå±‚ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n</li>\n<li><p>å°è¯•æ„å»ºä¸€ä¸ªåŸºäºLeNetçš„æ›´å¤æ‚çš„ç½‘ç»œï¼Œä»¥æé«˜å…¶å‡†ç¡®æ€§ã€‚</p>\n<ol>\n<li>è°ƒæ•´å·ç§¯çª—å£å¤§å°ã€‚</li>\n<li>è°ƒæ•´è¾“å‡ºé€šé“çš„æ•°é‡ã€‚</li>\n<li>è°ƒæ•´æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ReLUï¼‰ã€‚</li>\n<li>è°ƒæ•´å·ç§¯å±‚çš„æ•°é‡ã€‚</li>\n<li>è°ƒæ•´å…¨è¿æ¥å±‚çš„æ•°é‡ã€‚</li>\n<li>è°ƒæ•´å­¦ä¹ ç‡å’Œå…¶ä»–è®­ç»ƒç»†èŠ‚ï¼ˆä¾‹å¦‚ï¼Œåˆå§‹åŒ–å’Œè½®æ•°ï¼‰ã€‚</li>\n</ol>\n</li>\n<li><p>åœ¨MNISTæ•°æ®é›†ä¸Šå°è¯•ä»¥ä¸Šæ”¹è¿›çš„ç½‘ç»œã€‚</p>\n</li>\n<li><p>æ˜¾ç¤ºä¸åŒè¾“å…¥ï¼ˆä¾‹å¦‚æ¯›è¡£å’Œå¤–å¥—ï¼‰æ—¶ï¼ŒLeNetç¬¬ä¸€å±‚å’Œç¬¬äºŒå±‚çš„æ¿€æ´»å€¼ã€‚</p>\n</li>\n</ol>\n<h2 id=\"äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ\"><a href=\"#äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ\" class=\"headerlink\" title=\"äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ\"></a>äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ</h2><h3 id=\"1ã€AlexNet\"><a href=\"#1ã€AlexNet\" class=\"headerlink\" title=\"1ã€AlexNet\"></a>1ã€AlexNet</h3><ul>\n<li><p>AlexNetã€‚å®ƒæ˜¯ç¬¬ä¸€ä¸ªåœ¨å¤§è§„æ¨¡è§†è§‰ç«èµ›ä¸­å‡»è´¥ä¼ ç»Ÿè®¡ç®—æœºè§†è§‰æ¨¡å‹çš„å¤§å‹ç¥ç»ç½‘ç»œï¼›</p>\n</li>\n<li><p>ä½¿ç”¨é‡å¤å—çš„ç½‘ç»œï¼ˆVGGï¼‰ã€‚å®ƒåˆ©ç”¨è®¸å¤šé‡å¤çš„ç¥ç»ç½‘ç»œå—ï¼›</p>\n</li>\n<li><p>ç½‘ç»œä¸­çš„ç½‘ç»œï¼ˆNiNï¼‰ã€‚å®ƒé‡å¤ä½¿ç”¨ç”±å·ç§¯å±‚å’Œ1Ã—1å·ç§¯å±‚ï¼ˆç”¨æ¥ä»£æ›¿å…¨è¿æ¥å±‚ï¼‰æ¥æ„å»ºæ·±å±‚ç½‘ç»œ;</p>\n</li>\n<li><p>å«å¹¶è¡Œè¿ç»“çš„ç½‘ç»œï¼ˆGoogLeNetï¼‰ã€‚å®ƒä½¿ç”¨å¹¶è¡Œè¿ç»“çš„ç½‘ç»œï¼Œé€šè¿‡ä¸åŒçª—å£å¤§å°çš„å·ç§¯å±‚å’Œæœ€å¤§æ±‡èšå±‚æ¥å¹¶è¡ŒæŠ½å–ä¿¡æ¯ï¼›</p>\n</li>\n<li><p>æ®‹å·®ç½‘ç»œï¼ˆResNetï¼‰ã€‚å®ƒé€šè¿‡æ®‹å·®å—æ„å»ºè·¨å±‚çš„æ•°æ®é€šé“ï¼Œæ˜¯è®¡ç®—æœºè§†è§‰ä¸­æœ€æµè¡Œçš„ä½“ç³»æ¶æ„ï¼›</p>\n</li>\n<li><p>ç¨ å¯†è¿æ¥ç½‘ç»œï¼ˆDenseNetï¼‰ã€‚å®ƒçš„è®¡ç®—æˆæœ¬å¾ˆé«˜ï¼Œä½†ç»™æˆ‘ä»¬å¸¦æ¥äº†æ›´å¥½çš„æ•ˆæœã€‚</p>\n</li>\n</ul>\n<p>å­¦ä¹ è¡¨å¾è§‚æ‘©å›¾</p>\n<p><img src=\"/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/filters.png\" alt=\"filters\"></p>\n<p><img src=\"/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/alexnet.svg\" alt=\"alexnet\"></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> torch\n<span class=\"token keyword\">from</span> torch <span class=\"token keyword\">import</span> nn\n<span class=\"token keyword\">from</span> d2l <span class=\"token keyword\">import</span> torch <span class=\"token keyword\">as</span> d2l\n\nnet <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span>\n    <span class=\"token comment\"># è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª11*11çš„æ›´å¤§çª—å£æ¥æ•æ‰å¯¹è±¡ã€‚</span>\n    <span class=\"token comment\"># åŒæ—¶ï¼Œæ­¥å¹…ä¸º4ï¼Œä»¥å‡å°‘è¾“å‡ºçš„é«˜åº¦å’Œå®½åº¦ã€‚</span>\n    <span class=\"token comment\"># å¦å¤–ï¼Œè¾“å‡ºé€šé“çš„æ•°ç›®è¿œå¤§äºLeNet</span>\n    nn<span class=\"token punctuation\">.</span>Conv2d<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">96</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> stride<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nn<span class=\"token punctuation\">.</span>ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nn<span class=\"token punctuation\">.</span>MaxPool2d<span class=\"token punctuation\">(</span>kernel_size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> stride<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># å‡å°å·ç§¯çª—å£ï¼Œä½¿ç”¨å¡«å……ä¸º2æ¥ä½¿å¾—è¾“å…¥ä¸è¾“å‡ºçš„é«˜å’Œå®½ä¸€è‡´ï¼Œä¸”å¢å¤§è¾“å‡ºé€šé“æ•°</span>\n    nn<span class=\"token punctuation\">.</span>Conv2d<span class=\"token punctuation\">(</span><span class=\"token number\">96</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nn<span class=\"token punctuation\">.</span>ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nn<span class=\"token punctuation\">.</span>MaxPool2d<span class=\"token punctuation\">(</span>kernel_size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> stride<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># ä½¿ç”¨ä¸‰ä¸ªè¿ç»­çš„å·ç§¯å±‚å’Œè¾ƒå°çš„å·ç§¯çª—å£ã€‚</span>\n    <span class=\"token comment\"># é™¤äº†æœ€åçš„å·ç§¯å±‚ï¼Œè¾“å‡ºé€šé“çš„æ•°é‡è¿›ä¸€æ­¥å¢åŠ ã€‚</span>\n    <span class=\"token comment\"># åœ¨å‰ä¸¤ä¸ªå·ç§¯å±‚ä¹‹åï¼Œæ±‡èšå±‚ä¸ç”¨äºå‡å°‘è¾“å…¥çš„é«˜åº¦å’Œå®½åº¦</span>\n    nn<span class=\"token punctuation\">.</span>Conv2d<span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">,</span> <span class=\"token number\">384</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nn<span class=\"token punctuation\">.</span>ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nn<span class=\"token punctuation\">.</span>Conv2d<span class=\"token punctuation\">(</span><span class=\"token number\">384</span><span class=\"token punctuation\">,</span> <span class=\"token number\">384</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nn<span class=\"token punctuation\">.</span>ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nn<span class=\"token punctuation\">.</span>Conv2d<span class=\"token punctuation\">(</span><span class=\"token number\">384</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nn<span class=\"token punctuation\">.</span>ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nn<span class=\"token punctuation\">.</span>MaxPool2d<span class=\"token punctuation\">(</span>kernel_size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> stride<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nn<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># è¿™é‡Œï¼Œå…¨è¿æ¥å±‚çš„è¾“å‡ºæ•°é‡æ˜¯LeNetä¸­çš„å¥½å‡ å€ã€‚ä½¿ç”¨dropoutå±‚æ¥å‡è½»è¿‡æ‹Ÿåˆ</span>\n    nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">6400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4096</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nn<span class=\"token punctuation\">.</span>ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nn<span class=\"token punctuation\">.</span>Dropout<span class=\"token punctuation\">(</span>p<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">4096</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4096</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nn<span class=\"token punctuation\">.</span>ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nn<span class=\"token punctuation\">.</span>Dropout<span class=\"token punctuation\">(</span>p<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># æœ€åæ˜¯è¾“å‡ºå±‚ã€‚ç”±äºè¿™é‡Œä½¿ç”¨Fashion-MNISTï¼Œæ‰€ä»¥ç”¨ç±»åˆ«æ•°ä¸º10ï¼Œè€Œéè®ºæ–‡ä¸­çš„1000</span>\n    nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">4096</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è§‚å¯Ÿç½‘ç»œæ¯ä¸€å±‚è¾“å‡ºæ¶æ„</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">X <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>randn<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">224</span><span class=\"token punctuation\">,</span> <span class=\"token number\">224</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> layer <span class=\"token keyword\">in</span> net<span class=\"token punctuation\">:</span>\n    X<span class=\"token operator\">=</span>layer<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>layer<span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__name__<span class=\"token punctuation\">,</span><span class=\"token string\">'output shape:\\t'</span><span class=\"token punctuation\">,</span>X<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-markdown\" data-language=\"markdown\"><code class=\"language-markdown\">Conv2d output shape:\t torch.Size([1, 96, 54, 54])\nReLU output shape:\t torch.Size([1, 96, 54, 54])\nMaxPool2d output shape:\t torch.Size([1, 96, 26, 26])\nConv2d output shape:\t torch.Size([1, 256, 26, 26])\nReLU output shape:\t torch.Size([1, 256, 26, 26])\nMaxPool2d output shape:\t torch.Size([1, 256, 12, 12])\nConv2d output shape:\t torch.Size([1, 384, 12, 12])\nReLU output shape:\t torch.Size([1, 384, 12, 12])\nConv2d output shape:\t torch.Size([1, 384, 12, 12])\nReLU output shape:\t torch.Size([1, 384, 12, 12])\nConv2d output shape:\t torch.Size([1, 256, 12, 12])\nReLU output shape:\t torch.Size([1, 256, 12, 12])\nMaxPool2d output shape:\t torch.Size([1, 256, 5, 5])\nFlatten output shape:\t torch.Size([1, 6400])\nLinear output shape:\t torch.Size([1, 4096])\nReLU output shape:\t torch.Size([1, 4096])\nDropout output shape:\t torch.Size([1, 4096])\nLinear output shape:\t torch.Size([1, 4096])\nReLU output shape:\t torch.Size([1, 4096])\nDropout output shape:\t torch.Size([1, 4096])\nLinear output shape:\t torch.Size([1, 10])<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<p>ä½¿ç”¨æ›´å°çš„å­¦ä¹ é€Ÿç‡è®­ç»ƒï¼Œè¿™æ˜¯å› ä¸ºç½‘ç»œæ›´æ·±æ›´å¹¿ã€å›¾åƒåˆ†è¾¨ç‡æ›´é«˜ï¼Œè®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œå°±æ›´æ˜‚è´µã€‚</p>\n<h4 id=\"å°ç»“-1\"><a href=\"#å°ç»“-1\" class=\"headerlink\" title=\"å°ç»“\"></a>å°ç»“</h4><ul>\n<li>AlexNetçš„æ¶æ„ä¸LeNetç›¸ä¼¼ï¼Œä½†ä½¿ç”¨äº†æ›´å¤šçš„å·ç§¯å±‚å’Œæ›´å¤šçš„å‚æ•°æ¥æ‹Ÿåˆå¤§è§„æ¨¡çš„ImageNetæ•°æ®é›†ã€‚</li>\n<li>ä»Šå¤©ï¼ŒAlexNetå·²ç»è¢«æ›´æœ‰æ•ˆçš„æ¶æ„æ‰€è¶…è¶Šï¼Œä½†å®ƒæ˜¯ä»æµ…å±‚ç½‘ç»œåˆ°æ·±å±‚ç½‘ç»œçš„å…³é”®ä¸€æ­¥ã€‚</li>\n<li>å°½ç®¡AlexNetçš„ä»£ç åªæ¯”LeNetå¤šå‡ºå‡ è¡Œï¼Œä½†å­¦æœ¯ç•ŒèŠ±äº†å¾ˆå¤šå¹´æ‰æ¥å—æ·±åº¦å­¦ä¹ è¿™ä¸€æ¦‚å¿µï¼Œå¹¶åº”ç”¨å…¶å‡ºè‰²çš„å®éªŒç»“æœã€‚è¿™ä¹Ÿæ˜¯ç”±äºç¼ºä¹æœ‰æ•ˆçš„è®¡ç®—å·¥å…·ã€‚</li>\n<li>Dropoutã€ReLUå’Œé¢„å¤„ç†æ˜¯æå‡è®¡ç®—æœºè§†è§‰ä»»åŠ¡æ€§èƒ½çš„å…¶ä»–å…³é”®æ­¥éª¤ã€‚</li>\n</ul>\n<h4 id=\"ç»ƒä¹ \"><a href=\"#ç»ƒä¹ \" class=\"headerlink\" title=\"ç»ƒä¹ \"></a>ç»ƒä¹ </h4><ol>\n<li>è¯•ç€å¢åŠ è¿­ä»£è½®æ•°ã€‚å¯¹æ¯”LeNetçš„ç»“æœæœ‰ä»€ä¹ˆä¸åŒï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>\n<li>AlexNetå¯¹äºFashion-MNISTæ•°æ®é›†æ¥è¯´å¯èƒ½å¤ªå¤æ‚äº†ã€‚<ol>\n<li>å°è¯•ç®€åŒ–æ¨¡å‹ä»¥åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼ŒåŒæ—¶ç¡®ä¿å‡†ç¡®æ€§ä¸ä¼šæ˜¾è‘—ä¸‹é™ã€‚</li>\n<li>è®¾è®¡ä¸€ä¸ªæ›´å¥½çš„æ¨¡å‹ï¼Œå¯ä»¥ç›´æ¥åœ¨28Ã—28å›¾åƒä¸Šå·¥ä½œã€‚</li>\n</ol>\n</li>\n<li>ä¿®æ”¹æ‰¹é‡å¤§å°ï¼Œå¹¶è§‚å¯Ÿæ¨¡å‹ç²¾åº¦å’ŒGPUæ˜¾å­˜å˜åŒ–ã€‚</li>\n<li>åˆ†æäº†AlexNetçš„è®¡ç®—æ€§èƒ½ã€‚<ol>\n<li>åœ¨AlexNetä¸­ä¸»è¦æ˜¯å“ªéƒ¨åˆ†å ç”¨æ˜¾å­˜ï¼Ÿ</li>\n<li>åœ¨AlexNetä¸­ä¸»è¦æ˜¯å“ªéƒ¨åˆ†éœ€è¦æ›´å¤šçš„è®¡ç®—ï¼Ÿ</li>\n<li>è®¡ç®—ç»“æœæ—¶æ˜¾å­˜å¸¦å®½å¦‚ä½•ï¼Ÿ</li>\n</ol>\n</li>\n<li>å°†dropoutå’ŒReLUåº”ç”¨äºLeNet-5ï¼Œæ•ˆæœæœ‰æå‡å—ï¼Ÿå†è¯•è¯•é¢„å¤„ç†ä¼šæ€ä¹ˆæ ·ï¼Ÿ</li>\n</ol>\n<h3 id=\"2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š-VGG-å’ŒAlexNet-æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«\"><a href=\"#2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š-VGG-å’ŒAlexNet-æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«\" class=\"headerlink\" title=\"2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š VGG (å’ŒAlexNet æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«)\"></a>2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š VGG (å’ŒAlexNet æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«)</h3><p><img src=\"/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/vgg.svg\" alt=\"vgg\"></p>\n<h4 id=\"å°ç»“-2\"><a href=\"#å°ç»“-2\" class=\"headerlink\" title=\"å°ç»“\"></a>å°ç»“</h4><ul>\n<li>VGG-11ä½¿ç”¨å¯å¤ç”¨çš„å·ç§¯å—æ„é€ ç½‘ç»œã€‚ä¸åŒçš„VGGæ¨¡å‹å¯é€šè¿‡æ¯ä¸ªå—ä¸­å·ç§¯å±‚æ•°é‡å’Œè¾“å‡ºé€šé“æ•°é‡çš„å·®å¼‚æ¥å®šä¹‰ã€‚</li>\n<li>å—çš„ä½¿ç”¨å¯¼è‡´ç½‘ç»œå®šä¹‰çš„éå¸¸ç®€æ´ã€‚ä½¿ç”¨å—å¯ä»¥æœ‰æ•ˆåœ°è®¾è®¡å¤æ‚çš„ç½‘ç»œã€‚</li>\n<li>åœ¨VGGè®ºæ–‡ä¸­ï¼ŒSimonyanå’ŒZisermanå°è¯•äº†å„ç§æ¶æ„ã€‚ç‰¹åˆ«æ˜¯ä»–ä»¬å‘ç°æ·±å±‚ä¸”çª„çš„å·ç§¯ï¼ˆå³3Ã—3ï¼‰æ¯”è¾ƒæµ…å±‚ä¸”å®½çš„å·ç§¯æ›´æœ‰æ•ˆã€‚</li>\n</ul>\n<h4 id=\"3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ-NiN\"><a href=\"#3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ-NiN\" class=\"headerlink\" title=\"3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ - NiN\"></a>3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ - NiN</h4>",
            "tags": [
                "CNN",
                "å·ç§¯ç¥ç»ç½‘ç»œ"
            ]
        },
        {
            "id": "https://www.kitx86.com/2022/03/25/ml-dl-zhen-ming-ji-jiu/",
            "url": "https://www.kitx86.com/2022/03/25/ml-dl-zhen-ming-ji-jiu/",
            "title": "Ml-Dl-æœ•å‘½æ€¥æ•‘",
            "date_published": "2022-03-25T10:35:26.000Z",
            "content_html": "<h4 id=\"ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿\"><a href=\"#ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿\" class=\"headerlink\" title=\"ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿\"></a>ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿</h4><h5 id=\"1ã€å¯¼å…¥å¸¸è§åº“\"><a href=\"#1ã€å¯¼å…¥å¸¸è§åº“\" class=\"headerlink\" title=\"1ã€å¯¼å…¥å¸¸è§åº“\"></a>1ã€å¯¼å…¥å¸¸è§åº“</h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np  <span class=\"token comment\"># Linear algebra</span>\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd <span class=\"token comment\"># data processing, CSV file I/O</span>\n\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å›¾åƒæ•°æ®å¤„ç†éƒ¨åˆ†â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n<span class=\"token comment\"># å†…åµŒç»˜å›¾ï¼Œå¯ä»¥çœç•¥ plt.show()</span>\n<span class=\"token operator\">%</span>matplotlib inline \n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt  \n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>image <span class=\"token keyword\">as</span> mpimg\n\n<span class=\"token keyword\">import</span> seaborn <span class=\"token keyword\">as</span> sns\nplt<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>use<span class=\"token punctuation\">(</span><span class=\"token string\">'seaborn'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># æ˜¾ç¤ºé£æ ¼</span>\nsns<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>style<span class=\"token operator\">=</span><span class=\"token string\">'white'</span><span class=\"token punctuation\">,</span> context<span class=\"token operator\">=</span><span class=\"token string\">'notebook'</span><span class=\"token punctuation\">,</span> palette<span class=\"token operator\">=</span><span class=\"token string\">'deep'</span><span class=\"token punctuation\">)</span>\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”è¯­è¨€tokenå¤„ç†éƒ¨åˆ†â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n<span class=\"token keyword\">from</span> wordcloud <span class=\"token keyword\">import</span> WordCloud<span class=\"token punctuation\">,</span> STOPWORDS\n\n â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¯æ·»åŠ è¡¥å……â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”    \n<span class=\"token keyword\">from</span> IPython<span class=\"token punctuation\">.</span>core<span class=\"token punctuation\">.</span>interactiveshell <span class=\"token keyword\">import</span> InteractiveShell <span class=\"token comment\"># idk</span>\nInteractiveShell<span class=\"token punctuation\">.</span>ast_node_interactivity <span class=\"token operator\">=</span> <span class=\"token string\">\"all\"</span> <span class=\"token comment\"># idk</span>\nplt<span class=\"token punctuation\">.</span>rcParams<span class=\"token punctuation\">[</span><span class=\"token string\">'figure.figsize'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span>\nplt<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>use<span class=\"token punctuation\">(</span><span class=\"token string\">'fivethirtyeight'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># ç§‘å­¦è®¡ç®—ç”¨çš„åº“ï¼ŒåŒ…å«å¾ˆå¤šæ•°å­¦å’Œç®—æ³•çš„å®ä¾‹ï¼Œåæ§½~å“ªæœ‰è¿™ä¹ˆå¤šç§‘å­¦è®¡ç®—åº“</span>\n<span class=\"token keyword\">from</span> scipy <span class=\"token keyword\">import</span> stats \n\n<span class=\"token comment\"># æ•°æ®é›†ç¯å¢ƒ</span>\n<span class=\"token keyword\">for</span> dirname<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">,</span> filenames <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>walk<span class=\"token punctuation\">(</span><span class=\"token string\">'/kaggle/input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> filenmae <span class=\"token keyword\">in</span> filenames<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>dirname<span class=\"token punctuation\">,</span> filename<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n              \n<span class=\"token keyword\">def</span> <span class=\"token function\">highlight_max</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> props <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> np<span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">(</span>s <span class=\"token operator\">==</span> np<span class=\"token punctuation\">.</span>nanmax<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># idk</span>\n\n\n\n<span class=\"token comment\"># è¾…åŠ©å·¥å…·</span>\n <span class=\"token comment\"># è¿­ä»£è¿›åº¦æ¡ï¼Œåªæ˜¯ä¸ºäº†å¥½çœ‹</span>\n<span class=\"token keyword\">from</span> tqdm <span class=\"token keyword\">import</span> tqdm \n<span class=\"token comment\"># çœ‹èµ·æ¥æœ‰ç‚¹è€çš„æ ·å­</span>\n<span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image \n\n        \nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n<span class=\"token comment\"># ç³»ç»Ÿå±€éƒ¨ç¯å¢ƒ</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">from</span> pathlib <span class=\"token keyword\">import</span> Path\n<span class=\"token comment\"># åƒåœ¾å›æ”¶æœºåˆ¶</span>\n<span class=\"token keyword\">import</span> gc \n\n<span class=\"token comment\"># å»ºç«‹æ·±åº¦æ¨¡å‹æ‰€éœ€è¦çš„</span>\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> Sequential \n<span class=\"token keyword\">from</span> keras <span class=\"token keyword\">import</span>  backend <span class=\"token keyword\">as</span> K <span class=\"token comment\"># idk</span>\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å›¾åƒéƒ¨åˆ†æ¨¡å‹å±‚çš„ç®€æ˜“è§£é‡Šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n<span class=\"token comment\"># Conv2D : äºŒç»´å·ç§¯å±‚ï¼Œäº’ç›¸å…³è¿ç®—ï¼Œå¯ä½¿ç”¨å¡«å……ã€æ­¥å¹…å’Œå¤šé€šé“è¾“å…¥/è¾“å‡º</span>\n<span class=\"token comment\"># Dense : ç¨ å¯†å±‚</span>\n<span class=\"token comment\"># Dropout : ä¸¢å¼ƒå±‚</span>\n<span class=\"token comment\"># pool2d : 2ç»´æ±‡èšå±‚ï¼Œå¯¹æ±‡èšçª—å£æ‰€æœ‰å…ƒç´ è®¡ç®—æœ€å¤§å€¼æˆ–å¹³å‡å€¼ï¼Œå¯ä½¿ç”¨å¡«å……ã€æ­¥å¹…å’Œå¤šé€šé“è¾“å…¥/è¾“å‡º</span>\n<span class=\"token comment\"># Flatten : å¹³æ»‘å±‚</span>\n<span class=\"token comment\"># MaxPool2D : äºŒç»´æ±‡èšè®¡ç®—æœ€å¤§å€¼</span>\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>layers <span class=\"token keyword\">import</span> Dense <span class=\"token punctuation\">,</span> Dropout <span class=\"token punctuation\">,</span> Lambda<span class=\"token punctuation\">,</span> Flatten Conv2D<span class=\"token punctuation\">,</span> MaxPool2D \n\n<span class=\"token comment\"># ä¼˜åŒ–å‡½æ•° rmsprop_v2 , adam_v2</span>\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>optimizers <span class=\"token keyword\">import</span> Adam <span class=\"token punctuation\">,</span>RMSprop\n<span class=\"token comment\"># è®­ç»ƒã€éªŒè¯æ•°æ®åˆ†ç¦»</span>\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> train_test_split \n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> confusion_matrix <span class=\"token comment\"># idk</span>\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>preprocessing<span class=\"token punctuation\">.</span>image <span class=\"token keyword\">import</span> ImageDataGenerator <span class=\"token comment\"># idk</span>\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”è¯­è¨€æ¨¡å‹çš„éƒ¨åˆ†è§£é‡Šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> LabelEncoder <span class=\"token comment\"># idk</span>\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> StratifiedKFold <span class=\"token comment\"># idk</span>\n\n<span class=\"token keyword\">from</span> transformers <span class=\"token keyword\">import</span> AutoTokenizer<span class=\"token punctuation\">,</span> AutoConfig<span class=\"token punctuation\">,</span> AutoModel<span class=\"token punctuation\">,</span> get_linear_schedule_with_warmup \n\n<span class=\"token keyword\">from</span> torch<span class=\"token punctuation\">.</span>optim <span class=\"token keyword\">import</span> AdamW\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>callbacks <span class=\"token keyword\">import</span> ReduceLROnPlateau <span class=\"token comment\"># idk</span>\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¿½ç•¥åŒ…ç¯å¢ƒçš„è­¦å‘Šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n<span class=\"token keyword\">import</span> warnings\nwarnings<span class=\"token punctuation\">.</span>filterwarnings<span class=\"token punctuation\">(</span><span class=\"token string\">'ignore'</span><span class=\"token punctuation\">)</span>\n\ndevice <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>device<span class=\"token punctuation\">(</span><span class=\"token string\">'cuda'</span> <span class=\"token keyword\">if</span> torch<span class=\"token punctuation\">.</span>cuda<span class=\"token punctuation\">.</span>is_available<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">else</span> <span class=\"token string\">'cpu'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>2ã€æ£€æŸ¥ç¯å¢ƒçŠ¶å†µ</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> subprocess <span class=\"token keyword\">import</span> check_output\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>check_output<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"ls\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"../input\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">\"utf8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"äºŒã€æ£€æŸ¥æ•°æ®\"><a href=\"#äºŒã€æ£€æŸ¥æ•°æ®\" class=\"headerlink\" title=\"äºŒã€æ£€æŸ¥æ•°æ®\"></a>äºŒã€æ£€æŸ¥æ•°æ®</h4><h5 id=\"1ã€åŠ è½½æä¾›çš„æ•°æ®\"><a href=\"#1ã€åŠ è½½æä¾›çš„æ•°æ®\" class=\"headerlink\" title=\"1ã€åŠ è½½æä¾›çš„æ•°æ®\"></a>1ã€åŠ è½½æä¾›çš„æ•°æ®</h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">train <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'../input/train.csv'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># è¯»å…¥è®­ç»ƒæ•°æ®</span>\ntest <span class=\"token operator\">=</span> pd <span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'../input/test.csv'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># è¯»å…¥æµ‹è¯•æ•°æ®</span>\n\ntrain<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># æŸ¥çœ‹å‰é¢5è¡Œçš„ä¿¡æ¯</span>\ntrain<span class=\"token punctuation\">.</span>shape <span class=\"token comment\"># è¿”å›æ•´ä½“ data çš„ çš„ä¿¡æ¯</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Shape Dtrain:</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>train<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Shape Dtest: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>test<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span> <span class=\"token operator\">*</span> <span class=\"token string\">'#'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Unique elements per column\"</span><span class=\"token punctuation\">)</span>\ntrain<span class=\"token punctuation\">.</span>nunique<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Missing Value?\"</span><span class=\"token punctuation\">)</span>\ntrain<span class=\"token punctuation\">.</span>isnull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å›¾åƒæ•°æ®å¤„ç†æ–¹æ³•â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nX_train <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>train<span class=\"token punctuation\">.</span>iloc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float32'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># å½¢æˆarrayæ•°ç»„ </span>\ny_train <span class=\"token operator\">=</span> train<span class=\"token punctuation\">.</span>iloc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'int32'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 28*28 çš„å€¼</span>\nX_test <span class=\"token operator\">=</span> test<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float32'</span><span class=\"token punctuation\">)</span>\n\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” æŠ€å·§ <span class=\"token punctuation\">(</span>tricks<span class=\"token punctuation\">)</span> â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n<span class=\"token comment\"># ä¸€äº›æŠ€å·§ - tricks</span>\n<span class=\"token keyword\">del</span> train <span class=\"token comment\"># can free some space ?</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"2ã€æ•°æ®å¯è§†åŒ–\"><a href=\"#2ã€æ•°æ®å¯è§†åŒ–\" class=\"headerlink\" title=\"2ã€æ•°æ®å¯è§†åŒ–\"></a>2ã€æ•°æ®å¯è§†åŒ–</h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># method 1</span>\nX_train <span class=\"token operator\">=</span> X_train<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># è½¬å˜æ•°æ®ä¸ºå›¾ç‰‡ï¼Œé‡æ–°ç»„ç»‡å½¢çŠ¶</span>\n\n<span class=\"token comment\"># method 2 : Reshape image in 3 dimensions (height = 28px, width = 28px , canal = 1)</span>\nX_train <span class=\"token operator\">=</span> X_train<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ntest <span class=\"token operator\">=</span> test<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nY_train <span class=\"token operator\">=</span> train<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># åªå–å€¼çš„é‚£ä¸€åˆ—æ ‡ç­¾</span>\nX_train <span class=\"token operator\">=</span> train<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span>labels <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># ä¸è¦å€¼çš„é‚£ä¸€åˆ—ä½œä¸ºè®­ç»ƒæ•°æ®</span>\ncount <span class=\"token operator\">=</span> sns<span class=\"token punctuation\">.</span>countplot<span class=\"token punctuation\">(</span>Y_train<span class=\"token punctuation\">)</span> <span class=\"token comment\"># è®¡ç®— 1-10 çš„æ•°é‡</span>\nY_train<span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># æŸ±çŠ¶å›¾æ˜¾ç¤º 1 - 10 çš„æ•°é‡</span>\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n\ntop <span class=\"token operator\">=</span> Counter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>anc <span class=\"token keyword\">for</span> anc <span class=\"token keyword\">in</span> train<span class=\"token punctuation\">[</span><span class=\"token string\">'anchor'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># Counter è®¡æ•°æ ‡ç­¾'anchor'</span>\ntop <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>top<span class=\"token punctuation\">.</span>most_common<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># å–å¾—å‰é¢ 50 ä¸ª</span>\n\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># ç»˜åˆ¶å›¾è¡¨å°ºå¯¸</span>\n\nsns<span class=\"token punctuation\">.</span>barplot<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>top<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>top<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> palette <span class=\"token operator\">=</span> <span class=\"token string\">'hls'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># è°ƒè‰²æ¿ä¸º hls</span>\nplt<span class=\"token punctuation\">.</span>xticks<span class=\"token punctuation\">(</span>rotation <span class=\"token operator\">=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># x è½´æ ‡ç­¾å¯ä»¥åšå‡ºä¸€äº›è°ƒæ•´</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">\"Top 50 First Phrases (Anchor)\"</span><span class=\"token punctuation\">,</span> fontsize <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404083846939.png\"></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fig<span class=\"token punctuation\">,</span> ax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>subplots<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> figsize <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ntext_len <span class=\"token operator\">=</span> train<span class=\"token punctuation\">[</span><span class=\"token string\">'anchor'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x <span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nsns<span class=\"token punctuation\">.</span>countplot<span class=\"token punctuation\">(</span>text_len<span class=\"token punctuation\">,</span> ax <span class=\"token operator\">=</span> ax<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nax<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>set_title<span class=\"token punctuation\">(</span><span class=\"token string\">'Word Count Distribution'</span><span class=\"token punctuation\">,</span>size <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># è¿™è¿˜è¦å–è®¾ç½®å¤§å°ï¼Ÿ</span>\n\navg_word_len <span class=\"token operator\">=</span> train<span class=\"token punctuation\">[</span><span class=\"token string\">'anchor'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">apply</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> x<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x <span class=\"token punctuation\">:</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># çœ‹èµ·æ¥è¿™ä½å°å“¥å¾ˆå–œæ¬¢ ç”¨ lambda æ¼”ç®—ï¼Œåˆ†ç¦» anchor é‡Œçš„è¯å‘é‡æ¥è®¡ç®—å¹³å‡é•¿åº¦</span>\nsns<span class=\"token punctuation\">.</span>histplot<span class=\"token punctuation\">(</span>avg_word_len<span class=\"token punctuation\">,</span> ax <span class=\"token operator\">=</span> ax<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> kde <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">'#ffa408'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># kde æ˜¯å¼€å¯æ ¸å¯†åº¦å‡½æ•°ï¼Ÿ,æˆ‘åªæ˜¯çœ‹åˆ°ä¸€æ¡çº¿å•Š</span>\nax<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>set_title<span class=\"token punctuation\">(</span><span class=\"token string\">'Average Word Length Distribution'</span><span class=\"token punctuation\">,</span> size <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404091257020.png\"></p>\n<h2 id=\"æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ\"><a href=\"#æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ\" class=\"headerlink\" title=\"æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ\"></a>æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ</h2><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> requests\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ntext <span class=\"token operator\">=</span> train<span class=\"token punctuation\">[</span><span class=\"token string\">'anchor'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>values\nurl <span class=\"token operator\">=</span> <span class=\"token string\">'./img.png'</span>\n<span class=\"token comment\"># url = 'https://static.vecteezy.com/system/resources/previews/000/263/280/non_2x/vector-open-book.jpg'</span>\n<span class=\"token comment\"># æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆé“¾æ¥ä¸èƒ½æœ‰æ•ˆæ‰“å¼€</span>\nim <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># æ‰€ä»¥æˆ‘åªèƒ½ç”¨æˆ‘è‡ªå·±çš„æ–¹å¼æ¥æ‰“å¼€</span>\n<span class=\"token comment\"># im = np.array(Image.open(requests.get(url, stream=True).raw))</span>\ncloud <span class=\"token operator\">=</span> WordCloud<span class=\"token punctuation\">(</span>stopwords <span class=\"token operator\">=</span> STOPWORDS<span class=\"token punctuation\">,</span>\n                  background_color <span class=\"token operator\">=</span> <span class=\"token string\">'black'</span><span class=\"token punctuation\">,</span>\n                  mask <span class=\"token operator\">=</span> im<span class=\"token punctuation\">,</span>\n                  max_words <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n                  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>generate<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>cloud<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>axis<span class=\"token punctuation\">(</span><span class=\"token string\">'off'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404093146238.png\"></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># é’ˆå¯¹ä¸Šé¢çš„ anchor çš„ç‰¹å¾æ¥å¯¹ target çš„ä¿¡æ¯æŠ½å–</span>\n<span class=\"token comment\"># åªéœ€è¦æŠŠ anchor æ›¿æ¢æˆ taraget ,action ! </span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404093640583.png\"></p>\n<p><img src=\"/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404093717734.png\"></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># çœ‹èµ·æ¥è¿™ä¸ªå¥½åƒæ˜¯ cm æ¥è®¡é‡çš„</span>\nsns<span class=\"token punctuation\">.</span>countplot<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span><span class=\"token string\">'context'</span><span class=\"token punctuation\">,</span> data <span class=\"token operator\">=</span> train<span class=\"token punctuation\">,</span> palette <span class=\"token operator\">=</span> <span class=\"token string\">'hls'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># åˆæ¥è®¡ç®— context çš„ä¿¡æ¯ï¼Œä½†çœ‹èµ·æ¥ç‰¹å¾ context çš„ä¿¡æ¯æœ‰ç‚¹å¤šå•Š</span>\nplt<span class=\"token punctuation\">.</span>xticks<span class=\"token punctuation\">(</span>rotation <span class=\"token operator\">=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">'Distribution of Context'</span><span class=\"token punctuation\">,</span> fontsize <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404094416376.png\"></p>\n<h6 id=\"3ã€ç‰¹å¾æ ‡å‡†åŒ–\"><a href=\"#3ã€ç‰¹å¾æ ‡å‡†åŒ–\" class=\"headerlink\" title=\"3ã€ç‰¹å¾æ ‡å‡†åŒ–\"></a>3ã€ç‰¹å¾æ ‡å‡†åŒ–</h6><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># method 1 : </span>\nmean_px <span class=\"token operator\">=</span> X_train<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span>\t\t<span class=\"token comment\"># æ±‚å…¶å‡å€¼ä½œä¸º np çš„ float32 æ ¼å¼</span>\nstd_px <span class=\"token operator\">=</span> X_train<span class=\"token punctuation\">.</span>std<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span> \t\t<span class=\"token comment\"># æ±‚å…¶æ ‡å‡†å·®ä½œä¸º np çš„ float32 æ ¼å¼</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">standardize</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">-</span>mean_px<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>std_px\n\n<span class=\"token comment\"># method 2 : Normalize the data</span>\nX_train <span class=\"token operator\">=</span> X_train <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span>\ntest <span class=\"token operator\">=</span> test <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span>\n\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼\"><a href=\"#4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼\" class=\"headerlink\" title=\"4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼\"></a>4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼</h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Check the data</span>\nX_train<span class=\"token punctuation\">.</span>isnull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">any</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntest<span class=\"token punctuation\">.</span>isnull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">any</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Encode labels to one hot vectors (ex : 2 -&gt; [0,0,1,0,0,0,0,0,0,0])</span>\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span>np_utils <span class=\"token keyword\">import</span> to_categorica\nY_train <span class=\"token operator\">=</span> to_categorical<span class=\"token punctuation\">(</span>Y_train<span class=\"token punctuation\">,</span> num_classes <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Set the random seed</span>\nrandom_seed <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\n<span class=\"token comment\"># Split the train and the validation set for the fitting</span>\nX_train<span class=\"token punctuation\">,</span> X_val<span class=\"token punctuation\">,</span> Y_train<span class=\"token punctuation\">,</span> Y_val <span class=\"token operator\">=</span> train_test_split<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> Y_train<span class=\"token punctuation\">,</span> test_size <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span>random_seed<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># æŸ¥çœ‹ä¸€ä¸ªä¾‹å­</span>\ng <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”USPPM\nencoder <span class=\"token operator\">=</span> LabelEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntrain<span class=\"token punctuation\">[</span><span class=\"token string\">'score_encoded'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> encoder<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>train<span class=\"token punctuation\">[</span><span class=\"token string\">'score'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># è¿™é‡Œçš„ 0 å¯¹åº”äº label æ˜¯ 0ï¼Œ0.25 å¯¹åº”äº 1 ï¼Œ0.5 å¯¹åº”äº 2ã€‚ä»¥æ­¤ç±»æ¨...</span>\nskf <span class=\"token operator\">=</span> StratifiedKFold<span class=\"token punctuation\">(</span>n_splits <span class=\"token operator\">=</span> CONFIG<span class=\"token punctuation\">.</span>num_fold<span class=\"token punctuation\">,</span>shuffle<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>random_state <span class=\"token operator\">=</span> CONFIG<span class=\"token punctuation\">.</span>seed<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># åˆ†å±‚kæŠ˜</span>\n<span class=\"token comment\"># num_fold = 5, seed = 2022</span>\n<span class=\"token keyword\">for</span> k<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> val_ind<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>skf<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>X <span class=\"token operator\">=</span> train<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> train<span class=\"token punctuation\">[</span><span class=\"token string\">'score_encoded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># enumerate ä¸­åˆ†ç¦»å‡ºæ¥çš„æ•°æ®æ˜¯ ä¸‹æ ‡ åŠ ä¸Š train ä¸­çš„å€¼</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>val_ind<span class=\"token punctuation\">)</span> <span class=\"token comment\"># idk</span>\n    train<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>val_ind<span class=\"token punctuation\">,</span><span class=\"token string\">'fold'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> k <span class=\"token comment\"># å°† val_ind çš„ä¸‹æ ‡åˆ†åˆ« è´´ä¸Š k æ ‡å¿—</span>\n    <span class=\"token comment\"># é€šè¿‡è¡Œç´¢å¼• index ä¸­çš„å…·ä½“å€¼æ¥å–è¡Œæ•°æ®</span>\n    <span class=\"token comment\"># iloc æ˜¯é€šè¿‡ è¡Œå·æ¥å–è¡Œæ•°æ®</span>\n<span class=\"token comment\">################# æ•ˆæœè¿˜ä¸é”™ ###################</span>\n<span class=\"token punctuation\">[</span>    <span class=\"token number\">2</span>    <span class=\"token number\">11</span>    <span class=\"token number\">13</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token number\">36468</span> <span class=\"token number\">36469</span> <span class=\"token number\">36470</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>    <span class=\"token number\">0</span>     <span class=\"token number\">3</span>     <span class=\"token number\">5</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token number\">36459</span> <span class=\"token number\">36464</span> <span class=\"token number\">36467</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>    <span class=\"token number\">6</span>    <span class=\"token number\">10</span>    <span class=\"token number\">14</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token number\">36465</span> <span class=\"token number\">36471</span> <span class=\"token number\">36472</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>    <span class=\"token number\">4</span>    <span class=\"token number\">21</span>    <span class=\"token number\">26</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token number\">36457</span> <span class=\"token number\">36462</span> <span class=\"token number\">36466</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>    <span class=\"token number\">1</span>     <span class=\"token number\">8</span>     <span class=\"token number\">9</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token number\">36455</span> <span class=\"token number\">36456</span> <span class=\"token number\">36460</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\">###############################################</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"7-æ·»åŠ æ•°æ®æ ‡ç­¾\"><a href=\"#7-æ·»åŠ æ•°æ®æ ‡ç­¾\" class=\"headerlink\" title=\"7.æ·»åŠ æ•°æ®æ ‡ç­¾\"></a>7.æ·»åŠ æ•°æ®æ ‡ç­¾</h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">train<span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> train<span class=\"token punctuation\">[</span><span class=\"token string\">'context'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>df_cpc<span class=\"token punctuation\">.</span>set_index<span class=\"token punctuation\">(</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n\n\n\n\n<h3 id=\"æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»\"><a href=\"#æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»\" class=\"headerlink\" title=\"æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»\"></a>æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Dataset</span><span class=\"token punctuation\">(</span>torch<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>Dataset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Dataset(data)\n      data (np.array or list-like): input_ids and y\n    \"\"\"</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> max_length<span class=\"token operator\">=</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> data\n        self<span class=\"token punctuation\">.</span>max_length <span class=\"token operator\">=</span> max_length\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__len__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__getitem__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># Padding to max_length</span>\n        d <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n        n <span class=\"token operator\">=</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">[</span><span class=\"token string\">'n'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>max_length<span class=\"token punctuation\">)</span>\n\n        input_ids <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>max_length<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>\n        input_ids<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> d<span class=\"token punctuation\">[</span><span class=\"token string\">'input_ids'</span><span class=\"token punctuation\">]</span>\n\n        attention_mask <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>max_length<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>\n        attention_mask<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'input_ids'</span><span class=\"token punctuation\">:</span> input_ids<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'attention_mask'</span><span class=\"token punctuation\">:</span> attention_mask<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'n'</span><span class=\"token punctuation\">:</span> n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Tokenize\"><a href=\"#Tokenize\" class=\"headerlink\" title=\"Tokenize\"></a>Tokenize</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">create_data</span><span class=\"token punctuation\">(</span>train<span class=\"token punctuation\">,</span> tokenizer<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> max_length<span class=\"token operator\">=</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Create input_ids and label array y\n\n    Args:\n      train (pd.DataFrame)\n\n    Returns: list[dict]\n      input_ids (np.array[int])\n      n (int): seq length or number of tokens\n    \"\"\"</span>\n    sep <span class=\"token operator\">=</span> tokenizer<span class=\"token punctuation\">.</span>sep_token_id\n    <span class=\"token keyword\">if</span> tokenizer<span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__name__ <span class=\"token operator\">==</span> <span class=\"token string\">'RobertaTokenizerFast'</span><span class=\"token punctuation\">:</span>\n        nsep <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        nsep <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\n        \n    data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> r <span class=\"token keyword\">in</span> train<span class=\"token punctuation\">.</span>iterrows<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        text <span class=\"token operator\">=</span> r<span class=\"token punctuation\">.</span>pn_history\n        feature_text <span class=\"token operator\">=</span> r<span class=\"token punctuation\">.</span>feature_text\n\n        o <span class=\"token operator\">=</span> tokenizer<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> feature_text<span class=\"token punctuation\">,</span>\n                      add_special_tokens<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> max_length<span class=\"token operator\">=</span>max_length<span class=\"token punctuation\">,</span>\n                      truncation<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n                      return_offsets_mapping<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># Input ids</span>\n        input_ids <span class=\"token operator\">=</span> o<span class=\"token punctuation\">[</span><span class=\"token string\">'input_ids'</span><span class=\"token punctuation\">]</span>\n        n <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>input_ids<span class=\"token punctuation\">)</span>\n\n        input_ids <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">[</span><span class=\"token string\">'input_ids'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">assert</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>input_ids <span class=\"token operator\">==</span> sep<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> nsep  <span class=\"token comment\"># text and feature_text seperated by [SEP]; sep sep for roberta</span>\n        \n        <span class=\"token comment\"># Attention mask</span>\n        attention_mask <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">[</span><span class=\"token string\">'attention_mask'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">assert</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span>attention_mask <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n        d <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'row_id'</span><span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n             <span class=\"token string\">'input_ids'</span><span class=\"token punctuation\">:</span> input_ids<span class=\"token punctuation\">,</span>\n             <span class=\"token string\">'text'</span><span class=\"token punctuation\">:</span> text<span class=\"token punctuation\">,</span>\n             <span class=\"token string\">'n'</span><span class=\"token punctuation\">:</span> n<span class=\"token punctuation\">,</span>\n             <span class=\"token string\">'offset_mapping'</span><span class=\"token punctuation\">:</span> o<span class=\"token punctuation\">[</span><span class=\"token string\">'offset_mapping'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n        data<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Model\"><a href=\"#Model\" class=\"headerlink\" title=\"Model\"></a>Model</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Model</span><span class=\"token punctuation\">(</span>nn<span class=\"token punctuation\">.</span>Module<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> model_dir<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> dropout<span class=\"token operator\">=</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> pretrained<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        config <span class=\"token operator\">=</span> AutoConfig<span class=\"token punctuation\">.</span>from_pretrained<span class=\"token punctuation\">(</span>model_dir<span class=\"token punctuation\">,</span> add_pooling_layer<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> pretrained<span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>transformer <span class=\"token operator\">=</span> AutoModel<span class=\"token punctuation\">.</span>from_pretrained<span class=\"token punctuation\">(</span>model_dir<span class=\"token punctuation\">,</span> config<span class=\"token operator\">=</span>config<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>transformer <span class=\"token operator\">=</span> AutoModel<span class=\"token punctuation\">.</span>from_config<span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span>fc_dropout <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Dropout<span class=\"token punctuation\">(</span>dropout<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>fc <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">.</span>hidden_size<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span>_init_weights<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>fc<span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_init_weights</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> module<span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        module<span class=\"token punctuation\">.</span>weight<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>normal_<span class=\"token punctuation\">(</span>mean<span class=\"token operator\">=</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> std<span class=\"token operator\">=</span>config<span class=\"token punctuation\">.</span>initializer_range<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> module<span class=\"token punctuation\">.</span>bias <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            module<span class=\"token punctuation\">.</span>bias<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>zero_<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">forward</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> input_ids<span class=\"token punctuation\">,</span> attention_mask<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        out <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>transformer<span class=\"token punctuation\">(</span>input_ids<span class=\"token punctuation\">,</span> attention_mask<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> out<span class=\"token punctuation\">[</span><span class=\"token string\">'last_hidden_state'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># batch_size x max_length (512) x 768</span>\n\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>fc_dropout<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>fc<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> x<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h4 id=\"ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€\"><a href=\"#ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€\" class=\"headerlink\" title=\"ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€)\"></a>ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€)</h4><h5 id=\"1ã€model\"><a href=\"#1ã€model\" class=\"headerlink\" title=\"1ã€model\"></a>1ã€model</h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># A CNN model example</span>\nmodel <span class=\"token operator\">=</span> Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">(</span>filters <span class=\"token operator\">=</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> kernel_size <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>padding <span class=\"token operator\">=</span> <span class=\"token string\">'Same'</span><span class=\"token punctuation\">,</span> \n                 activation <span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">,</span> input_shape <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">(</span>filters <span class=\"token operator\">=</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> kernel_size <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>padding <span class=\"token operator\">=</span> <span class=\"token string\">'Same'</span><span class=\"token punctuation\">,</span> \n                 activation <span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>MaxPool2D<span class=\"token punctuation\">(</span>pool_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dropout<span class=\"token punctuation\">(</span><span class=\"token number\">0.25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">(</span>filters <span class=\"token operator\">=</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> kernel_size <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>padding <span class=\"token operator\">=</span> <span class=\"token string\">'Same'</span><span class=\"token punctuation\">,</span> \n                 activation <span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">(</span>filters <span class=\"token operator\">=</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> kernel_size <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>padding <span class=\"token operator\">=</span> <span class=\"token string\">'Same'</span><span class=\"token punctuation\">,</span> \n                 activation <span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>MaxPool2D<span class=\"token punctuation\">(</span>pool_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> strides<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dropout<span class=\"token punctuation\">(</span><span class=\"token number\">0.25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">,</span> activation <span class=\"token operator\">=</span> <span class=\"token string\">\"relu\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dropout<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation <span class=\"token operator\">=</span> <span class=\"token string\">\"softmax\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"2ã€åç»­è¿ä½œæ­¥éª¤\"><a href=\"#2ã€åç»­è¿ä½œæ­¥éª¤\" class=\"headerlink\" title=\"2ã€åç»­è¿ä½œæ­¥éª¤\"></a>2ã€åç»­è¿ä½œæ­¥éª¤</h5><p>ä¸€æ—¦æˆ‘ä»¬çš„å±‚è¢«æ·»åŠ åˆ°æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªè¯„åˆ†å‡½æ•°ã€ä¸€ä¸ªæŸå¤±å‡½æ•°å’Œä¸€ä¸ªä¼˜åŒ–ç®—æ³•ã€‚<br>æˆ‘ä»¬å®šä¹‰æŸå¤±å‡½æ•°æ¥è¡¡é‡æˆ‘ä»¬çš„æ¨¡å‹åœ¨å…·æœ‰å·²çŸ¥æ ‡ç­¾çš„å›¾åƒä¸Šçš„è¡¨ç°æœ‰å¤šå·®ã€‚å®ƒæ˜¯è§‚å¯Ÿåˆ°çš„æ ‡ç­¾å’Œé¢„æµ‹çš„æ ‡ç­¾ä¹‹é—´çš„é”™è¯¯ç‡ã€‚æˆ‘ä»¬ä½¿ç”¨ç§°ä¸ºâ€œcategorical crossentropyâ€çš„åˆ†ç±»åˆ†ç±»ï¼ˆ&gt;2 ç±»ï¼‰çš„ç‰¹å®šå½¢å¼ã€‚<br>æœ€é‡è¦çš„åŠŸèƒ½æ˜¯ä¼˜åŒ–å™¨ã€‚è¿™ä¸ªå‡½æ•°å°†è¿­ä»£åœ°æ”¹è¿›å‚æ•°ï¼ˆè¿‡æ»¤æ ¸å€¼ã€æƒé‡å’Œç¥ç»å…ƒçš„åå·®â€¦â€¦ï¼‰ä»¥æœ€å°åŒ–æŸå¤±ã€‚<br>æˆ‘é€‰æ‹©äº† RMSpropï¼ˆå¸¦æœ‰é»˜è®¤å€¼ï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸æœ‰æ•ˆçš„ä¼˜åŒ–å™¨ã€‚ RMSProp æ›´æ–°ä»¥ä¸€ç§éå¸¸ç®€å•çš„æ–¹å¼è°ƒæ•´ Adagrad æ–¹æ³•ï¼Œè¯•å›¾é™ä½å…¶æ¿€è¿›çš„ã€å•è°ƒé€’å‡çš„å­¦ä¹ ç‡ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ (â€˜sgdâ€™) ä¼˜åŒ–å™¨ï¼Œä½†å®ƒæ¯” RMSprop æ…¢ã€‚<br>åº¦é‡å‡½æ•°â€œå‡†ç¡®åº¦â€ç”¨äºè¯„ä¼°æˆ‘ä»¬æ¨¡å‹çš„æ€§èƒ½ã€‚è¯¥åº¦é‡å‡½æ•°ç±»ä¼¼äºæŸå¤±å‡½æ•°ï¼Œåªæ˜¯åœ¨è®­ç»ƒæ¨¡å‹æ—¶ä¸ä½¿ç”¨åº¦é‡è¯„ä¼°çš„ç»“æœï¼ˆä»…ç”¨äºè¯„ä¼°ï¼‰ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># Define the optimizer\noptimizer = rmsprop_v2(lr=0.001, rho=0.9, epsilon=1e-08, decay=0.0) # è¿™é‡Œæœ‰ä¸€ç‚¹é—®é¢˜ï¼Œä¸èƒ½æ­£å¸¸è¿è¡Œ\n\n# Compile the model\nmodel.compile(optimizer = optimizer , loss = \"categorical_crossentropy\", metrics=[\"accuracy\"])<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸ºäº†ä½¿ä¼˜åŒ–å™¨æ›´å¿«æ”¶æ•›å¹¶æœ€æ¥è¿‘æŸå¤±å‡½æ•°çš„å…¨å±€æœ€å°å€¼ï¼Œæˆ‘ä½¿ç”¨äº†å­¦ä¹ ç‡ï¼ˆLRï¼‰çš„é€€ç«æ–¹æ³•ã€‚<br>LR æ˜¯ä¼˜åŒ–å™¨éå†â€œæŸå¤±æƒ…å†µâ€çš„æ­¥éª¤ã€‚ LRè¶Šé«˜ï¼Œæ­¥æ•°è¶Šå¤§ï¼Œæ”¶æ•›è¶Šå¿«ã€‚ç„¶è€Œï¼Œé«˜ LR çš„é‡‡æ ·éå¸¸å·®ï¼Œä¼˜åŒ–å™¨å¯èƒ½ä¼šé™·å…¥å±€éƒ¨æœ€å°å€¼ã€‚<br>æœ€å¥½åœ¨è®­ç»ƒæœŸé—´é™ä½å­¦ä¹ ç‡ï¼Œä»¥æœ‰æ•ˆåœ°è¾¾åˆ°æŸå¤±å‡½æ•°çš„å…¨å±€æœ€å°å€¼ã€‚<br>ä¸ºäº†ä¿æŒé«˜ LR çš„å¿«é€Ÿè®¡ç®—æ—¶é—´çš„ä¼˜åŠ¿ï¼Œæˆ‘æ¯ X æ­¥ï¼ˆæ—¶æœŸï¼‰åŠ¨æ€é™ä½ LRï¼Œè¿™å–å†³äºæ˜¯å¦æœ‰å¿…è¦ï¼ˆå½“ç²¾åº¦æ²¡æœ‰æé«˜æ—¶ï¼‰ã€‚<br>ä½¿ç”¨ Keras.callbacks ä¸­çš„ ReduceLROnPlateau å‡½æ•°ï¼Œå¦‚æœ 3 ä¸ª epoch åç²¾åº¦æ²¡æœ‰æé«˜ï¼Œæˆ‘é€‰æ‹©å°† LR å‡å°‘ä¸€åŠã€‚</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Set a learning rate annealer</span>\nlearning_rate_reduction <span class=\"token operator\">=</span> ReduceLROnPlateau<span class=\"token punctuation\">(</span>monitor<span class=\"token operator\">=</span><span class=\"token string\">'val_acc'</span><span class=\"token punctuation\">,</span> \n                                            patience<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> \n                                            verbose<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> \n                                            factor<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> \n                                            min_lr<span class=\"token operator\">=</span><span class=\"token number\">0.00001</span><span class=\"token punctuation\">)</span>\nepochs <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token comment\"># Turn epochs to 30 to get 0.9967 accuracy</span>\nbatch_size <span class=\"token operator\">=</span> <span class=\"token number\">86</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"3ã€æ•°æ®å¢åŠ \"><a href=\"#3ã€æ•°æ®å¢åŠ \" class=\"headerlink\" title=\"3ã€æ•°æ®å¢åŠ \"></a>3ã€æ•°æ®å¢åŠ </h5><p>ä¸ºäº†é¿å…è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦äººä¸ºåœ°æ‰©å±•æˆ‘ä»¬çš„æ‰‹å†™æ•°å­—æ•°æ®é›†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿æ‚¨ç°æœ‰çš„æ•°æ®é›†æ›´å¤§ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯é€šè¿‡å°çš„è½¬æ¢æ¥æ”¹å˜è®­ç»ƒæ•°æ®ï¼Œä»¥é‡ç°å½“æœ‰äººå†™æ•°å­—æ—¶å‘ç”Ÿçš„å˜åŒ–ã€‚<br>æ¯”å¦‚æ•°å­—ä¸å±…ä¸­ æ¯”ä¾‹ä¸ä¸€æ ·ï¼ˆæœ‰äº›äººç”¨å¤§/å°æ•°å­—å†™ï¼‰ å›¾åƒæ—‹è½¬â€¦<br>ä»¥æ”¹å˜æ•°ç»„è¡¨ç¤ºåŒæ—¶ä¿æŒæ ‡ç­¾ç›¸åŒçš„æ–¹å¼æ”¹å˜è®­ç»ƒæ•°æ®çš„æ–¹æ³•è¢«ç§°ä¸ºæ•°æ®å¢å¼ºæŠ€æœ¯ã€‚äººä»¬ä½¿ç”¨çš„ä¸€äº›æµè¡Œçš„å¢å¼ºæ˜¯ç°åº¦ã€æ°´å¹³ç¿»è½¬ã€å‚ç›´ç¿»è½¬ã€éšæœºè£å‰ªã€é¢œè‰²æŠ–åŠ¨ã€å¹³ç§»ã€æ—‹è½¬ç­‰ç­‰ã€‚<br>é€šè¿‡å°†è¿™äº›è½¬æ¢ä¸­çš„å‡ ä¸ªåº”ç”¨äºæˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å°†è®­ç»ƒç¤ºä¾‹çš„æ•°é‡å¢åŠ ä¸€å€æˆ–ä¸‰å€ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ¨¡å‹ã€‚<br>æ”¹è¿›å¾ˆé‡è¦ï¼š<br>åœ¨æ²¡æœ‰æ•°æ®å¢å¼ºçš„æƒ…å†µä¸‹ï¼Œæˆ‘è·å¾—äº† 98.114% çš„å‡†ç¡®ç‡<br>é€šè¿‡æ•°æ®å¢å¼ºï¼Œæˆ‘è¾¾åˆ°äº† 99.67% çš„å‡†ç¡®ç‡</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># With data augmentation to prevent overfitting (accuracy 0.99286)</span>\n\ndatagen <span class=\"token operator\">=</span> ImageDataGenerator<span class=\"token punctuation\">(</span>\n        featurewise_center<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># set input mean to 0 over the dataset</span>\n        samplewise_center<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># set each sample mean to 0</span>\n        featurewise_std_normalization<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># divide inputs by std of the dataset</span>\n        samplewise_std_normalization<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># divide each input by its std</span>\n        zca_whitening<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># apply ZCA whitening</span>\n        rotation_range<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># randomly rotate images in the range (degrees, 0 to 180)</span>\n        zoom_range <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># Randomly zoom image </span>\n        width_shift_range<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># randomly shift images horizontally (fraction of total width)</span>\n        height_shift_range<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># randomly shift images vertically (fraction of total height)</span>\n        horizontal_flip<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># randomly flip images</span>\n        vertical_flip<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># randomly flip images</span>\n\n\ndatagen<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯¹äºæ•°æ®æ‰©å……ï¼Œæˆ‘é€‰æ‹©ï¼š<br>å°†ä¸€äº›è®­ç»ƒå›¾åƒéšæœºæ—‹è½¬ 10 åº¦<br>ä¸€äº›è®­ç»ƒå›¾åƒéšæœºç¼©æ”¾ 10%<br>å°†å›¾åƒæ°´å¹³éšæœºç§»åŠ¨ 10% çš„å®½åº¦<br>éšæœºå°†å›¾åƒå‚ç›´ç§»åŠ¨ 10% çš„é«˜åº¦<br>æˆ‘æ²¡æœ‰åº”ç”¨vertical_flip æˆ–horizontal_flipï¼Œå› ä¸ºå®ƒå¯èƒ½å¯¼è‡´é”™è¯¯åˆ†ç±»å¯¹ç§°æ•°å­—ï¼Œä¾‹å¦‚6 å’Œ9ã€‚<br>ä¸€æ—¦æˆ‘ä»¬çš„æ¨¡å‹å‡†å¤‡å¥½ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹Ÿåˆè®­ç»ƒæ•°æ®é›†ã€‚</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Fit the model</span>\nhistory <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>fit_generator<span class=\"token punctuation\">(</span>datagen<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span>Y_train<span class=\"token punctuation\">,</span> batch_size<span class=\"token operator\">=</span>batch_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                              epochs <span class=\"token operator\">=</span> epochs<span class=\"token punctuation\">,</span> validation_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>X_val<span class=\"token punctuation\">,</span>Y_val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                              verbose <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> steps_per_epoch<span class=\"token operator\">=</span>X_train<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">//</span> batch_size\n                              <span class=\"token punctuation\">,</span> callbacks<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>learning_rate_reduction<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"å››ã€è¯„ä¼°æ¨¡å‹\"><a href=\"#å››ã€è¯„ä¼°æ¨¡å‹\" class=\"headerlink\" title=\"å››ã€è¯„ä¼°æ¨¡å‹\"></a>å››ã€è¯„ä¼°æ¨¡å‹</h4><h5 id=\"1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training-and-validation-curves\"><a href=\"#1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training-and-validation-curves\" class=\"headerlink\" title=\"1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training and validation curves\"></a>1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training and validation curves</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\"># Plot the loss and accuracy curves for training and validation \nfig, ax = plt.subplots(2,1)\nax[0].plot(history.history['loss'], color='b', label=\"Training loss\")\nax[0].plot(history.history['val_loss'], color='r', label=\"validation loss\",axes =ax[0])\nlegend = ax[0].legend(loc='best', shadow=True)\n\nax[1].plot(history.history['acc'], color='b', label=\"Training accuracy\")\nax[1].plot(history.history['val_acc'], color='r',label=\"Validation accuracy\")\nlegend = ax[1].legend(loc='best', shadow=True)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>2.æ··æ·†çŸ©é˜µ</p>\n<p>æ··æ·†çŸ©é˜µå¯¹äºæŸ¥çœ‹æ‚¨çš„æ¨¡å‹ç¼ºé™·éå¸¸æœ‰å¸®åŠ©ã€‚<br>æˆ‘ç»˜åˆ¶äº†éªŒè¯ç»“æœçš„æ··æ·†çŸ©é˜µã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># Look at confusion matrix \n\ndef plot_confusion_matrix(cm, classes,\n                          normalize=False,\n                          title='Confusion matrix',\n                          cmap=plt.cm.Blues):\n    \"\"\"\n    This function prints and plots the confusion matrix.\n    Normalization can be applied by setting `normalize=True`.\n    \"\"\"\n    plt.imshow(cm, interpolation='nearest', cmap=cmap)\n    plt.title(title)\n    plt.colorbar()\n    tick_marks = np.arange(len(classes))\n    plt.xticks(tick_marks, classes, rotation=45)\n    plt.yticks(tick_marks, classes)\n\n    if normalize:\n        cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]\n\n    thresh = cm.max() / 2.\n    for i, j in itertools.product(range(cm.shape[0]), range(cm.shape[1])):\n        plt.text(j, i, cm[i, j],\n                 horizontalalignment=\"center\",\n                 color=\"white\" if cm[i, j] &gt; thresh else \"black\")\n\n    plt.tight_layout()\n    plt.ylabel('True label')\n    plt.xlabel('Predicted label')\n\n# Predict the values from the validation dataset\nY_pred = model.predict(X_val)\n# Convert predictions classes to one hot vectors \nY_pred_classes = np.argmax(Y_pred,axis = 1) \n# Convert validation observations to one hot vectors\nY_true = np.argmax(Y_val,axis = 1) \n# compute the confusion matrix\nconfusion_mtx = confusion_matrix(Y_true, Y_pred_classes) \n# plot the confusion matrix\nplot_confusion_matrix(confusion_mtx, classes = range(10)) <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè€ƒè™‘åˆ°éªŒè¯é›†ï¼ˆ4200 å¼ å›¾åƒï¼‰çš„å¤§å°ï¼Œæˆ‘ä»¬çš„ CNN åœ¨æ‰€æœ‰æ•°å­—ä¸Šçš„è¡¨ç°éƒ½éå¸¸å¥½ï¼Œå‡ ä¹æ²¡æœ‰é”™è¯¯ã€‚<br>ä½†æ˜¯ï¼Œæˆ‘ä»¬çš„ CNN ä¼¼ä¹åœ¨ 4 ä½ä¸Šæœ‰ä¸€äº›å°é—®é¢˜ï¼Œå˜¿å˜¿è¢«è¯¯åˆ†ç±»ä¸º 9ã€‚æœ‰æ—¶å½“æ›²çº¿å¹³æ»‘æ—¶å¾ˆéš¾æ•æ‰åˆ° 4 å’Œ 9 ä¹‹é—´çš„å·®å¼‚ã€‚</p>\n<p>è®©æˆ‘ä»¬è°ƒæŸ¥ä¸€ä¸‹é”™è¯¯ã€‚<br>æˆ‘æƒ³çœ‹çœ‹æœ€é‡è¦çš„é”™è¯¯ã€‚ä¸ºæ­¤ï¼Œæˆ‘éœ€è¦å¾—åˆ°ç»“æœä¸­å®é™…å€¼æ¦‚ç‡ä¸é¢„æµ‹å€¼æ¦‚ç‡ä¹‹é—´çš„å·®å¼‚ã€‚</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Display some error results </span>\n\n<span class=\"token comment\"># Errors are difference between predicted labels and true labels</span>\nerrors <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Y_pred_classes <span class=\"token operator\">-</span> Y_true <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\nY_pred_classes_errors <span class=\"token operator\">=</span> Y_pred_classes<span class=\"token punctuation\">[</span>errors<span class=\"token punctuation\">]</span>\nY_pred_errors <span class=\"token operator\">=</span> Y_pred<span class=\"token punctuation\">[</span>errors<span class=\"token punctuation\">]</span>\nY_true_errors <span class=\"token operator\">=</span> Y_true<span class=\"token punctuation\">[</span>errors<span class=\"token punctuation\">]</span>\nX_val_errors <span class=\"token operator\">=</span> X_val<span class=\"token punctuation\">[</span>errors<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">display_errors</span><span class=\"token punctuation\">(</span>errors_index<span class=\"token punctuation\">,</span>img_errors<span class=\"token punctuation\">,</span>pred_errors<span class=\"token punctuation\">,</span> obs_errors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\" This function shows 6 images with their predicted and real labels\"\"\"</span>\n    n <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    nrows <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\n    ncols <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\n    fig<span class=\"token punctuation\">,</span> ax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>subplots<span class=\"token punctuation\">(</span>nrows<span class=\"token punctuation\">,</span>ncols<span class=\"token punctuation\">,</span>sharex<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>sharey<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>nrows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> col <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>ncols<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            error <span class=\"token operator\">=</span> errors_index<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span>\n            ax<span class=\"token punctuation\">[</span>row<span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>img_errors<span class=\"token punctuation\">[</span>error<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            ax<span class=\"token punctuation\">[</span>row<span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>set_title<span class=\"token punctuation\">(</span><span class=\"token string\">\"Predicted label :{}\\nTrue label :{}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>pred_errors<span class=\"token punctuation\">[</span>error<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>obs_errors<span class=\"token punctuation\">[</span>error<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            n <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n\n<span class=\"token comment\"># Probabilities of the wrong predicted numbers</span>\nY_pred_errors_prob <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>Y_pred_errors<span class=\"token punctuation\">,</span>axis <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Predicted probabilities of the true values in the error set</span>\ntrue_prob_errors <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>diagonal<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>take<span class=\"token punctuation\">(</span>Y_pred_errors<span class=\"token punctuation\">,</span> Y_true_errors<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Difference between the probability of the predicted label and the true label</span>\ndelta_pred_true_errors <span class=\"token operator\">=</span> Y_pred_errors_prob <span class=\"token operator\">-</span> true_prob_errors\n\n<span class=\"token comment\"># Sorted list of the delta prob errors</span>\nsorted_dela_errors <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>argsort<span class=\"token punctuation\">(</span>delta_pred_true_errors<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Top 6 errors </span>\nmost_important_errors <span class=\"token operator\">=</span> sorted_dela_errors<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># Show the top 6 errors</span>\ndisplay_errors<span class=\"token punctuation\">(</span>most_important_errors<span class=\"token punctuation\">,</span> X_val_errors<span class=\"token punctuation\">,</span> Y_pred_classes_errors<span class=\"token punctuation\">,</span> Y_true_errors<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æœ€é‡è¦çš„é”™è¯¯ä¹Ÿæ˜¯æœ€ç‹¡çŒ¾çš„ã€‚<br>å¯¹äºè¿™å…­ä¸ªæ¡ˆä¾‹ï¼Œè¯¥æ¨¡å‹å¹¶ä¸è’è°¬ã€‚å…¶ä¸­ä¸€äº›é”™è¯¯ä¹Ÿå¯èƒ½æ˜¯äººä¸ºçš„ï¼Œç‰¹åˆ«æ˜¯å¯¹äºéå¸¸æ¥è¿‘ 4 çš„ 9ã€‚æœ€åçš„ 9 ä¹Ÿå¾ˆå®¹æ˜“äº§ç”Ÿè¯¯å¯¼ï¼Œå¯¹æˆ‘æ¥è¯´ä¼¼ä¹æ˜¯ 0ã€‚</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># predict results</span>\nresults <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># select the indix with the maximum probability</span>\nresults <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">,</span>axis <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\nresults <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">,</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"Label\"</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">submission <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>pd<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">28001</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"ImageId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>results<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>axis <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\nsubmission<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"cnn_mnist_datagen.csv\"</span><span class=\"token punctuation\">,</span>index<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n",
            "tags": [
                "kaggle",
                "å¸¸è§æ•°æ®å¤„ç†"
            ]
        }
    ]
}