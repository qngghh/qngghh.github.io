<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Supernova â€¢ Posts by &#34;ml-dl&#34; category</title>
        <link>https://www.kitx86.com</link>
        <description>å°æ´¾è¿‡æ°”ç”»å®¶</description>
        <language>en</language>
        <pubDate>Thu, 07 Apr 2022 17:14:18 +0800</pubDate>
        <lastBuildDate>Thu, 07 Apr 2022 17:14:18 +0800</lastBuildDate>
        <category>Personal</category>
        <category>kaggle</category>
        <category>ML</category>
        <category>pytorch</category>
        <category>æ·±åº¦å­¦ä¹ </category>
        <category>æœºå™¨å­¦ä¹ </category>
        <category>ç«èµ›æ¨¡æ¿</category>
        <category>å¸¸ç”¨tricks</category>
        <category>paper</category>
        <category>deep learning</category>
        <category>neural network</category>
        <category>SGD</category>
        <category>RMSProp</category>
        <category>Adam</category>
        <category>å¸¸è§æ•°æ®å¤„ç†</category>
        <category>CNN</category>
        <category>RNN</category>
        <category>å¾ªç¯ç¥ç»ç½‘ç»œ</category>
        <category>data vistualtion</category>
        <category>æ¸¸æˆåˆ¶ä½œ</category>
        <category>éŸ³æ¸¸è·‘é…·</category>
        <category>ç‹¬ç«‹è‡ªåˆ¶</category>
        <category>Willing</category>
        <category>è®ºæ–‡å†™ä½œ</category>
        <category>MSRA</category>
        <category>å¾®è½¯äºšæ´²ç ”ç©¶é™¢</category>
        <category>QCQI</category>
        <category>data</category>
        <item>
            <guid isPermalink="true">https://www.kitx86.com/2022/04/07/ml-dl-you-hua-suan-fa-yi-wen/</guid>
            <title>ML-DL-ä¼˜åŒ–ç®—æ³•ç–‘é—®</title>
            <link>https://www.kitx86.com/2022/04/07/ml-dl-you-hua-suan-fa-yi-wen/</link>
            <category>SGD</category>
            <category>RMSProp</category>
            <category>Adam</category>
            <pubDate>Thu, 07 Apr 2022 17:14:18 +0800</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;ä¼˜åŒ–ç®—æ³•ç–‘é—®&#34;&gt;&lt;a href=&#34;#ä¼˜åŒ–ç®—æ³•ç–‘é—®&#34; class=&#34;headerlink&#34; title=&#34;ä¼˜åŒ–ç®—æ³•ç–‘é—®&#34;&gt;&lt;/a&gt;ä¼˜åŒ–ç®—æ³•ç–‘é—®&lt;/h4&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://www.kitx86.com/2022/04/02/ml-dl-readingpaper/</guid>
            <title>ML-DL-ReadingPaper</title>
            <link>https://www.kitx86.com/2022/04/02/ml-dl-readingpaper/</link>
            <category>paper</category>
            <category>deep learning</category>
            <category>neural network</category>
            <pubDate>Sat, 02 Apr 2022 11:41:23 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;Awesome-Deep-Learning-amp-Quantum-Computing&#34;&gt;&lt;a href=&#34;#Awesome-Deep-Learning-amp-Quantum-Computing&#34; class=&#34;headerlink&#34; title=&#34;Awesome Deep Learning &amp;amp; Quantum Computing&#34;&gt;&lt;/a&gt;Awesome Deep Learning &amp;amp; Quantum Computing&lt;/h2&gt;&lt;p&gt;æˆ‘çš„å°ä»“åº“ğŸ˜ğŸ˜ : &lt;a href=&#34;https://www.aliyundrive.com/s/CELiSXuKc8e&#34;&gt;https://www.aliyundrive.com/s/CELiSXuKc8e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸é”™çš„githubåœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;u&gt;æ·±åº¦å­¦ä¹ &lt;/u&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/floodsung/Deep-Learning-Papers-Reading-Roadmap&#34;&gt;https://github.com/floodsung/Deep-Learning-Papers-Reading-Roadmap&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/mli/paper-reading&#34;&gt;https://github.com/mli/paper-reading&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;u&gt;é‡å­è®¡ç®—&lt;/u&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/desireevl/awesome-quantum-computing&#34;&gt;https://github.com/desireevl/awesome-quantum-computing&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¸€ã€Convolutional-Neural-Networks-CNN&#34;&gt;&lt;a href=&#34;#ä¸€ã€Convolutional-Neural-Networks-CNN&#34; class=&#34;headerlink&#34; title=&#34;ä¸€ã€Convolutional Neural Networks - CNN&#34;&gt;&lt;/a&gt;ä¸€ã€Convolutional Neural Networks - CNN&lt;/h3&gt;&lt;h3 id=&#34;äºŒã€Recurrent-Neural-Network-RNN&#34;&gt;&lt;a href=&#34;#äºŒã€Recurrent-Neural-Network-RNN&#34; class=&#34;headerlink&#34; title=&#34;äºŒã€Recurrent Neural Network - RNN&#34;&gt;&lt;/a&gt;äºŒã€Recurrent Neural Network - RNN&lt;/h3&gt;&lt;h3 id=&#34;ä¸‰ã€Reinforcement-Learning-RNN&#34;&gt;&lt;a href=&#34;#ä¸‰ã€Reinforcement-Learning-RNN&#34; class=&#34;headerlink&#34; title=&#34;ä¸‰ã€Reinforcement Learning - RNN&#34;&gt;&lt;/a&gt;ä¸‰ã€Reinforcement Learning - RNN&lt;/h3&gt;&lt;h3 id=&#34;å››ã€Graph-Neural-Learning-GNN&#34;&gt;&lt;a href=&#34;#å››ã€Graph-Neural-Learning-GNN&#34; class=&#34;headerlink&#34; title=&#34;å››ã€Graph Neural Learning - GNN&#34;&gt;&lt;/a&gt;å››ã€Graph Neural Learning - GNN&lt;/h3&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://www.kitx86.com/2022/03/28/ml-dl-xun-huan-shen-jing-wang-luo/</guid>
            <title>ML-DL-å¾ªç¯ç¥ç»ç½‘ç»œ</title>
            <link>https://www.kitx86.com/2022/03/28/ml-dl-xun-huan-shen-jing-wang-luo/</link>
            <category>RNN</category>
            <category>å¾ªç¯ç¥ç»ç½‘ç»œ</category>
            <pubDate>Mon, 28 Mar 2022 14:37:08 +0800</pubDate>
            <description><![CDATA[  ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://www.kitx86.com/2022/03/26/ml-dl-pytorch-shi-xian/</guid>
            <title>ML-DL-Pytorchå®ç°</title>
            <link>https://www.kitx86.com/2022/03/26/ml-dl-pytorch-shi-xian/</link>
            <category>pytorch</category>
            <category>æ·±åº¦å­¦ä¹ </category>
            <category>æœºå™¨å­¦ä¹ </category>
            <pubDate>Sat, 26 Mar 2022 22:35:40 +0800</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;Declaration-ï¼šå€Ÿé‰´äº†-d2l-https-zh-d2l-ai-çš„pytorchå®ç°&#34;&gt;&lt;a href=&#34;#Declaration-ï¼šå€Ÿé‰´äº†-d2l-https-zh-d2l-ai-çš„pytorchå®ç°&#34; class=&#34;headerlink&#34; title=&#34;Declaration ï¼šå€Ÿé‰´äº† d2l (https://zh.d2l.ai)çš„pytorchå®ç°&#34;&gt;&lt;/a&gt;Declaration ï¼šå€Ÿé‰´äº† d2l (&lt;a href=&#34;https://zh.d2l.ai)çš„pytorchå®ç°/&#34;&gt;https://zh.d2l.ai)çš„pytorchå®ç°&lt;/a&gt;&lt;/h4&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://www.kitx86.com/2022/03/26/ml-dl-juan-ji-shen-jing-wang-luo/</guid>
            <title>ML-DL-å·ç§¯ç¥ç»ç½‘ç»œ</title>
            <link>https://www.kitx86.com/2022/03/26/ml-dl-juan-ji-shen-jing-wang-luo/</link>
            <category>CNN</category>
            <pubDate>Sat, 26 Mar 2022 15:28:39 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œç±»&#34;&gt;&lt;a href=&#34;#ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œç±»&#34; class=&#34;headerlink&#34; title=&#34;ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œç±»&#34;&gt;&lt;/a&gt;ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œç±»&lt;/h2&gt;&lt;h4 id=&#34;1ã€ç®€è¦è§£é‡Š&#34;&gt;&lt;a href=&#34;#1ã€ç®€è¦è§£é‡Š&#34; class=&#34;headerlink&#34; title=&#34;1ã€ç®€è¦è§£é‡Š&#34;&gt;&lt;/a&gt;1ã€ç®€è¦è§£é‡Š&lt;/h4&gt;&lt;p&gt;ç”¨é€”-å¤„ç†å›¾åƒæ•°æ®ã€è¡¨æ ¼æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;u&gt;kaggleç«èµ›é€‰æ‹©ï¼šå›¾åƒè¯†åˆ«ï¼Œç›®æ ‡æ£€æµ‹-è¾¹ç¼˜æ£€æµ‹ï¼Œè¯­ä¹‰åˆ†å‰²&lt;/u&gt;&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# æ„é€ ä¸€ä¸ªäºŒç»´å·ç§¯å±‚ï¼Œå®ƒå…·æœ‰1ä¸ªè¾“å‡ºé€šé“å’Œå½¢çŠ¶ä¸ºï¼ˆ1ï¼Œ2ï¼‰çš„å·ç§¯æ ¸&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# äºŒç»´å·ç§¯æ ¸ å‚æ•°å½¢å¼ (æ‰¹é‡å¤§å°ï¼Œé€šé“ï¼Œé«˜åº¦ï¼Œå®½åº¦)&lt;/span&gt;
conv2d &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Conv2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç‰¹æ€§ï¼šç©ºé—´ä¸å˜æ€§&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;å¹³ç§»ä¸å˜æ€§&lt;/em&gt;ï¼ˆtranslation invarianceï¼‰ï¼šä¸ç®¡æ£€æµ‹å¯¹è±¡å‡ºç°åœ¨å›¾åƒä¸­çš„å“ªä¸ªä½ç½®ï¼Œç¥ç»ç½‘ç»œçš„å‰é¢å‡ å±‚åº”è¯¥å¯¹ç›¸åŒçš„å›¾åƒåŒºåŸŸå…·æœ‰ç›¸ä¼¼çš„ååº”ï¼Œå³ä¸ºâ€œå¹³ç§»ä¸å˜æ€§â€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;å±€éƒ¨æ€§&lt;/em&gt;ï¼ˆlocalityï¼‰ï¼šç¥ç»ç½‘ç»œçš„å‰é¢å‡ å±‚åº”è¯¥åªæ¢ç´¢è¾“å…¥å›¾åƒä¸­çš„å±€éƒ¨åŒºåŸŸï¼Œè€Œä¸è¿‡åº¦åœ¨æ„å›¾åƒä¸­ç›¸éš”è¾ƒè¿œåŒºåŸŸçš„å…³ç³»ï¼Œè¿™å°±æ˜¯â€œå±€éƒ¨æ€§â€åŸåˆ™ã€‚æœ€ç»ˆï¼Œå¯ä»¥èšåˆè¿™äº›å±€éƒ¨ç‰¹å¾ï¼Œä»¥åœ¨æ•´ä¸ªå›¾åƒçº§åˆ«è¿›è¡Œé¢„æµ‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¾“å‡ºçš„å·ç§¯å±‚ - ã€‹ ç‰¹å¾æ˜ å°„&lt;/p&gt;
&lt;p&gt;æ„Ÿå—é‡ï¼šæŒ‡å‰å‘ä¼ æ’­ä¸­å¯èƒ½å½±å“ x è®¡ç®—çš„æ‰€æœ‰å…ƒç´ &lt;/p&gt;
&lt;p&gt;â€œå·ç§¯â€è¢«å®šä¹‰ä¸º $$(f * g)(\mathbf{x}) = \int f(\mathbf{z}) g(\mathbf{x}-\mathbf{z}) d\mathbf{z}.$$&lt;/p&gt;
&lt;h4 id=&#34;2ã€å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”LeNet&#34;&gt;&lt;a href=&#34;#2ã€å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”LeNet&#34; class=&#34;headerlink&#34; title=&#34;2ã€å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”LeNet&#34;&gt;&lt;/a&gt;2ã€å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”LeNet&lt;/h4&gt;&lt;p&gt;LeNetï¼ˆLeNet-5ï¼‰ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å·ç§¯ç¼–ç å™¨ï¼šç”±ä¸¤ä¸ªå·ç§¯å±‚ç»„æˆ;&lt;/li&gt;
&lt;li&gt;å…¨è¿æ¥å±‚å¯†é›†å—ï¼šç”±ä¸‰ä¸ªå…¨è¿æ¥å±‚ç»„æˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/lenet.svg&#34; alt=&#34;lenet&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å°ç»“&#34;&gt;&lt;a href=&#34;#å°ç»“&#34; class=&#34;headerlink&#34; title=&#34;å°ç»“&#34;&gt;&lt;/a&gt;å°ç»“&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æ˜¯ä¸€ç±»ä½¿ç”¨å·ç§¯å±‚çš„ç½‘ç»œã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬ç»„åˆä½¿ç”¨å·ç§¯å±‚ã€éçº¿æ€§æ¿€æ´»å‡½æ•°å’Œæ±‡èšå±‚ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºäº†æ„é€ é«˜æ€§èƒ½çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬é€šå¸¸å¯¹å·ç§¯å±‚è¿›è¡Œæ’åˆ—ï¼Œé€æ¸é™ä½å…¶è¡¨ç¤ºçš„ç©ºé—´åˆ†è¾¨ç‡ï¼ŒåŒæ—¶å¢åŠ é€šé“æ•°ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ä¼ ç»Ÿçš„å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œå·ç§¯å—ç¼–ç å¾—åˆ°çš„è¡¨å¾åœ¨è¾“å‡ºä¹‹å‰éœ€ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå…¨è¿æ¥å±‚è¿›è¡Œå¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;LeNetæ˜¯æœ€æ—©å‘å¸ƒçš„å·ç§¯ç¥ç»ç½‘ç»œä¹‹ä¸€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;è€ƒæŸ¥&#34;&gt;&lt;a href=&#34;#è€ƒæŸ¥&#34; class=&#34;headerlink&#34; title=&#34;è€ƒæŸ¥&#34;&gt;&lt;/a&gt;è€ƒæŸ¥&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;å°†å¹³å‡æ±‡èšå±‚æ›¿æ¢ä¸ºæœ€å¤§æ±‡èšå±‚ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å°è¯•æ„å»ºä¸€ä¸ªåŸºäºLeNetçš„æ›´å¤æ‚çš„ç½‘ç»œï¼Œä»¥æé«˜å…¶å‡†ç¡®æ€§ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è°ƒæ•´å·ç§¯çª—å£å¤§å°ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒæ•´è¾“å‡ºé€šé“çš„æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒæ•´æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ReLUï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒæ•´å·ç§¯å±‚çš„æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒæ•´å…¨è¿æ¥å±‚çš„æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒæ•´å­¦ä¹ ç‡å’Œå…¶ä»–è®­ç»ƒç»†èŠ‚ï¼ˆä¾‹å¦‚ï¼Œåˆå§‹åŒ–å’Œè½®æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åœ¨MNISTæ•°æ®é›†ä¸Šå°è¯•ä»¥ä¸Šæ”¹è¿›çš„ç½‘ç»œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ˜¾ç¤ºä¸åŒè¾“å…¥ï¼ˆä¾‹å¦‚æ¯›è¡£å’Œå¤–å¥—ï¼‰æ—¶ï¼ŒLeNetç¬¬ä¸€å±‚å’Œç¬¬äºŒå±‚çš„æ¿€æ´»å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ&#34;&gt;&lt;a href=&#34;#äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ&#34; class=&#34;headerlink&#34; title=&#34;äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ&#34;&gt;&lt;/a&gt;äºŒã€ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œ&lt;/h2&gt;&lt;h3 id=&#34;1ã€AlexNet&#34;&gt;&lt;a href=&#34;#1ã€AlexNet&#34; class=&#34;headerlink&#34; title=&#34;1ã€AlexNet&#34;&gt;&lt;/a&gt;1ã€AlexNet&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;AlexNetã€‚å®ƒæ˜¯ç¬¬ä¸€ä¸ªåœ¨å¤§è§„æ¨¡è§†è§‰ç«èµ›ä¸­å‡»è´¥ä¼ ç»Ÿè®¡ç®—æœºè§†è§‰æ¨¡å‹çš„å¤§å‹ç¥ç»ç½‘ç»œï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½¿ç”¨é‡å¤å—çš„ç½‘ç»œï¼ˆVGGï¼‰ã€‚å®ƒåˆ©ç”¨è®¸å¤šé‡å¤çš„ç¥ç»ç½‘ç»œå—ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç½‘ç»œä¸­çš„ç½‘ç»œï¼ˆNiNï¼‰ã€‚å®ƒé‡å¤ä½¿ç”¨ç”±å·ç§¯å±‚å’Œ1Ã—1å·ç§¯å±‚ï¼ˆç”¨æ¥ä»£æ›¿å…¨è¿æ¥å±‚ï¼‰æ¥æ„å»ºæ·±å±‚ç½‘ç»œ;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å«å¹¶è¡Œè¿ç»“çš„ç½‘ç»œï¼ˆGoogLeNetï¼‰ã€‚å®ƒä½¿ç”¨å¹¶è¡Œè¿ç»“çš„ç½‘ç»œï¼Œé€šè¿‡ä¸åŒçª—å£å¤§å°çš„å·ç§¯å±‚å’Œæœ€å¤§æ±‡èšå±‚æ¥å¹¶è¡ŒæŠ½å–ä¿¡æ¯ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ®‹å·®ç½‘ç»œï¼ˆResNetï¼‰ã€‚å®ƒé€šè¿‡æ®‹å·®å—æ„å»ºè·¨å±‚çš„æ•°æ®é€šé“ï¼Œæ˜¯è®¡ç®—æœºè§†è§‰ä¸­æœ€æµè¡Œçš„ä½“ç³»æ¶æ„ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç¨ å¯†è¿æ¥ç½‘ç»œï¼ˆDenseNetï¼‰ã€‚å®ƒçš„è®¡ç®—æˆæœ¬å¾ˆé«˜ï¼Œä½†ç»™æˆ‘ä»¬å¸¦æ¥äº†æ›´å¥½çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å­¦ä¹ è¡¨å¾è§‚æ‘©å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/filters.png&#34; alt=&#34;filters&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/alexnet.svg&#34; alt=&#34;alexnet&#34;&gt;&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; torch
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; torch &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; nn
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; d2l &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; torch &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; d2l

net &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Sequential&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª11*11çš„æ›´å¤§çª—å£æ¥æ•æ‰å¯¹è±¡ã€‚&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# åŒæ—¶ï¼Œæ­¥å¹…ä¸º4ï¼Œä»¥å‡å°‘è¾“å‡ºçš„é«˜åº¦å’Œå®½åº¦ã€‚&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# å¦å¤–ï¼Œè¾“å‡ºé€šé“çš„æ•°ç›®è¿œå¤§äºLeNet&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Conv2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; stride&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; padding&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ReLU&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;MaxPool2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; stride&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# å‡å°å·ç§¯çª—å£ï¼Œä½¿ç”¨å¡«å……ä¸º2æ¥ä½¿å¾—è¾“å…¥ä¸è¾“å‡ºçš„é«˜å’Œå®½ä¸€è‡´ï¼Œä¸”å¢å¤§è¾“å‡ºé€šé“æ•°&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Conv2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; padding&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ReLU&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;MaxPool2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; stride&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# ä½¿ç”¨ä¸‰ä¸ªè¿ç»­çš„å·ç§¯å±‚å’Œè¾ƒå°çš„å·ç§¯çª—å£ã€‚&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# é™¤äº†æœ€åçš„å·ç§¯å±‚ï¼Œè¾“å‡ºé€šé“çš„æ•°é‡è¿›ä¸€æ­¥å¢åŠ ã€‚&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# åœ¨å‰ä¸¤ä¸ªå·ç§¯å±‚ä¹‹åï¼Œæ±‡èšå±‚ä¸ç”¨äºå‡å°‘è¾“å…¥çš„é«˜åº¦å’Œå®½åº¦&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Conv2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;384&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; padding&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ReLU&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Conv2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;384&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;384&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; padding&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ReLU&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Conv2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;384&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; padding&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ReLU&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;MaxPool2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; stride&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Flatten&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# è¿™é‡Œï¼Œå…¨è¿æ¥å±‚çš„è¾“å‡ºæ•°é‡æ˜¯LeNetä¸­çš„å¥½å‡ å€ã€‚ä½¿ç”¨dropoutå±‚æ¥å‡è½»è¿‡æ‹Ÿåˆ&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;6400&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4096&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ReLU&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;p&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;4096&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4096&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ReLU&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;p&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# æœ€åæ˜¯è¾“å‡ºå±‚ã€‚ç”±äºè¿™é‡Œä½¿ç”¨Fashion-MNISTï¼Œæ‰€ä»¥ç”¨ç±»åˆ«æ•°ä¸º10ï¼Œè€Œéè®ºæ–‡ä¸­çš„1000&lt;/span&gt;
    nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;4096&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è§‚å¯Ÿç½‘ç»œæ¯ä¸€å±‚è¾“å‡ºæ¶æ„&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;X &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;randn&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;224&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;224&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; layer &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; net&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    X&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;layer&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__class__&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__name__&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;output shape:\t&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-markdown&#34; data-language=&#34;markdown&#34;&gt;&lt;code class=&#34;language-markdown&#34;&gt;Conv2d output shape:	 torch.Size([1, 96, 54, 54])
ReLU output shape:	 torch.Size([1, 96, 54, 54])
MaxPool2d output shape:	 torch.Size([1, 96, 26, 26])
Conv2d output shape:	 torch.Size([1, 256, 26, 26])
ReLU output shape:	 torch.Size([1, 256, 26, 26])
MaxPool2d output shape:	 torch.Size([1, 256, 12, 12])
Conv2d output shape:	 torch.Size([1, 384, 12, 12])
ReLU output shape:	 torch.Size([1, 384, 12, 12])
Conv2d output shape:	 torch.Size([1, 384, 12, 12])
ReLU output shape:	 torch.Size([1, 384, 12, 12])
Conv2d output shape:	 torch.Size([1, 256, 12, 12])
ReLU output shape:	 torch.Size([1, 256, 12, 12])
MaxPool2d output shape:	 torch.Size([1, 256, 5, 5])
Flatten output shape:	 torch.Size([1, 6400])
Linear output shape:	 torch.Size([1, 4096])
ReLU output shape:	 torch.Size([1, 4096])
Dropout output shape:	 torch.Size([1, 4096])
Linear output shape:	 torch.Size([1, 4096])
ReLU output shape:	 torch.Size([1, 4096])
Dropout output shape:	 torch.Size([1, 4096])
Linear output shape:	 torch.Size([1, 10])&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;ä½¿ç”¨æ›´å°çš„å­¦ä¹ é€Ÿç‡è®­ç»ƒï¼Œè¿™æ˜¯å› ä¸ºç½‘ç»œæ›´æ·±æ›´å¹¿ã€å›¾åƒåˆ†è¾¨ç‡æ›´é«˜ï¼Œè®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œå°±æ›´æ˜‚è´µã€‚&lt;/p&gt;
&lt;h4 id=&#34;å°ç»“-1&#34;&gt;&lt;a href=&#34;#å°ç»“-1&#34; class=&#34;headerlink&#34; title=&#34;å°ç»“&#34;&gt;&lt;/a&gt;å°ç»“&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;AlexNetçš„æ¶æ„ä¸LeNetç›¸ä¼¼ï¼Œä½†ä½¿ç”¨äº†æ›´å¤šçš„å·ç§¯å±‚å’Œæ›´å¤šçš„å‚æ•°æ¥æ‹Ÿåˆå¤§è§„æ¨¡çš„ImageNetæ•°æ®é›†ã€‚&lt;/li&gt;
&lt;li&gt;ä»Šå¤©ï¼ŒAlexNetå·²ç»è¢«æ›´æœ‰æ•ˆçš„æ¶æ„æ‰€è¶…è¶Šï¼Œä½†å®ƒæ˜¯ä»æµ…å±‚ç½‘ç»œåˆ°æ·±å±‚ç½‘ç»œçš„å…³é”®ä¸€æ­¥ã€‚&lt;/li&gt;
&lt;li&gt;å°½ç®¡AlexNetçš„ä»£ç åªæ¯”LeNetå¤šå‡ºå‡ è¡Œï¼Œä½†å­¦æœ¯ç•ŒèŠ±äº†å¾ˆå¤šå¹´æ‰æ¥å—æ·±åº¦å­¦ä¹ è¿™ä¸€æ¦‚å¿µï¼Œå¹¶åº”ç”¨å…¶å‡ºè‰²çš„å®éªŒç»“æœã€‚è¿™ä¹Ÿæ˜¯ç”±äºç¼ºä¹æœ‰æ•ˆçš„è®¡ç®—å·¥å…·ã€‚&lt;/li&gt;
&lt;li&gt;Dropoutã€ReLUå’Œé¢„å¤„ç†æ˜¯æå‡è®¡ç®—æœºè§†è§‰ä»»åŠ¡æ€§èƒ½çš„å…¶ä»–å…³é”®æ­¥éª¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ç»ƒä¹ &#34;&gt;&lt;a href=&#34;#ç»ƒä¹ &#34; class=&#34;headerlink&#34; title=&#34;ç»ƒä¹ &#34;&gt;&lt;/a&gt;ç»ƒä¹ &lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;è¯•ç€å¢åŠ è¿­ä»£è½®æ•°ã€‚å¯¹æ¯”LeNetçš„ç»“æœæœ‰ä»€ä¹ˆä¸åŒï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;li&gt;AlexNetå¯¹äºFashion-MNISTæ•°æ®é›†æ¥è¯´å¯èƒ½å¤ªå¤æ‚äº†ã€‚&lt;ol&gt;
&lt;li&gt;å°è¯•ç®€åŒ–æ¨¡å‹ä»¥åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼ŒåŒæ—¶ç¡®ä¿å‡†ç¡®æ€§ä¸ä¼šæ˜¾è‘—ä¸‹é™ã€‚&lt;/li&gt;
&lt;li&gt;è®¾è®¡ä¸€ä¸ªæ›´å¥½çš„æ¨¡å‹ï¼Œå¯ä»¥ç›´æ¥åœ¨28Ã—28å›¾åƒä¸Šå·¥ä½œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹æ‰¹é‡å¤§å°ï¼Œå¹¶è§‚å¯Ÿæ¨¡å‹ç²¾åº¦å’ŒGPUæ˜¾å­˜å˜åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;åˆ†æäº†AlexNetçš„è®¡ç®—æ€§èƒ½ã€‚&lt;ol&gt;
&lt;li&gt;åœ¨AlexNetä¸­ä¸»è¦æ˜¯å“ªéƒ¨åˆ†å ç”¨æ˜¾å­˜ï¼Ÿ&lt;/li&gt;
&lt;li&gt;åœ¨AlexNetä¸­ä¸»è¦æ˜¯å“ªéƒ¨åˆ†éœ€è¦æ›´å¤šçš„è®¡ç®—ï¼Ÿ&lt;/li&gt;
&lt;li&gt;è®¡ç®—ç»“æœæ—¶æ˜¾å­˜å¸¦å®½å¦‚ä½•ï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;å°†dropoutå’ŒReLUåº”ç”¨äºLeNet-5ï¼Œæ•ˆæœæœ‰æå‡å—ï¼Ÿå†è¯•è¯•é¢„å¤„ç†ä¼šæ€ä¹ˆæ ·ï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š-VGG-å’ŒAlexNet-æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«&#34;&gt;&lt;a href=&#34;#2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š-VGG-å’ŒAlexNet-æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«&#34; class=&#34;headerlink&#34; title=&#34;2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š VGG (å’ŒAlexNet æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«)&#34;&gt;&lt;/a&gt;2ã€ä½¿ç”¨å—çš„ç½‘ç»œï¼š VGG (å’ŒAlexNet æ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«)&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;/ML-Dl-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/vgg.svg&#34; alt=&#34;vgg&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å°ç»“-2&#34;&gt;&lt;a href=&#34;#å°ç»“-2&#34; class=&#34;headerlink&#34; title=&#34;å°ç»“&#34;&gt;&lt;/a&gt;å°ç»“&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;VGG-11ä½¿ç”¨å¯å¤ç”¨çš„å·ç§¯å—æ„é€ ç½‘ç»œã€‚ä¸åŒçš„VGGæ¨¡å‹å¯é€šè¿‡æ¯ä¸ªå—ä¸­å·ç§¯å±‚æ•°é‡å’Œè¾“å‡ºé€šé“æ•°é‡çš„å·®å¼‚æ¥å®šä¹‰ã€‚&lt;/li&gt;
&lt;li&gt;å—çš„ä½¿ç”¨å¯¼è‡´ç½‘ç»œå®šä¹‰çš„éå¸¸ç®€æ´ã€‚ä½¿ç”¨å—å¯ä»¥æœ‰æ•ˆåœ°è®¾è®¡å¤æ‚çš„ç½‘ç»œã€‚&lt;/li&gt;
&lt;li&gt;åœ¨VGGè®ºæ–‡ä¸­ï¼ŒSimonyanå’ŒZisermanå°è¯•äº†å„ç§æ¶æ„ã€‚ç‰¹åˆ«æ˜¯ä»–ä»¬å‘ç°æ·±å±‚ä¸”çª„çš„å·ç§¯ï¼ˆå³3Ã—3ï¼‰æ¯”è¾ƒæµ…å±‚ä¸”å®½çš„å·ç§¯æ›´æœ‰æ•ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ-NiN&#34;&gt;&lt;a href=&#34;#3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ-NiN&#34; class=&#34;headerlink&#34; title=&#34;3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ - NiN&#34;&gt;&lt;/a&gt;3ã€ç½‘ç»œä¸­çš„ç½‘ç»œ - NiN&lt;/h4&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://www.kitx86.com/2022/03/25/ml-dl-zhen-ming-ji-jiu/</guid>
            <title>Ml-Dl-æœ•å‘½æ€¥æ•‘</title>
            <link>https://www.kitx86.com/2022/03/25/ml-dl-zhen-ming-ji-jiu/</link>
            <category>kaggle</category>
            <category>å¸¸è§æ•°æ®å¤„ç†</category>
            <pubDate>Fri, 25 Mar 2022 18:35:26 +0800</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿&#34;&gt;&lt;a href=&#34;#ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿&#34; class=&#34;headerlink&#34; title=&#34;ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿&#34;&gt;&lt;/a&gt;ä¸€ã€ç«èµ›é¢„å¤„ç†-æ•´ç†çš„æ ·æ¿&lt;/h4&gt;&lt;h5 id=&#34;1ã€å¯¼å…¥å¸¸è§åº“&#34;&gt;&lt;a href=&#34;#1ã€å¯¼å…¥å¸¸è§åº“&#34; class=&#34;headerlink&#34; title=&#34;1ã€å¯¼å…¥å¸¸è§åº“&#34;&gt;&lt;/a&gt;1ã€å¯¼å…¥å¸¸è§åº“&lt;/h5&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; np  &lt;span class=&#34;token comment&#34;&gt;# Linear algebra&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; pd &lt;span class=&#34;token comment&#34;&gt;# data processing, CSV file I/O&lt;/span&gt;


â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å›¾åƒæ•°æ®å¤„ç†éƒ¨åˆ†â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
&lt;span class=&#34;token comment&#34;&gt;# å†…åµŒç»˜å›¾ï¼Œå¯ä»¥çœç•¥ plt.show()&lt;/span&gt;
&lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;matplotlib inline 
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; matplotlib&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;pyplot &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; plt  
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; matplotlib&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;image &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; mpimg

&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; seaborn &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; sns
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;style&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;use&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;seaborn&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# æ˜¾ç¤ºé£æ ¼&lt;/span&gt;
sns&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;style&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;white&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; context&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;notebook&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; palette&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;deep&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”è¯­è¨€tokenå¤„ç†éƒ¨åˆ†â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; wordcloud &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; WordCloud&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; STOPWORDS

 â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¯æ·»åŠ è¡¥å……â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”    
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; IPython&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;core&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;interactiveshell &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; InteractiveShell &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;
InteractiveShell&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ast_node_interactivity &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;all&#34;&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;rcParams&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;figure.figsize&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;style&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;use&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;fivethirtyeight&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# ç§‘å­¦è®¡ç®—ç”¨çš„åº“ï¼ŒåŒ…å«å¾ˆå¤šæ•°å­¦å’Œç®—æ³•çš„å®ä¾‹ï¼Œåæ§½~å“ªæœ‰è¿™ä¹ˆå¤šç§‘å­¦è®¡ç®—åº“&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; scipy &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; stats 

&lt;span class=&#34;token comment&#34;&gt;# æ•°æ®é›†ç¯å¢ƒ&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; dirname&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; _&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; filenames &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; os&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;walk&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;/kaggle/input&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; filenmae &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; filenames&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;os&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;join&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;dirname&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; filename&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
              
&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;highlight_max&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; props &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;where&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;s &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;nanmax&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;values&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; props&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;



&lt;span class=&#34;token comment&#34;&gt;# è¾…åŠ©å·¥å…·&lt;/span&gt;
 &lt;span class=&#34;token comment&#34;&gt;# è¿­ä»£è¿›åº¦æ¡ï¼Œåªæ˜¯ä¸ºäº†å¥½çœ‹&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; tqdm &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; tqdm 
&lt;span class=&#34;token comment&#34;&gt;# çœ‹èµ·æ¥æœ‰ç‚¹è€çš„æ ·å­&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; PIL &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Image 

        
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
&lt;span class=&#34;token comment&#34;&gt;# ç³»ç»Ÿå±€éƒ¨ç¯å¢ƒ&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; os
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; pathlib &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Path
&lt;span class=&#34;token comment&#34;&gt;# åƒåœ¾å›æ”¶æœºåˆ¶&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; gc 

&lt;span class=&#34;token comment&#34;&gt;# å»ºç«‹æ·±åº¦æ¨¡å‹æ‰€éœ€è¦çš„&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;models &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Sequential 
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt;  backend &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; K &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å›¾åƒéƒ¨åˆ†æ¨¡å‹å±‚çš„ç®€æ˜“è§£é‡Šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
&lt;span class=&#34;token comment&#34;&gt;# Conv2D : äºŒç»´å·ç§¯å±‚ï¼Œäº’ç›¸å…³è¿ç®—ï¼Œå¯ä½¿ç”¨å¡«å……ã€æ­¥å¹…å’Œå¤šé€šé“è¾“å…¥/è¾“å‡º&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# Dense : ç¨ å¯†å±‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# Dropout : ä¸¢å¼ƒå±‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# pool2d : 2ç»´æ±‡èšå±‚ï¼Œå¯¹æ±‡èšçª—å£æ‰€æœ‰å…ƒç´ è®¡ç®—æœ€å¤§å€¼æˆ–å¹³å‡å€¼ï¼Œå¯ä½¿ç”¨å¡«å……ã€æ­¥å¹…å’Œå¤šé€šé“è¾“å…¥/è¾“å‡º&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# Flatten : å¹³æ»‘å±‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# MaxPool2D : äºŒç»´æ±‡èšè®¡ç®—æœ€å¤§å€¼&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;layers &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Dense &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; Dropout &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; Lambda&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; Flatten Conv2D&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; MaxPool2D 

&lt;span class=&#34;token comment&#34;&gt;# ä¼˜åŒ–å‡½æ•° rmsprop_v2 , adam_v2&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;optimizers &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Adam &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;RMSprop
&lt;span class=&#34;token comment&#34;&gt;# è®­ç»ƒã€éªŒè¯æ•°æ®åˆ†ç¦»&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;model_selection &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; train_test_split 
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;metrics &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; confusion_matrix &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;preprocessing&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;image &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; ImageDataGenerator &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”è¯­è¨€æ¨¡å‹çš„éƒ¨åˆ†è§£é‡Šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;preprocessing &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; LabelEncoder &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;model_selection &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; StratifiedKFold &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; transformers &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; AutoTokenizer&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; AutoConfig&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; AutoModel&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; get_linear_schedule_with_warmup 

&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;optim &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; AdamW
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;callbacks &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; ReduceLROnPlateau &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¿½ç•¥åŒ…ç¯å¢ƒçš„è­¦å‘Šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; warnings
warnings&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;filterwarnings&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;ignore&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

device &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;cuda&#39;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cuda&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;is_available&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;cpu&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2ã€æ£€æŸ¥ç¯å¢ƒçŠ¶å†µ&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; subprocess &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; check_output
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;check_output&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ls&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;../input&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;decode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;utf8&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;äºŒã€æ£€æŸ¥æ•°æ®&#34;&gt;&lt;a href=&#34;#äºŒã€æ£€æŸ¥æ•°æ®&#34; class=&#34;headerlink&#34; title=&#34;äºŒã€æ£€æŸ¥æ•°æ®&#34;&gt;&lt;/a&gt;äºŒã€æ£€æŸ¥æ•°æ®&lt;/h4&gt;&lt;h5 id=&#34;1ã€åŠ è½½æä¾›çš„æ•°æ®&#34;&gt;&lt;a href=&#34;#1ã€åŠ è½½æä¾›çš„æ•°æ®&#34; class=&#34;headerlink&#34; title=&#34;1ã€åŠ è½½æä¾›çš„æ•°æ®&#34;&gt;&lt;/a&gt;1ã€åŠ è½½æä¾›çš„æ•°æ®&lt;/h5&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input/train.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# è¯»å…¥è®­ç»ƒæ•°æ®&lt;/span&gt;
test &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input/test.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# è¯»å…¥æµ‹è¯•æ•°æ®&lt;/span&gt;

train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;head&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹å‰é¢5è¡Œçš„ä¿¡æ¯&lt;/span&gt;
train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape &lt;span class=&#34;token comment&#34;&gt;# è¿”å›æ•´ä½“ data çš„ çš„ä¿¡æ¯&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string-interpolation&#34;&gt;&lt;span class=&#34;token string&#34;&gt;f&#34;Shape Dtrain:&lt;/span&gt;&lt;span class=&#34;token interpolation&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;{&lt;/span&gt;train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string-interpolation&#34;&gt;&lt;span class=&#34;token string&#34;&gt;f&#34;Shape Dtest: &lt;/span&gt;&lt;span class=&#34;token interpolation&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;{&lt;/span&gt;test&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;#&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Unique elements per column&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;nunique&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Missing Value?&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;isnull&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å›¾åƒæ•°æ®å¤„ç†æ–¹æ³•â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
X_train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;values&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;astype&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;float32&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# å½¢æˆarrayæ•°ç»„ &lt;/span&gt;
y_train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;values&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;astype&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;int32&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# 28*28 çš„å€¼&lt;/span&gt;
X_test &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; test&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;values&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;astype&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;float32&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;


â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” æŠ€å·§ &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tricks&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
&lt;span class=&#34;token comment&#34;&gt;# ä¸€äº›æŠ€å·§ - tricks&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;del&lt;/span&gt; train &lt;span class=&#34;token comment&#34;&gt;# can free some space ?&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;2ã€æ•°æ®å¯è§†åŒ–&#34;&gt;&lt;a href=&#34;#2ã€æ•°æ®å¯è§†åŒ–&#34; class=&#34;headerlink&#34; title=&#34;2ã€æ•°æ®å¯è§†åŒ–&#34;&gt;&lt;/a&gt;2ã€æ•°æ®å¯è§†åŒ–&lt;/h5&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# method 1&lt;/span&gt;
X_train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X_train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;reshape&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X_train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# è½¬å˜æ•°æ®ä¸ºå›¾ç‰‡ï¼Œé‡æ–°ç»„ç»‡å½¢çŠ¶&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# method 2 : Reshape image in 3 dimensions (height = 28px, width = 28px , canal = 1)&lt;/span&gt;
X_train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X_train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;values&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;reshape&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
test &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; test&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;values&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;reshape&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
Y_train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;label&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# åªå–å€¼çš„é‚£ä¸€åˆ—æ ‡ç­¾&lt;/span&gt;
X_train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;labels &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;label&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# ä¸è¦å€¼çš„é‚£ä¸€åˆ—ä½œä¸ºè®­ç»ƒæ•°æ®&lt;/span&gt;
count &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; sns&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;countplot&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Y_train&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# è®¡ç®— 1-10 çš„æ•°é‡&lt;/span&gt;
Y_train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;value_counts&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# æŸ±çŠ¶å›¾æ˜¾ç¤º 1 - 10 çš„æ•°é‡&lt;/span&gt;
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

top &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Counter&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;anc &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; anc &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;anchor&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# Counter è®¡æ•°æ ‡ç­¾&#39;anchor&#39;&lt;/span&gt;
top &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;top&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;most_common&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;50&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# å–å¾—å‰é¢ 50 ä¸ª&lt;/span&gt;

plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;figure&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;figsize&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# ç»˜åˆ¶å›¾è¡¨å°ºå¯¸&lt;/span&gt;

sns&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;barplot&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;top&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;keys&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;top&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;values&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; palette &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;hls&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# è°ƒè‰²æ¿ä¸º hls&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;xticks&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;rotation &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;90&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# x è½´æ ‡ç­¾å¯ä»¥åšå‡ºä¸€äº›è°ƒæ•´&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;title&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Top 50 First Phrases (Anchor)&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; fontsize &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;show&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404083846939.png&#34;&gt;&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;fig&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; ax &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;subplots&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; figsize &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
text_len &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;anchor&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;split&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x &lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

sns&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;countplot&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;text_len&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; ax &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ax&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
ax&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;set_title&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Word Count Distribution&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# è¿™è¿˜è¦å–è®¾ç½®å¤§å°ï¼Ÿ&lt;/span&gt;

avg_word_len &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;anchor&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;split&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x &lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x &lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# çœ‹èµ·æ¥è¿™ä½å°å“¥å¾ˆå–œæ¬¢ ç”¨ lambda æ¼”ç®—ï¼Œåˆ†ç¦» anchor é‡Œçš„è¯å‘é‡æ¥è®¡ç®—å¹³å‡é•¿åº¦&lt;/span&gt;
sns&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;histplot&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;avg_word_len&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; ax &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ax&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kde &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; color &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;#ffa408&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# kde æ˜¯å¼€å¯æ ¸å¯†åº¦å‡½æ•°ï¼Ÿ,æˆ‘åªæ˜¯çœ‹åˆ°ä¸€æ¡çº¿å•Š&lt;/span&gt;
ax&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;set_title&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Average Word Length Distribution&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;show&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404091257020.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ&#34;&gt;&lt;a href=&#34;#æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ&#34; class=&#34;headerlink&#34; title=&#34;æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ&#34;&gt;&lt;/a&gt;æ—¶å°šè¯äº‘çš„displayï¼Œéœ€è¦é…åˆå›¾ç‰‡ç»„åˆ&lt;/h2&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; requests
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;figure&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;figsize &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;anchor&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;values
url &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;./img.png&#39;&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# url = &#39;https://static.vecteezy.com/system/resources/previews/000/263/280/non_2x/vector-open-book.jpg&#39;&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆé“¾æ¥ä¸èƒ½æœ‰æ•ˆæ‰“å¼€&lt;/span&gt;
im &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;array&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Image&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;url&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# æ‰€ä»¥æˆ‘åªèƒ½ç”¨æˆ‘è‡ªå·±çš„æ–¹å¼æ¥æ‰“å¼€&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# im = np.array(Image.open(requests.get(url, stream=True).raw))&lt;/span&gt;
cloud &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; WordCloud&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;stopwords &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; STOPWORDS&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                  background_color &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;black&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                  mask &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; im&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                  max_words &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;generate&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34; &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;join&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;text&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;imshow&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cloud&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;axis&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;off&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;show&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404093146238.png&#34;&gt;&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# é’ˆå¯¹ä¸Šé¢çš„ anchor çš„ç‰¹å¾æ¥å¯¹ target çš„ä¿¡æ¯æŠ½å–&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# åªéœ€è¦æŠŠ anchor æ›¿æ¢æˆ taraget ,action ! &lt;/span&gt;
&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404093640583.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404093717734.png&#34;&gt;&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;figure&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;figsize &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# çœ‹èµ·æ¥è¿™ä¸ªå¥½åƒæ˜¯ cm æ¥è®¡é‡çš„&lt;/span&gt;
sns&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;countplot&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;context&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; palette &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;hls&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# åˆæ¥è®¡ç®— context çš„ä¿¡æ¯ï¼Œä½†çœ‹èµ·æ¥ç‰¹å¾ context çš„ä¿¡æ¯æœ‰ç‚¹å¤šå•Š&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;xticks&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;rotation &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;90&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;title&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Distribution of Context&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; fontsize &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;show&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/ML-DL-%E6%9C%95%E4%B9%8B%E5%91%BD%E9%9C%80%E6%95%91/image-20220404094416376.png&#34;&gt;&lt;/p&gt;
&lt;h6 id=&#34;3ã€ç‰¹å¾æ ‡å‡†åŒ–&#34;&gt;&lt;a href=&#34;#3ã€ç‰¹å¾æ ‡å‡†åŒ–&#34; class=&#34;headerlink&#34; title=&#34;3ã€ç‰¹å¾æ ‡å‡†åŒ–&#34;&gt;&lt;/a&gt;3ã€ç‰¹å¾æ ‡å‡†åŒ–&lt;/h6&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# method 1 : &lt;/span&gt;
mean_px &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X_train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;astype&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;float32&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;		&lt;span class=&#34;token comment&#34;&gt;# æ±‚å…¶å‡å€¼ä½œä¸º np çš„ float32 æ ¼å¼&lt;/span&gt;
std_px &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X_train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;std&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;astype&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;float32&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; 		&lt;span class=&#34;token comment&#34;&gt;# æ±‚å…¶æ ‡å‡†å·®ä½œä¸º np çš„ float32 æ ¼å¼&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;standardize&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; 
    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;mean_px&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;std_px

&lt;span class=&#34;token comment&#34;&gt;# method 2 : Normalize the data&lt;/span&gt;
X_train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X_train &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;255.0&lt;/span&gt;
test &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; test &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;255.0&lt;/span&gt;

&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼&#34;&gt;&lt;a href=&#34;#4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼&#34; class=&#34;headerlink&#34; title=&#34;4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼&#34;&gt;&lt;/a&gt;4ã€æ£€æŸ¥æ•°æ®å’Œç¼ºå¤±å€¼&lt;/h5&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# Check the data&lt;/span&gt;
X_train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;isnull&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;describe&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
test&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;isnull&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;describe&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# Encode labels to one hot vectors (ex : 2 -&amp;gt; [0,0,1,0,0,0,0,0,0,0])&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;utils&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;np_utils &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; to_categorica
Y_train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; to_categorical&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Y_train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; num_classes &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;



&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# Set the random seed&lt;/span&gt;
random_seed &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# Split the train and the validation set for the fitting&lt;/span&gt;
X_train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; X_val&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; Y_train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; Y_val &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train_test_split&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X_train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; Y_train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; test_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; random_state&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;random_seed&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹ä¸€ä¸ªä¾‹å­&lt;/span&gt;
g &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;imshow&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X_train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;


â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”USPPM
encoder &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; LabelEncoder&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;score_encoded&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; encoder&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit_transform&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;score&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# è¿™é‡Œçš„ 0 å¯¹åº”äº label æ˜¯ 0ï¼Œ0.25 å¯¹åº”äº 1 ï¼Œ0.5 å¯¹åº”äº 2ã€‚ä»¥æ­¤ç±»æ¨...&lt;/span&gt;
skf &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; StratifiedKFold&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;n_splits &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; CONFIG&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;num_fold&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;shuffle&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;random_state &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; CONFIG&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;seed&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# åˆ†å±‚kæŠ˜&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# num_fold = 5, seed = 2022&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; k&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;_&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; val_ind&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;skf&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;split&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;score_encoded&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# enumerate ä¸­åˆ†ç¦»å‡ºæ¥çš„æ•°æ®æ˜¯ ä¸‹æ ‡ åŠ ä¸Š train ä¸­çš„å€¼&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_ind&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# idk&lt;/span&gt;
    train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;loc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;val_ind&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;fold&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; k &lt;span class=&#34;token comment&#34;&gt;# å°† val_ind çš„ä¸‹æ ‡åˆ†åˆ« è´´ä¸Š k æ ‡å¿—&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# é€šè¿‡è¡Œç´¢å¼• index ä¸­çš„å…·ä½“å€¼æ¥å–è¡Œæ•°æ®&lt;/span&gt;
    &lt;span class=&#34;token comment&#34;&gt;# iloc æ˜¯é€šè¿‡ è¡Œå·æ¥å–è¡Œæ•°æ®&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;################# æ•ˆæœè¿˜ä¸é”™ ###################&lt;/span&gt;
&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;11&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;13&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36468&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36469&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36470&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;     &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;     &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36459&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36464&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36467&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;14&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36465&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36471&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36472&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;21&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;26&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36457&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36462&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36466&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;    &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;     &lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt;     &lt;span class=&#34;token number&#34;&gt;9&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36455&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36456&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;36460&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;###############################################&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;7-æ·»åŠ æ•°æ®æ ‡ç­¾&#34;&gt;&lt;a href=&#34;#7-æ·»åŠ æ•°æ®æ ‡ç­¾&#34; class=&#34;headerlink&#34; title=&#34;7.æ·»åŠ æ•°æ®æ ‡ç­¾&#34;&gt;&lt;/a&gt;7.æ·»åŠ æ•°æ®æ ‡ç­¾&lt;/h5&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;title&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;context&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;df_cpc&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;set_index&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;code&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;title&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;lower&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;





&lt;h3 id=&#34;æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»&#34;&gt;&lt;a href=&#34;#æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»&#34; class=&#34;headerlink&#34; title=&#34;æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»&#34;&gt;&lt;/a&gt;æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„æ•°æ®é›†ç±»&lt;/h3&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Dataset&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;utils&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Dataset&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token triple-quoted-string string&#34;&gt;&#34;&#34;&#34;
    Dataset(data)
      data (np.array or list-like): input_ids and y
    &#34;&#34;&#34;&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; data&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; max_length&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;512&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; data
        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;max_length &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; max_length

    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__len__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__getitem__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; i&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;token comment&#34;&gt;# Padding to max_length&lt;/span&gt;
        d &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
        n &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;d&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;n&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;max_length&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

        input_ids &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;zeros&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;max_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dtype&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        input_ids&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;n&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; d&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;input_ids&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;

        attention_mask &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;zeros&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;max_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dtype&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        attention_mask&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;n&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;

        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;input_ids&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; input_ids&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                &lt;span class=&#34;token string&#34;&gt;&#39;attention_mask&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; attention_mask&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                &lt;span class=&#34;token string&#34;&gt;&#39;n&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; n&lt;span class=&#34;token punctuation&#34;&gt;}&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;Tokenize&#34;&gt;&lt;a href=&#34;#Tokenize&#34; class=&#34;headerlink&#34; title=&#34;Tokenize&#34;&gt;&lt;/a&gt;Tokenize&lt;/h3&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;create_data&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; tokenizer&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; max_length&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1024&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token triple-quoted-string string&#34;&gt;&#34;&#34;&#34;
    Create input_ids and label array y

    Args:
      train (pd.DataFrame)

    Returns: list[dict]
      input_ids (np.array[int])
      n (int): seq length or number of tokens
    &#34;&#34;&#34;&lt;/span&gt;
    sep &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tokenizer&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sep_token_id
    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; tokenizer&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__class__&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__name__ &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;RobertaTokenizerFast&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        nsep &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        nsep &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;
        
    data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; i&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; r &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iterrows&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; r&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;pn_history
        feature_text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; r&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;feature_text

        o &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tokenizer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;text&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; feature_text&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                      add_special_tokens&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; max_length&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;max_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                      truncation&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                      return_offsets_mapping&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

        &lt;span class=&#34;token comment&#34;&gt;# Input ids&lt;/span&gt;
        input_ids &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; o&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;input_ids&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
        n &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;input_ids&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

        input_ids &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;array&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;o&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;input_ids&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dtype&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;token keyword&#34;&gt;assert&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;input_ids &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; sep&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; nsep  &lt;span class=&#34;token comment&#34;&gt;# text and feature_text seperated by [SEP]; sep sep for roberta&lt;/span&gt;
        
        &lt;span class=&#34;token comment&#34;&gt;# Attention mask&lt;/span&gt;
        attention_mask &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;array&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;o&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;attention_mask&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;token keyword&#34;&gt;assert&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;all&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;attention_mask &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

        d &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;row_id&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; r&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;id&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
             &lt;span class=&#34;token string&#34;&gt;&#39;input_ids&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; input_ids&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
             &lt;span class=&#34;token string&#34;&gt;&#39;text&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; text&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
             &lt;span class=&#34;token string&#34;&gt;&#39;n&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; n&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
             &lt;span class=&#34;token string&#34;&gt;&#39;offset_mapping&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; o&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;offset_mapping&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;}&lt;/span&gt;
        data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;append&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;d&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;array&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;Model&#34;&gt;&lt;a href=&#34;#Model&#34; class=&#34;headerlink&#34; title=&#34;Model&#34;&gt;&lt;/a&gt;Model&lt;/h3&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Model&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Module&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; model_dir&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dropout&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; pretrained&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;token builtin&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__init__&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

        config &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; AutoConfig&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;from_pretrained&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;model_dir&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; add_pooling_layer&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; pretrained&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
            self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transformer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; AutoModel&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;from_pretrained&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;model_dir&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; config&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;config&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
            self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transformer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; AutoModel&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;from_config&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;config&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fc_dropout &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;dropout&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fc &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;config&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;hidden_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;_init_weights&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fc&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; config&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;_init_weights&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; module&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; config&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        module&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;weight&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;normal_&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;mean&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; std&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;config&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;initializer_range&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; module&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;bias &lt;span class=&#34;token keyword&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
            module&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;bias&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;zero_&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; input_ids&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; attention_mask&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        out &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transformer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;input_ids&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; attention_mask&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; out&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;last_hidden_state&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# batch_size x max_length (512) x 768&lt;/span&gt;

        x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fc_dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
        x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fc&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; x&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;



&lt;h4 id=&#34;ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€&#34;&gt;&lt;a href=&#34;#ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€&#34; class=&#34;headerlink&#34; title=&#34;ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€)&#34;&gt;&lt;/a&gt;ä¸‰ã€å»ºç«‹æ¨¡å‹ï¼ˆCNNã€)&lt;/h4&gt;&lt;h5 id=&#34;1ã€model&#34;&gt;&lt;a href=&#34;#1ã€model&#34; class=&#34;headerlink&#34; title=&#34;1ã€model&#34;&gt;&lt;/a&gt;1ã€model&lt;/h5&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# A CNN model example&lt;/span&gt;
model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Sequential&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Conv2D&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;filters &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;padding &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;Same&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                 activation &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;relu&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; input_shape &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Conv2D&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;filters &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;padding &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;Same&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                 activation &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;relu&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;MaxPool2D&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;pool_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.25&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;


model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Conv2D&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;filters &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;padding &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;Same&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                 activation &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;relu&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Conv2D&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;filters &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;padding &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;Same&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                 activation &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;relu&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;MaxPool2D&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;pool_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; strides&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.25&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;


model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Flatten&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Dense&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; activation &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;relu&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;add&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Dense&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; activation &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;softmax&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;2ã€åç»­è¿ä½œæ­¥éª¤&#34;&gt;&lt;a href=&#34;#2ã€åç»­è¿ä½œæ­¥éª¤&#34; class=&#34;headerlink&#34; title=&#34;2ã€åç»­è¿ä½œæ­¥éª¤&#34;&gt;&lt;/a&gt;2ã€åç»­è¿ä½œæ­¥éª¤&lt;/h5&gt;&lt;p&gt;ä¸€æ—¦æˆ‘ä»¬çš„å±‚è¢«æ·»åŠ åˆ°æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªè¯„åˆ†å‡½æ•°ã€ä¸€ä¸ªæŸå¤±å‡½æ•°å’Œä¸€ä¸ªä¼˜åŒ–ç®—æ³•ã€‚&lt;br&gt;æˆ‘ä»¬å®šä¹‰æŸå¤±å‡½æ•°æ¥è¡¡é‡æˆ‘ä»¬çš„æ¨¡å‹åœ¨å…·æœ‰å·²çŸ¥æ ‡ç­¾çš„å›¾åƒä¸Šçš„è¡¨ç°æœ‰å¤šå·®ã€‚å®ƒæ˜¯è§‚å¯Ÿåˆ°çš„æ ‡ç­¾å’Œé¢„æµ‹çš„æ ‡ç­¾ä¹‹é—´çš„é”™è¯¯ç‡ã€‚æˆ‘ä»¬ä½¿ç”¨ç§°ä¸ºâ€œcategorical crossentropyâ€çš„åˆ†ç±»åˆ†ç±»ï¼ˆ&amp;gt;2 ç±»ï¼‰çš„ç‰¹å®šå½¢å¼ã€‚&lt;br&gt;æœ€é‡è¦çš„åŠŸèƒ½æ˜¯ä¼˜åŒ–å™¨ã€‚è¿™ä¸ªå‡½æ•°å°†è¿­ä»£åœ°æ”¹è¿›å‚æ•°ï¼ˆè¿‡æ»¤æ ¸å€¼ã€æƒé‡å’Œç¥ç»å…ƒçš„åå·®â€¦â€¦ï¼‰ä»¥æœ€å°åŒ–æŸå¤±ã€‚&lt;br&gt;æˆ‘é€‰æ‹©äº† RMSpropï¼ˆå¸¦æœ‰é»˜è®¤å€¼ï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸æœ‰æ•ˆçš„ä¼˜åŒ–å™¨ã€‚ RMSProp æ›´æ–°ä»¥ä¸€ç§éå¸¸ç®€å•çš„æ–¹å¼è°ƒæ•´ Adagrad æ–¹æ³•ï¼Œè¯•å›¾é™ä½å…¶æ¿€è¿›çš„ã€å•è°ƒé€’å‡çš„å­¦ä¹ ç‡ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ (â€˜sgdâ€™) ä¼˜åŒ–å™¨ï¼Œä½†å®ƒæ¯” RMSprop æ…¢ã€‚&lt;br&gt;åº¦é‡å‡½æ•°â€œå‡†ç¡®åº¦â€ç”¨äºè¯„ä¼°æˆ‘ä»¬æ¨¡å‹çš„æ€§èƒ½ã€‚è¯¥åº¦é‡å‡½æ•°ç±»ä¼¼äºæŸå¤±å‡½æ•°ï¼Œåªæ˜¯åœ¨è®­ç»ƒæ¨¡å‹æ—¶ä¸ä½¿ç”¨åº¦é‡è¯„ä¼°çš„ç»“æœï¼ˆä»…ç”¨äºè¯„ä¼°ï¼‰ã€‚&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-none&#34;&gt;&lt;code class=&#34;language-none&#34;&gt;# Define the optimizer
optimizer = rmsprop_v2(lr=0.001, rho=0.9, epsilon=1e-08, decay=0.0) # è¿™é‡Œæœ‰ä¸€ç‚¹é—®é¢˜ï¼Œä¸èƒ½æ­£å¸¸è¿è¡Œ

# Compile the model
model.compile(optimizer = optimizer , loss = &#34;categorical_crossentropy&#34;, metrics=[&#34;accuracy&#34;])&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸ºäº†ä½¿ä¼˜åŒ–å™¨æ›´å¿«æ”¶æ•›å¹¶æœ€æ¥è¿‘æŸå¤±å‡½æ•°çš„å…¨å±€æœ€å°å€¼ï¼Œæˆ‘ä½¿ç”¨äº†å­¦ä¹ ç‡ï¼ˆLRï¼‰çš„é€€ç«æ–¹æ³•ã€‚&lt;br&gt;LR æ˜¯ä¼˜åŒ–å™¨éå†â€œæŸå¤±æƒ…å†µâ€çš„æ­¥éª¤ã€‚ LRè¶Šé«˜ï¼Œæ­¥æ•°è¶Šå¤§ï¼Œæ”¶æ•›è¶Šå¿«ã€‚ç„¶è€Œï¼Œé«˜ LR çš„é‡‡æ ·éå¸¸å·®ï¼Œä¼˜åŒ–å™¨å¯èƒ½ä¼šé™·å…¥å±€éƒ¨æœ€å°å€¼ã€‚&lt;br&gt;æœ€å¥½åœ¨è®­ç»ƒæœŸé—´é™ä½å­¦ä¹ ç‡ï¼Œä»¥æœ‰æ•ˆåœ°è¾¾åˆ°æŸå¤±å‡½æ•°çš„å…¨å±€æœ€å°å€¼ã€‚&lt;br&gt;ä¸ºäº†ä¿æŒé«˜ LR çš„å¿«é€Ÿè®¡ç®—æ—¶é—´çš„ä¼˜åŠ¿ï¼Œæˆ‘æ¯ X æ­¥ï¼ˆæ—¶æœŸï¼‰åŠ¨æ€é™ä½ LRï¼Œè¿™å–å†³äºæ˜¯å¦æœ‰å¿…è¦ï¼ˆå½“ç²¾åº¦æ²¡æœ‰æé«˜æ—¶ï¼‰ã€‚&lt;br&gt;ä½¿ç”¨ Keras.callbacks ä¸­çš„ ReduceLROnPlateau å‡½æ•°ï¼Œå¦‚æœ 3 ä¸ª epoch åç²¾åº¦æ²¡æœ‰æé«˜ï¼Œæˆ‘é€‰æ‹©å°† LR å‡å°‘ä¸€åŠã€‚&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# Set a learning rate annealer&lt;/span&gt;
learning_rate_reduction &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ReduceLROnPlateau&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;monitor&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;val_acc&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                                            patience&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                                            verbose&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                                            factor&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                                            min_lr&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.00001&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
epochs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# Turn epochs to 30 to get 0.9967 accuracy&lt;/span&gt;
batch_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;86&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;3ã€æ•°æ®å¢åŠ &#34;&gt;&lt;a href=&#34;#3ã€æ•°æ®å¢åŠ &#34; class=&#34;headerlink&#34; title=&#34;3ã€æ•°æ®å¢åŠ &#34;&gt;&lt;/a&gt;3ã€æ•°æ®å¢åŠ &lt;/h5&gt;&lt;p&gt;ä¸ºäº†é¿å…è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦äººä¸ºåœ°æ‰©å±•æˆ‘ä»¬çš„æ‰‹å†™æ•°å­—æ•°æ®é›†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿æ‚¨ç°æœ‰çš„æ•°æ®é›†æ›´å¤§ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯é€šè¿‡å°çš„è½¬æ¢æ¥æ”¹å˜è®­ç»ƒæ•°æ®ï¼Œä»¥é‡ç°å½“æœ‰äººå†™æ•°å­—æ—¶å‘ç”Ÿçš„å˜åŒ–ã€‚&lt;br&gt;æ¯”å¦‚æ•°å­—ä¸å±…ä¸­ æ¯”ä¾‹ä¸ä¸€æ ·ï¼ˆæœ‰äº›äººç”¨å¤§/å°æ•°å­—å†™ï¼‰ å›¾åƒæ—‹è½¬â€¦&lt;br&gt;ä»¥æ”¹å˜æ•°ç»„è¡¨ç¤ºåŒæ—¶ä¿æŒæ ‡ç­¾ç›¸åŒçš„æ–¹å¼æ”¹å˜è®­ç»ƒæ•°æ®çš„æ–¹æ³•è¢«ç§°ä¸ºæ•°æ®å¢å¼ºæŠ€æœ¯ã€‚äººä»¬ä½¿ç”¨çš„ä¸€äº›æµè¡Œçš„å¢å¼ºæ˜¯ç°åº¦ã€æ°´å¹³ç¿»è½¬ã€å‚ç›´ç¿»è½¬ã€éšæœºè£å‰ªã€é¢œè‰²æŠ–åŠ¨ã€å¹³ç§»ã€æ—‹è½¬ç­‰ç­‰ã€‚&lt;br&gt;é€šè¿‡å°†è¿™äº›è½¬æ¢ä¸­çš„å‡ ä¸ªåº”ç”¨äºæˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å°†è®­ç»ƒç¤ºä¾‹çš„æ•°é‡å¢åŠ ä¸€å€æˆ–ä¸‰å€ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ¨¡å‹ã€‚&lt;br&gt;æ”¹è¿›å¾ˆé‡è¦ï¼š&lt;br&gt;åœ¨æ²¡æœ‰æ•°æ®å¢å¼ºçš„æƒ…å†µä¸‹ï¼Œæˆ‘è·å¾—äº† 98.114% çš„å‡†ç¡®ç‡&lt;br&gt;é€šè¿‡æ•°æ®å¢å¼ºï¼Œæˆ‘è¾¾åˆ°äº† 99.67% çš„å‡†ç¡®ç‡&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# With data augmentation to prevent overfitting (accuracy 0.99286)&lt;/span&gt;

datagen &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ImageDataGenerator&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;
        featurewise_center&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# set input mean to 0 over the dataset&lt;/span&gt;
        samplewise_center&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# set each sample mean to 0&lt;/span&gt;
        featurewise_std_normalization&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# divide inputs by std of the dataset&lt;/span&gt;
        samplewise_std_normalization&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# divide each input by its std&lt;/span&gt;
        zca_whitening&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# apply ZCA whitening&lt;/span&gt;
        rotation_range&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# randomly rotate images in the range (degrees, 0 to 180)&lt;/span&gt;
        zoom_range &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# Randomly zoom image &lt;/span&gt;
        width_shift_range&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# randomly shift images horizontally (fraction of total width)&lt;/span&gt;
        height_shift_range&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# randomly shift images vertically (fraction of total height)&lt;/span&gt;
        horizontal_flip&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# randomly flip images&lt;/span&gt;
        vertical_flip&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# randomly flip images&lt;/span&gt;


datagen&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X_train&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯¹äºæ•°æ®æ‰©å……ï¼Œæˆ‘é€‰æ‹©ï¼š&lt;br&gt;å°†ä¸€äº›è®­ç»ƒå›¾åƒéšæœºæ—‹è½¬ 10 åº¦&lt;br&gt;ä¸€äº›è®­ç»ƒå›¾åƒéšæœºç¼©æ”¾ 10%&lt;br&gt;å°†å›¾åƒæ°´å¹³éšæœºç§»åŠ¨ 10% çš„å®½åº¦&lt;br&gt;éšæœºå°†å›¾åƒå‚ç›´ç§»åŠ¨ 10% çš„é«˜åº¦&lt;br&gt;æˆ‘æ²¡æœ‰åº”ç”¨vertical_flip æˆ–horizontal_flipï¼Œå› ä¸ºå®ƒå¯èƒ½å¯¼è‡´é”™è¯¯åˆ†ç±»å¯¹ç§°æ•°å­—ï¼Œä¾‹å¦‚6 å’Œ9ã€‚&lt;br&gt;ä¸€æ—¦æˆ‘ä»¬çš„æ¨¡å‹å‡†å¤‡å¥½ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹Ÿåˆè®­ç»ƒæ•°æ®é›†ã€‚&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# Fit the model&lt;/span&gt;
history &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit_generator&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datagen&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;flow&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X_train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;Y_train&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; batch_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;batch_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                              epochs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; epochs&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; validation_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X_val&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;Y_val&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                              verbose &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; steps_per_epoch&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;X_train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;//&lt;/span&gt; batch_size
                              &lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; callbacks&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;learning_rate_reduction&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;å››ã€è¯„ä¼°æ¨¡å‹&#34;&gt;&lt;a href=&#34;#å››ã€è¯„ä¼°æ¨¡å‹&#34; class=&#34;headerlink&#34; title=&#34;å››ã€è¯„ä¼°æ¨¡å‹&#34;&gt;&lt;/a&gt;å››ã€è¯„ä¼°æ¨¡å‹&lt;/h4&gt;&lt;h5 id=&#34;1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training-and-validation-curves&#34;&gt;&lt;a href=&#34;#1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training-and-validation-curves&#34; class=&#34;headerlink&#34; title=&#34;1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training and validation curves&#34;&gt;&lt;/a&gt;1ã€è®­ç»ƒå’ŒéªŒè¯æ›²çº¿-Training and validation curves&lt;/h5&gt;&lt;pre class=&#34;line-numbers language-none&#34;&gt;&lt;code class=&#34;language-none&#34;&gt;# Plot the loss and accuracy curves for training and validation 
fig, ax = plt.subplots(2,1)
ax[0].plot(history.history[&#39;loss&#39;], color=&#39;b&#39;, label=&#34;Training loss&#34;)
ax[0].plot(history.history[&#39;val_loss&#39;], color=&#39;r&#39;, label=&#34;validation loss&#34;,axes =ax[0])
legend = ax[0].legend(loc=&#39;best&#39;, shadow=True)

ax[1].plot(history.history[&#39;acc&#39;], color=&#39;b&#39;, label=&#34;Training accuracy&#34;)
ax[1].plot(history.history[&#39;val_acc&#39;], color=&#39;r&#39;,label=&#34;Validation accuracy&#34;)
legend = ax[1].legend(loc=&#39;best&#39;, shadow=True)&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2.æ··æ·†çŸ©é˜µ&lt;/p&gt;
&lt;p&gt;æ··æ·†çŸ©é˜µå¯¹äºæŸ¥çœ‹æ‚¨çš„æ¨¡å‹ç¼ºé™·éå¸¸æœ‰å¸®åŠ©ã€‚&lt;br&gt;æˆ‘ç»˜åˆ¶äº†éªŒè¯ç»“æœçš„æ··æ·†çŸ©é˜µã€‚&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-none&#34;&gt;&lt;code class=&#34;language-none&#34;&gt;# Look at confusion matrix 

def plot_confusion_matrix(cm, classes,
                          normalize=False,
                          title=&#39;Confusion matrix&#39;,
                          cmap=plt.cm.Blues):
    &#34;&#34;&#34;
    This function prints and plots the confusion matrix.
    Normalization can be applied by setting `normalize=True`.
    &#34;&#34;&#34;
    plt.imshow(cm, interpolation=&#39;nearest&#39;, cmap=cmap)
    plt.title(title)
    plt.colorbar()
    tick_marks = np.arange(len(classes))
    plt.xticks(tick_marks, classes, rotation=45)
    plt.yticks(tick_marks, classes)

    if normalize:
        cm = cm.astype(&#39;float&#39;) / cm.sum(axis=1)[:, np.newaxis]

    thresh = cm.max() / 2.
    for i, j in itertools.product(range(cm.shape[0]), range(cm.shape[1])):
        plt.text(j, i, cm[i, j],
                 horizontalalignment=&#34;center&#34;,
                 color=&#34;white&#34; if cm[i, j] &amp;gt; thresh else &#34;black&#34;)

    plt.tight_layout()
    plt.ylabel(&#39;True label&#39;)
    plt.xlabel(&#39;Predicted label&#39;)

# Predict the values from the validation dataset
Y_pred = model.predict(X_val)
# Convert predictions classes to one hot vectors 
Y_pred_classes = np.argmax(Y_pred,axis = 1) 
# Convert validation observations to one hot vectors
Y_true = np.argmax(Y_val,axis = 1) 
# compute the confusion matrix
confusion_mtx = confusion_matrix(Y_true, Y_pred_classes) 
# plot the confusion matrix
plot_confusion_matrix(confusion_mtx, classes = range(10)) &lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè€ƒè™‘åˆ°éªŒè¯é›†ï¼ˆ4200 å¼ å›¾åƒï¼‰çš„å¤§å°ï¼Œæˆ‘ä»¬çš„ CNN åœ¨æ‰€æœ‰æ•°å­—ä¸Šçš„è¡¨ç°éƒ½éå¸¸å¥½ï¼Œå‡ ä¹æ²¡æœ‰é”™è¯¯ã€‚&lt;br&gt;ä½†æ˜¯ï¼Œæˆ‘ä»¬çš„ CNN ä¼¼ä¹åœ¨ 4 ä½ä¸Šæœ‰ä¸€äº›å°é—®é¢˜ï¼Œå˜¿å˜¿è¢«è¯¯åˆ†ç±»ä¸º 9ã€‚æœ‰æ—¶å½“æ›²çº¿å¹³æ»‘æ—¶å¾ˆéš¾æ•æ‰åˆ° 4 å’Œ 9 ä¹‹é—´çš„å·®å¼‚ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬è°ƒæŸ¥ä¸€ä¸‹é”™è¯¯ã€‚&lt;br&gt;æˆ‘æƒ³çœ‹çœ‹æœ€é‡è¦çš„é”™è¯¯ã€‚ä¸ºæ­¤ï¼Œæˆ‘éœ€è¦å¾—åˆ°ç»“æœä¸­å®é™…å€¼æ¦‚ç‡ä¸é¢„æµ‹å€¼æ¦‚ç‡ä¹‹é—´çš„å·®å¼‚ã€‚&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# Display some error results &lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# Errors are difference between predicted labels and true labels&lt;/span&gt;
errors &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Y_pred_classes &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; Y_true &lt;span class=&#34;token operator&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

Y_pred_classes_errors &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Y_pred_classes&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;errors&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
Y_pred_errors &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Y_pred&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;errors&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
Y_true_errors &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Y_true&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;errors&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
X_val_errors &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X_val&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;errors&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;display_errors&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;errors_index&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;img_errors&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;pred_errors&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; obs_errors&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token triple-quoted-string string&#34;&gt;&#34;&#34;&#34; This function shows 6 images with their predicted and real labels&#34;&#34;&#34;&lt;/span&gt;
    n &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;
    nrows &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;
    ncols &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;
    fig&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; ax &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; plt&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;subplots&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nrows&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;ncols&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;sharex&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;sharey&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; row &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nrows&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; col &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ncols&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
            error &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; errors_index&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;n&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
            ax&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;row&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;col&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;imshow&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;img_errors&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;error&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;reshape&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
            ax&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;row&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;col&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;set_title&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Predicted label :{}\nTrue label :{}&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;pred_errors&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;error&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;obs_errors&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;error&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
            n &lt;span class=&#34;token operator&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# Probabilities of the wrong predicted numbers&lt;/span&gt;
Y_pred_errors_prob &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Y_pred_errors&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;axis &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# Predicted probabilities of the true values in the error set&lt;/span&gt;
true_prob_errors &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;diagonal&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;take&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Y_pred_errors&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; Y_true_errors&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# Difference between the probability of the predicted label and the true label&lt;/span&gt;
delta_pred_true_errors &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Y_pred_errors_prob &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; true_prob_errors

&lt;span class=&#34;token comment&#34;&gt;# Sorted list of the delta prob errors&lt;/span&gt;
sorted_dela_errors &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;argsort&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;delta_pred_true_errors&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# Top 6 errors &lt;/span&gt;
most_important_errors &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; sorted_dela_errors&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# Show the top 6 errors&lt;/span&gt;
display_errors&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;most_important_errors&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; X_val_errors&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; Y_pred_classes_errors&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; Y_true_errors&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ€é‡è¦çš„é”™è¯¯ä¹Ÿæ˜¯æœ€ç‹¡çŒ¾çš„ã€‚&lt;br&gt;å¯¹äºè¿™å…­ä¸ªæ¡ˆä¾‹ï¼Œè¯¥æ¨¡å‹å¹¶ä¸è’è°¬ã€‚å…¶ä¸­ä¸€äº›é”™è¯¯ä¹Ÿå¯èƒ½æ˜¯äººä¸ºçš„ï¼Œç‰¹åˆ«æ˜¯å¯¹äºéå¸¸æ¥è¿‘ 4 çš„ 9ã€‚æœ€åçš„ 9 ä¹Ÿå¾ˆå®¹æ˜“äº§ç”Ÿè¯¯å¯¼ï¼Œå¯¹æˆ‘æ¥è¯´ä¼¼ä¹æ˜¯ 0ã€‚&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# predict results&lt;/span&gt;
results &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;test&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# select the indix with the maximum probability&lt;/span&gt;
results &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;argmax&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;results&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;axis &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

results &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Series&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;results&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;name&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Label&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;submission &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concat&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Series&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;28001&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;ImageId&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;results&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;axis &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

submission&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;cnn_mnist_datagen.csv&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;index&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://www.kitx86.com/2022/03/17/ml-dl-asamplemodel/</guid>
            <title>ML-DL-ASampleModel</title>
            <link>https://www.kitx86.com/2022/03/17/ml-dl-asamplemodel/</link>
            <category>kaggle</category>
            <category>ML</category>
            <pubDate>Thu, 17 Mar 2022 12:08:09 +0800</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;åœ¨-kaggle-ä¸Šå†™çš„ä¸€ä¸ªç®€é™‹æ¨¡å‹&#34;&gt;&lt;a href=&#34;#åœ¨-kaggle-ä¸Šå†™çš„ä¸€ä¸ªç®€é™‹æ¨¡å‹&#34; class=&#34;headerlink&#34; title=&#34;åœ¨ kaggle ä¸Šå†™çš„ä¸€ä¸ªç®€é™‹æ¨¡å‹&#34;&gt;&lt;/a&gt;åœ¨ kaggle ä¸Šå†™çš„ä¸€ä¸ªç®€é™‹æ¨¡å‹&lt;/h4&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; np &lt;span class=&#34;token comment&#34;&gt;# linear algebra&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; pd &lt;span class=&#34;token comment&#34;&gt;# data processing, CSV file I/O (e.g. pd.read_csv)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;tree &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; DecisionTreeRegressor  &lt;span class=&#34;token comment&#34;&gt;# å†³ç­–æ ‘&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;metrics &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; mean_absolute_error &lt;span class=&#34;token comment&#34;&gt;# ç»å¯¹å‡å€¼è¯¯å·®&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;model_selection &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; train_test_split &lt;span class=&#34;token comment&#34;&gt;# è®­ç»ƒæµ‹è¯•åˆ†ç¦»&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ensemble &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; RandomForestRegressor &lt;span class=&#34;token comment&#34;&gt;# éšæœºæ£®æ—&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# è¯»å…¥æ•°æ®&lt;/span&gt;
train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;./train.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
test &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;./test.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;describe&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# è®­ç»ƒé›†çš„ç»Ÿè®¡&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;test&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;describe&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# è¦é¢„æµ‹  SalePrice&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;columns  &lt;span class=&#34;token comment&#34;&gt;# check columns infos&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;test&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;columns &lt;span class=&#34;token comment&#34;&gt;# here have benn means to  predict &#34;SalePrice&#34;&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;feature_names &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;LotArea&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;YearBuilt&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;1stFlrSF&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;2ndFlrSF&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                 &lt;span class=&#34;token string&#34;&gt;&#34;FullBath&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;BedroomAbvGr&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;TotRmsAbvGrd&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
X &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;feature_names&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
y &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;SalePrice&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;X&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;describe&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;wrong_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; DecisionTreeRegressor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;random_state&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# build model&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# fit the model&lt;/span&gt;
wrong_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# make predictions&lt;/span&gt;
predictions &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; wrong_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;predictions&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# split in and uncomment&lt;/span&gt;
train_X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; val_X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; train_y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; val_y &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train_test_split&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;random_state&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# specify the model&lt;/span&gt;
after_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; DecisionTreeRegressor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;random_state&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# fit after_model with training data.&lt;/span&gt;
after_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;train_X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;train_y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;val_predictions &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; after_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_predictions&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_y&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;val_mae &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; mean_absolute_error&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;val_predictions&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_mae&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# we will write the mean_absolute_error as a function&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;get_mae&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;max_leaf_nodes&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;train_X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;val_X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;train_y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;val_y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; DecisionTreeRegressor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;max_leaf_nodes&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;max_leaf_nodes&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;random_state&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
    model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;train_X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;train_y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
    preds_val &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
    mae &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; mean_absolute_error&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;preds_val&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; mae&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;candidate_max_leaf_nodes &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;50&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;50&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;250&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;500&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# write loop to find the ideal tree size&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# intermediate for loop writing&lt;/span&gt;

scores &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;{&lt;/span&gt;leaf_size&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; get_mae&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;leaf_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;train_X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;val_X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;train_y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;val_y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; leaf_size &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; candidate_max_leaf_nodes&lt;span class=&#34;token punctuation&#34;&gt;}&lt;/span&gt;
best_tree_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;scores&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;key &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; scores&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;best_tree_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# write the final model with fill n arguments&lt;/span&gt;
final_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; DecisionTreeRegressor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;max_leaf_nodes&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;best_tree_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;random_state&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
final_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
final_test &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; final_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
final_test&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;# try use the rf-model&lt;/span&gt;
rf_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; RandomForestRegressor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
rf_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;train_X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;train_y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# this is me write down a corresponding right trick&lt;/span&gt;
rf_val_mae &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; mean_absolute_error&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;rf_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;val_X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;val_y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
rf_val_mae&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;final_predictions &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; rf_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# check the predictions&lt;/span&gt;
final_predictions&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;DataFrame&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Id&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; test_data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Id&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                       &lt;span class=&#34;token string&#34;&gt;&#39;SalePrice&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; test_preds&lt;span class=&#34;token punctuation&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
output&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;submission.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; index&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;æäº¤&#34;&gt;&lt;a href=&#34;#æäº¤&#34; class=&#34;headerlink&#34; title=&#34;æäº¤&#34;&gt;&lt;/a&gt;æäº¤&lt;/h4&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://www.kitx86.com/2022/03/11/ml-dl-logistic-hui-gui-ji-ben-gai-nian/</guid>
            <title>ML-DL-logisticå›å½’åŸºæœ¬æ¦‚å¿µ</title>
            <link>https://www.kitx86.com/2022/03/11/ml-dl-logistic-hui-gui-ji-ben-gai-nian/</link>
            <category>æœºå™¨å­¦ä¹ </category>
            <pubDate>Fri, 11 Mar 2022 00:14:31 +0800</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;logisticå›å½’&#34;&gt;&lt;a href=&#34;#logisticå›å½’&#34; class=&#34;headerlink&#34; title=&#34;logisticå›å½’&#34;&gt;&lt;/a&gt;logisticå›å½’&lt;/h4&gt;&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token comment&#34;&gt;##  åŸºç¡€å‡½æ•°åº“&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; np 

&lt;span class=&#34;token comment&#34;&gt;## å¯¼å…¥ç”»å›¾åº“&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; matplotlib&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;pyplot &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; plt
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; seaborn &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; sns

&lt;span class=&#34;token comment&#34;&gt;## å¯¼å…¥é€»è¾‘å›å½’æ¨¡å‹å‡½æ•°&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;linear_model &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; LogisticRegression&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://www.kitx86.com/2022/03/09/ml-dl-kaggle-part1/</guid>
            <title>ML-DL-kaggle-Part1</title>
            <link>https://www.kitx86.com/2022/03/09/ml-dl-kaggle-part1/</link>
            <category>kaggle</category>
            <pubDate>Wed, 09 Mar 2022 01:48:41 +0800</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;kaggleé‡Œè¦å¦‚ä½•èåˆæ¨¡å‹åŠä¸€èˆ¬çš„æ“ä½œæ–¹å¼&#34;&gt;&lt;a href=&#34;#kaggleé‡Œè¦å¦‚ä½•èåˆæ¨¡å‹åŠä¸€èˆ¬çš„æ“ä½œæ–¹å¼&#34; class=&#34;headerlink&#34; title=&#34;kaggleé‡Œè¦å¦‚ä½•èåˆæ¨¡å‹åŠä¸€èˆ¬çš„æ“ä½œæ–¹å¼&#34;&gt;&lt;/a&gt;kaggleé‡Œè¦å¦‚ä½•èåˆæ¨¡å‹åŠä¸€èˆ¬çš„æ“ä½œæ–¹å¼&lt;/h4&gt;&lt;p&gt;åŸå€ï¼škaggleä¸Šæ‰¾ä¸åˆ°äº†&lt;/p&gt;
&lt;pre class=&#34;line-numbers language-python&#34; data-language=&#34;python&#34;&gt;&lt;code class=&#34;language-python&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; numpy  &lt;span class=&#34;token comment&#34;&gt;# linear algebra&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;token comment&#34;&gt;# æ•°æ®æ¸…æ´—ï¼Œåˆé˜¶å·¥ä½œéƒ¨åˆ†æ¥å¤„ç†csvéƒ¨åˆ†&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; os &lt;span class=&#34;token comment&#34;&gt;# è¯»å–æ–‡ä»¶è·¯å¾„&lt;/span&gt;


&lt;span class=&#34;token comment&#34;&gt;# æ­¤åœºæ™¯ç”¨äºkaggleæä¾›çš„notebook&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;os&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;listdir&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input/(kaggle competition name)/train.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
test &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input/(kaggle competition name)/test.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹æ•°æ®çš„ç»´åº¦&lt;/span&gt;
train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape &lt;span class=&#34;token comment&#34;&gt;# print(&#39;Train set size:&#39;,train.shape)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# å¯¹äºä¸€äº›æ— æ•ˆçš„æ•°æ®éœ€è¦è¿›è¡Œä¸å¯é¿å…çš„å¤„ç†,æ¯”å¦‚æ‰”æ‰&lt;/span&gt;
train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;æ ‡ç­¾åˆ—&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;inplace&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;token comment&#34;&gt;#å¯¼å…¥è®¡ç®—æ¨¡å—ï¼Œå¯¹æ¨¡å—å¤§è‡´åŠŸèƒ½æ³¨è§£ï¼š&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#numpyæ”¯æŒçŸ©é˜µè¿ç®—&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#pandasç”¨æ¥åšæ•°æ®æ¸…æ´—ï¼Œåƒæ˜¯pythonä¸­çš„excelï¼ˆæ”¯æŒå°†æ•°æ®ä»¥.csvæ ¼å¼è¾“å‡ºè‡³æœ¬åœ°ï¼‰&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#sklearnç”¨æ¥è¿›ä¸€æ­¥åˆ¶ä½œæ•°æ®é›†ï¼ˆæ”¯æŒæ•°æ®çš„å¯¼å…¥å’Œæ•°æ®çš„å¯¼å‡ºï¼‰ï¼Œå«æœ‰SVMæ”¯æŒå‘é‡æœºã€DTå†³ç­–æ ‘ã€KNNè¿‘é‚»ã€LRé€»è¾‘å›å½’ç­‰å°è£…å¥½çš„æ¨¡å‹ï¼Œæ”¯æŒå¯¹æ•°æ®è¿›è¡Œäº¤å‰éªŒè¯ä»¥è°ƒå‚ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#mlxtendç”¨æ¥å®ç°é›†æˆå­¦ä¹ ï¼šbagging, boosting, stacking&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#lightgbmå†…æœ‰boosting treeï¼ˆç›¸æ¯”xgboostï¼Œæ”¹è¿›äº†ç”ŸæˆèŠ‚ç‚¹çš„æ–¹å¼ï¼‰&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#xgboostå†…æœ‰boosting tree&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#osç”¨æ¥è¯»å–æ–‡ä»¶&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; np  &lt;span class=&#34;token comment&#34;&gt;# linear algebra&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; pd  &lt;span class=&#34;token comment&#34;&gt;#&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; datetime &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; datetime
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; scipy&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stats &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; skew  &lt;span class=&#34;token comment&#34;&gt;# for some statistics&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; scipy&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;special &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; boxcox1p
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; scipy&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stats &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; boxcox_normmax
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;linear_model &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; ElasticNetCV&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; LassoCV&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; RidgeCV
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ensemble &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; GradientBoostingRegressor
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;svm &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; SVR
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;pipeline &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; make_pipeline
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;preprocessing &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; RobustScaler
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;model_selection &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; KFold&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; cross_val_score
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; sklearn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;metrics &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; mean_squared_error
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; mlxtend&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;regressor &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; StackingCVRegressor
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; xgboost &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; XGBRegressor
&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; lightgbm &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; LGBMRegressor
&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; os

&lt;span class=&#34;token comment&#34;&gt;#######################################################æ•°æ®å¯¼å…¥å’Œç‰¹å¾æå–-ã€å¼€å§‹ã€‘################################################################################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ˜¾ç¤ºå½“å‰ç¼–è¯‘å™¨çš„Draft Environmentä¸‹çš„æ–‡ä»¶ï¼›å°†æ–‡ä»¶å¤¹ä¸‹çš„å¯¹åº”åç§°csvæ–‡ä»¶å‚¨å­˜ä¸ºçŸ©é˜µå¯¹è±¡ã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;os&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;listdir&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;../input&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input/house-prices-advanced-regression-techniques/train.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
test &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input/house-prices-advanced-regression-techniques/test.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ˜¾ç¤ºçŸ©é˜µå¯¹è±¡çš„ç»´æ•°ï¼Œæ ¸æŸ¥æ˜¯å¦å¯¼å…¥æˆåŠŸ&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Train set size:&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Test set size:&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; test&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#è®°å½•è¿ç®—å¼€å§‹çš„æ—¶é—´&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;START data processing&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å–å‡ºtrainçŸ©é˜µï¼ˆæˆ–è€…ç§°ä¹‹ä¸ºâ€œæ•°æ®å¸§â€dataframeï¼‰ä¸­titleä¸º&#39;Id&#39;çš„åˆ—ï¼Œèµ‹å€¼ç»™train_IDã€‚æ‰€ä»¥train_IDæ˜¯ä¸€ç»´åˆ—å‘é‡äº†ã€‚test_IDç±»ä¼¼ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#train_IDå’Œtest_IDæ ¹æœ¬å°±æ²¡æœ‰ä½¿ç”¨ï¼Œå®Œå…¨å¯ä»¥åˆ é™¤ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#train_ID = train[&#39;Id&#39;]&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#test_ID = test[&#39;Id&#39;]&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;##################åˆ é™¤è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„æ ‡ç­¾åˆ—-ã€å¼€å§‹ã€‘#################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#å°†trainçŸ©é˜µä¸­çš„&#39;Id&#39;åˆ—åˆ é™¤ï¼ˆåŸåœ°åˆ é™¤ï¼Œæ•…å°†inplaceè®¾ä¸ºtrueï¼‰ï¼Œå› ä¸ºåŸå§‹æ•°æ®ä¸­çš„æ•°æ®ç´¢å¼•å’Œé¢„æµ‹æ¨¡å‹çš„æ„å»ºæ²¡æœ‰å…³ç³»ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#testçŸ©é˜µç±»ä¼¼ã€‚&lt;/span&gt;
train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Id&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; inplace&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
test&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Id&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; inplace&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;##################åˆ é™¤è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„æ ‡ç­¾åˆ—-ã€ç»“æŸã€‘#################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;###############åˆ é™¤è®­ç»ƒé›†ä¸­çš„æç«¯å€¼å’Œè¿›è¡Œæ•°æ®indexæ›´æ–°-ã€å¼€å§‹ã€‘#########&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#ä½¿ç”¨æ¡ä»¶ç­›é€‰æ“ä½œï¼Œé€šè¿‡è¦†å€¼çš„æ–¹å¼å‰”é™¤åŸå§‹æ•°æ®trainçŸ©é˜µä¸­çš„æç«¯å€¼ï¼ˆæç«¯å€¼ä¹Ÿè¢«ç§°ä¸ºoutliersï¼‰ï¼Œå¸®åŠ©é¢„é˜²æˆ¿ä»·é¢„æµ‹æ¨¡å‹å‡ºç°è¿‡æ‹Ÿåˆã€‚å‰”é™¤æ“ä½œä¹Ÿå¯ä»¥è§†ä¸ºå‰å‰ªæã€‚&lt;/span&gt;
train &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;GrLivArea &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4500&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#ç”±äºåˆ å»äº†éƒ¨åˆ†è¡Œï¼Œæ•…æ­¤æ—¶trainçŸ©é˜µä¸­çš„indexåˆ—å¹¶ä¸è¿ç»­ã€‚ä½¿ç”¨reset_indexå‘½ä»¤ï¼Œåœ¨å›ºå®šéindexæ•°æ®çš„é¡ºåºçš„å‰æä¸‹ï¼ˆinplace=Trueï¼‰ï¼Œé‡æ–°å¯¹indexç¼–å·ï¼ˆdrop=Trueï¼‰ã€‚&lt;/span&gt;
train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;reset_index&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;drop&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; inplace&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;###############åˆ é™¤è®­ç»ƒé›†ä¸­çš„æç«¯å€¼å’Œè¿›è¡Œæ•°æ®indexæ›´æ–°-ã€ç»“æŸã€‘#########&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;##########å¯¹é¢„æµ‹ç›®æ ‡æ•°å€¼è¿›è¡Œå¯¹æ•°å˜æ¢å’Œç‰¹å¾çŸ©é˜µå¯¹è±¡çš„åˆ›å»º-ã€å¼€å§‹ã€‘#######&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# log1på°±æ˜¯log(1+x)ï¼Œç”¨æ¥å¯¹æˆ¿ä»·æ•°æ®è¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼Œå®ƒçš„å¥½å¤„æ˜¯è½¬åŒ–åçš„æ•°æ®æ›´åŠ æœä»é«˜æ–¯åˆ†å¸ƒï¼Œæœ‰åˆ©äºåç»­çš„åˆ†ç±»ç»“æœã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# éœ€è¦æ³¨æ„ï¼Œæœ€åéœ€è¦å°†é¢„æµ‹å‡ºçš„å¹³æ»‘æ•°æ®è¿˜åŸï¼Œè€Œè¿˜åŸè¿‡ç¨‹å°±æ˜¯log1pçš„é€†è¿ç®—expm1ã€‚&lt;/span&gt;
train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;SalePrice&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;log1p&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;SalePrice&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#å•ç‹¬å–å‡ºè®­ç»ƒæ•°æ®ä¸­çš„æˆ¿ä»·åˆ—ä¿¡æ¯ï¼Œå­˜å…¥yå¯¹è±¡ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#y = train.SalePrice.reset_index(drop=True) #.reset_index(drop=True)æ–¹æ³•ï¼šåœ¨åŸæœ‰çš„ç´¢å¼•åˆ—é‡ç½®ç´¢å¼•ï¼Œä¸å†å¦å¤–æ·»åŠ æ–°åˆ—ã€‚æœ‰å¿…è¦ä½¿ç”¨reset_indexå—ï¼Ÿæœ‰å¿…è¦çš„ï¼Œä¸è¿™æ ·åšyå°†æœ‰ä¸¤å¥—indexï¼Œä½œä¸ºdfçš„yå°†æœ‰ä¸¤åˆ—ã€‚&lt;/span&gt;
y &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SalePrice&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;reset_index&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;drop&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;#å¯¹ä¸Šå¼çš„æ”¹å†™&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ²¿ç€æ°´å¹³çš„æ–¹å‘å¯»æ‰¾åˆ—åä¸º&#39;SalePrice&#39;çš„åˆ—ï¼ˆä»¬ï¼‰ï¼ŒæŠŠå®ƒä»¬å¯¹åº”çš„åˆ—ç»Ÿç»Ÿåˆ æ‰ã€‚å¾—åˆ°äº†å•çº¯çš„ç‰¹å¾çŸ©é˜µï¼Œå­˜å…¥train_featureså¯¹è±¡ä¸­ã€‚&lt;/span&gt;
train_features &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SalePrice&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#testæœ¬æ¥å°±æ²¡æœ‰æˆ¿ä»·åˆ—ï¼Œæ‰€ä»¥å®ƒæœ¬æ¥å°±æ˜¯å•çº¯çš„ç‰¹å¾çŸ©é˜µã€‚&lt;/span&gt;
test_features &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; test
&lt;span class=&#34;token comment&#34;&gt;##########å¯¹é¢„æµ‹ç›®æ ‡æ•°å€¼è¿›è¡Œå¯¹æ•°å˜æ¢å’Œç‰¹å¾çŸ©é˜µå¯¹è±¡çš„åˆ›å»º-ã€ç»“æŸã€‘#######&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;##åˆå¹¶è®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µä¸æµ‹è¯•æ•°æ®ç‰¹å¾çŸ©é˜µï¼Œä»¥ä¾¿ç»Ÿä¸€è¿›è¡Œç‰¹å¾å¤„ç†-ã€å¼€å§‹ã€‘##&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#å°†è®­ç»ƒæ•°æ®ä¸­çš„ç‰¹å¾çŸ©é˜µå’Œæµ‹è¯•æ•°æ®ä¸­çš„ç‰¹å¾çŸ©é˜µåˆå¹¶ï¼ˆ.concat[çŸ©é˜µ1,çŸ©é˜µ2]ï¼‰ï¼Œå¹¶å¯¹åˆå¹¶åçš„çŸ©é˜µindexé‡æ–°ç¼–å·ï¼ˆ.reset_index(drop=True)ï¼‰ã€‚&lt;/span&gt;
features &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concat&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;train_features&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; test_features&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;reset_index&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;drop&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ£€æŸ¥åˆå¹¶åçš„çŸ©é˜µçš„ç»´æ•°ï¼Œæ ¸æŸ¥åˆå¹¶ç»“æœã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;å‰”é™¤è®­ç»ƒæ•°æ®ä¸­çš„æç«¯å€¼åï¼Œå°†å…¶ç‰¹å¾çŸ©é˜µå’Œæµ‹è¯•æ•°æ®ä¸­çš„ç‰¹å¾çŸ©é˜µåˆå¹¶ï¼Œç»´åº¦ä¸º:&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;##åˆå¹¶è®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µä¸æµ‹è¯•æ•°æ®ç‰¹å¾çŸ©é˜µï¼Œä»¥ä¾¿ç»Ÿä¸€è¿›è¡Œç‰¹å¾å¤„ç†-ã€ç»“æŸã€‘##&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#######################################################æ•°æ®å¯¼å…¥å’Œç‰¹å¾æå–-ã€ç»“æŸã€‘################################################################################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;##############################################################ç‰¹å¾å¤„ç†-ã€å¼€å§‹ã€‘###################################################################################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#å¯¹äºåˆ—åä¸º&#39;MSSubClass&#39;ã€&#39;YrSold&#39;ã€&#39;MoSold&#39;çš„ç‰¹å¾åˆ—ï¼Œå°†åˆ—ä¸­çš„æ•°æ®ç±»å‹è½¬åŒ–ä¸ºstringæ ¼å¼ã€‚&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;MSSubClass&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;MSSubClass&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;YrSold&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;YrSold&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;astype&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;MoSold&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;MoSold&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;astype&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;###############################å¡«å……ç©ºå€¼-ã€å¼€å§‹ã€‘##########################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æŒ‰ç…§ä»¥ä¸‹å„ä¸ªç‰¹å¾åˆ—çš„å®é™…æƒ…å†µï¼Œä¾æ¬¡å¤„ç†å„ä¸ªç‰¹å¾åˆ—ä¸­çš„ç©ºå€¼ï¼ˆ.fillna()æ–¹æ³•ï¼‰&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Functional&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Functional&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Typ&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;#ç©ºå€¼å¡«å……ä¸ºstrå‹æ•°æ®&#39;Typ&#39;&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Electrical&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Electrical&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;SBrkr&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;#ç©ºå€¼å¡«å……ä¸ºstrå‹æ•°æ®&#34;SBrkr&#34;&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;KitchenQual&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;KitchenQual&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;TA&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;#ç©ºå€¼å¡«å……ä¸ºstrå‹æ•°æ®&#34;TA&#34;&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;PoolQC&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;PoolQC&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;None&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;#ç©ºå€¼å¡«å……ä¸ºstrå‹æ•°æ®&#34;None&#34;&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å¯¹äºåˆ—åä¸º&#39;Exterior1st&#39;ã€&#39;Exterior2nd&#39;ã€&#39;SaleType&#39;çš„ç‰¹å¾åˆ—ï¼Œä½¿ç”¨åˆ—ä¸­çš„ä¼—æ•°å¡«å……ç©ºå€¼ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#	1.å…ˆæŸ¥æ‰¾æ•°æ®åˆ—ä¸­çš„ä¼—æ•°ï¼šä½¿ç”¨df.mode()[]æ–¹æ³•&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#	  è§£é‡Šï¼šdf.mode(0æˆ–1,0è¡¨ç¤ºå¯¹åˆ—æŸ¥æ‰¾ï¼Œ1è¡¨ç¤ºå¯¹è¡ŒæŸ¥æ‰¾)[éœ€è¦æŸ¥æ‰¾ä¼—æ•°çš„dfåˆ—çš„indexï¼ˆå°±æ˜¯dfä¸­çš„ç¬¬å‡ åˆ—ï¼‰]ï¼Œå°†è¿”å›æ•°æ®åˆ—ä¸­çš„ä¼—æ•°&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#	2.ä½¿ç”¨.fillna()æ–¹æ³•è¿›è¡Œå¡«å……&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Exterior1st&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Exterior1st&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Exterior1st&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; 
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Exterior2nd&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Exterior2nd&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Exterior2nd&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SaleType&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SaleType&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SaleType&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å¯¹äºåˆ—åä¸º&#39;GarageYrBlt&#39;, &#39;GarageArea&#39;, &#39;GarageCars&#39;çš„ç‰¹å¾åˆ—ï¼Œä½¿ç”¨0å¡«å……ç©ºå€¼ã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; col &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;GarageYrBlt&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;GarageArea&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;GarageCars&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;col&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;col&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å¯¹äºåˆ—åä¸º&#39;GarageType&#39;, &#39;GarageFinish&#39;, &#39;GarageQual&#39;, &#39;GarageCond&#39;çš„ç‰¹å¾åˆ—ï¼Œä½¿ç”¨å­—ç¬¦ä¸²&#39;None&#39;å¡«å……ç©ºå€¼ã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; col &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;GarageType&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;GarageFinish&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;GarageQual&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;GarageCond&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;col&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;col&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;None&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å¯¹äºåˆ—åä¸º&#39;BsmtQual&#39;, &#39;BsmtCond&#39;, &#39;BsmtExposure&#39;, &#39;BsmtFinType1&#39;, &#39;BsmtFinType2&#39;çš„ç‰¹å¾åˆ—ï¼Œä½¿ç”¨å­—ç¬¦ä¸²&#39;None&#39;å¡«å……ç©ºå€¼ã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; col &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;BsmtQual&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;BsmtCond&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;BsmtExposure&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;BsmtFinType1&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;BsmtFinType2&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;col&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;col&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;None&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#èšåˆå‡½æ•°ï¼ˆæŒ‰æŸä¸€åˆ—å…³é”®å­—åˆ†ç»„ï¼‰groupbyï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šå°†è¿”å›ä¸ä¼ å…¥æ–¹æ³•çš„çŸ©é˜µç»´åº¦ç›¸åŒçš„å•ä¸ªåºåˆ—ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#transformæ˜¯ä¸groupbyï¼ˆpandasä¸­æœ€æœ‰ç”¨çš„æ“ä½œä¹‹ä¸€ï¼‰é€šå¸¸ç»„åˆä½¿ç”¨ï¼Œå®ƒå¯¹ä¼ å…¥æ–¹æ³•çš„çŸ©é˜µè¿›è¡Œç»´åº¦ä¸å˜çš„å˜æ¢ã€‚å…·ä½“å˜æ¢æ–¹æ³•å†™åœ¨æ‹¬å·ä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨åŒ¿åå‡½æ•°ï¼Œå¯¹ä¼ å…¥çŸ©é˜µçš„æ‰€æœ‰å…ƒç´ è¿›è¡Œæ“ä½œã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#å¯¹äºfeaturesçŸ©é˜µï¼ŒæŒ‰ç…§&#39;MSSubClass&#39;åˆ—ä¸­çš„å…ƒç´ åˆ†å¸ƒè¿›è¡Œåˆ†ç»„ï¼Œè¢«åˆ†ç»„çš„æ•°æ®åˆ—æ˜¯&#39;MSZoning&#39;åˆ—ã€‚feature.groupby(è¢«ä½œä¸ºç´¢å¼•çš„åˆ—çš„åç§°)[è¢«åˆ†ç»„çš„æ•°æ®åˆ—çš„åç§°]&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#features.groupby(&#39;MSSubClass&#39;)[&#39;MSZoning&#39;]åï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªä»¥&#39;MSSubClass&#39;ä¸ºç´¢å¼•ï¼Œä»¥&#39;MSZoning&#39;ä¸ºæ•°æ®åˆ—çš„çŸ©é˜µã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#.transform()æ–¹æ³•å°†å¯¹&#39;MSZoning&#39;æ•°æ®åˆ—è¿›è¡Œ()å†…çš„å˜æ¢ï¼Œå®ƒå°†è¿”å›å’Œä¼ å…¥çŸ©é˜µåŒæ ·ç»´åº¦çš„çŸ©é˜µã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ‹¬å·å†…æ˜¯åŒ¿åå‡½æ•°ï¼Œå°†å¯¹ä¼ å…¥çŸ©é˜µä¸­çš„ç©ºå€¼è¿›è¡Œå¡«å……ï¼Œä½¿ç”¨çš„å¡«å……å…ƒç´ æ˜¯ä¼ å…¥çŸ©é˜µä¸­çš„ä¼—æ•°ã€‚&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;MSZoning&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;groupby&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;MSSubClass&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;MSZoning&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transform&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;token comment&#34;&gt;#åˆ¤æ–­å‡ºfeaturesçŸ©é˜µä¸­åˆ—ä¸ºå¯¹è±¡çš„åˆ—ï¼Œå°†åˆ—åå­˜å…¥objectså”ç¥–ã€‚å¯¹äºfeaturesçŸ©é˜µä¸­çš„å„ä¸ªåˆ—å¯¹è±¡ï¼Œå°†å…¶åˆ—ä¸­çš„ç©ºå€¼å¡«å……ä¸º&#39;None&#39;&lt;/span&gt;
objects &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;columns&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dtype &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        objects&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;append&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;update&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;objects&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;None&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#ä½¿ç”¨ä¼ å…¥çŸ©é˜µï¼ˆ&#39;LotFrontage&#39;åˆ—ï¼‰çš„ä¸­ä½æ•°å¯¹ä¼ å…¥çŸ©é˜µä¸­çš„ç©ºå€¼è¿›è¡Œå¡«å……ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#å…ˆä»¥&#39;Neighborhood&#39;ä¸ºæ ‡ç­¾ï¼Œä»¥&#39;LotFrontage&#39;ä¸ºè¢«æ±‡æ€»åºåˆ—ã€‚ç„¶åä½¿ç”¨è¢«æ±‡æ€»åºåˆ—ä¸­çš„ä¸­ä½æ•°ï¼Œå¯¹åŸå§‹çŸ©é˜µ&#39;LotFrontage&#39;åˆ—ä¸­çš„ç©ºå€¼è¿›è¡Œå¡«å……ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#transformçš„ç‰¹æ€§æ˜¯åŒç»´æ“ä½œï¼Œæœ€åè¾“å‡ºç»“æœçš„é¡ºåºå’ŒåŸå§‹æ•°æ®åœ¨åºå·ä¸Šå®Œå…¨åŒ¹é…ã€‚&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;LotFrontage&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;groupby&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Neighborhood&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;LotFrontage&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transform&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;median&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;token comment&#34;&gt;#å¯¹äºæ•´å‹å’Œæµ®ç‚¹å‹æ•°æ®åˆ—ï¼Œä½¿ç”¨0å¡«å……å…¶ä¸­çš„ç©ºå€¼ã€‚&lt;/span&gt;
numeric_dtypes &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;int16&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;int32&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;int64&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;float16&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;float32&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;float64&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
numerics &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;columns&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dtype &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; numeric_dtypes&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        numerics&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;append&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;update&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;numerics&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fillna&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;###############################å¡«å……ç©ºå€¼-ã€ç»“æŸã€‘##########################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;######################æ•°å­—å‹æ•°æ®åˆ—ååº¦æ ¡æ­£-ã€å¼€å§‹ã€‘#######################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#ä½¿ç”¨skew()æ–¹æ³•ï¼Œè®¡ç®—æ‰€æœ‰æ•´å‹å’Œæµ®ç‚¹å‹æ•°æ®åˆ—ä¸­ï¼Œæ•°æ®åˆ†å¸ƒçš„ååº¦ï¼ˆskewnessï¼‰ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#ååº¦æ˜¯ç»Ÿè®¡æ•°æ®åˆ†å¸ƒåæ–œæ–¹å‘å’Œç¨‹åº¦çš„åº¦é‡ï¼Œæ˜¯ç»Ÿè®¡æ•°æ®åˆ†å¸ƒéå¯¹ç§°ç¨‹åº¦çš„æ•°å­—ç‰¹å¾ã€‚äº¦ç§°åæ€ã€åæ€ç³»æ•°ã€‚ &lt;/span&gt;
numeric_dtypes &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;int16&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;int32&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;int64&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;float16&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;float32&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;float64&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
numerics2 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;columns&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dtype &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; numeric_dtypes&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
        numerics2&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;append&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
skew_features &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;numerics2&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; skew&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sort_values&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ascending&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#ä»¥0.5ä½œä¸ºåŸºå‡†ï¼Œç»Ÿè®¡ååº¦è¶…è¿‡æ­¤æ•°å€¼çš„é«˜ååº¦åˆ†å¸ƒæ•°æ®åˆ—ï¼Œè·å–è¿™äº›æ•°æ®åˆ—çš„indexã€‚&lt;/span&gt;
high_skew &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; skew_features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;skew_features &lt;span class=&#34;token operator&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
skew_index &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; high_skew&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;index

&lt;span class=&#34;token comment&#34;&gt;#å¯¹é«˜ååº¦æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå°†å…¶è½¬åŒ–ä¸ºæ­£æ€åˆ†å¸ƒã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#Boxå’ŒCoxæå‡ºçš„å˜æ¢å¯ä»¥ä½¿çº¿æ€§å›å½’æ¨¡å‹æ»¡è¶³çº¿æ€§æ€§ã€ç‹¬ç«‹æ€§ã€æ–¹å·®é½æ¬¡ä»¥åŠæ­£æ€æ€§çš„åŒæ—¶ï¼Œåˆä¸ä¸¢å¤±ä¿¡æ¯ã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; skew_index&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; boxcox1p&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; boxcox_normmax&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#è¿™æ˜¯boxcox1pçš„ä½¿ç”¨æ–¹æ³•ï¼Œå‚æ•°çš„å…·ä½“æ„ä¹‰æš‚æ—¶ä¸è§£é‡Š&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;######################æ•°å­—å‹æ•°æ®åˆ—ååº¦æ ¡æ­£-ã€ç»“æŸã€‘#######################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;######################ç‰¹å¾åˆ é™¤å’Œèåˆåˆ›å»ºæ–°ç‰¹å¾-ã€å¼€å§‹ã€‘###################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#åˆ é™¤ä¸€äº›ç‰¹å¾ã€‚df.dropï¼ˆâ€˜åˆ—åâ€™, axis=1ï¼‰ä»£è¡¨å°†â€˜åˆ—åâ€™å¯¹åº”çš„åˆ—æ ‡ç­¾ï¼ˆä»¬ï¼‰æ²¿ç€æ°´å¹³çš„æ–¹å‘ä¾æ¬¡åˆ æ‰ã€‚&lt;/span&gt;
features &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Utilities&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;Street&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;PoolQC&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#èåˆå¤šä¸ªç‰¹å¾ï¼Œç”Ÿæˆæ–°ç‰¹å¾ã€‚&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;YrBltAndRemod&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;YearBuilt&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;YearRemodAdd&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;TotalSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;TotalBsmtSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;1stFlrSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;2ndFlrSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;

features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Total_sqr_footage&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;BsmtFinSF1&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;BsmtFinSF2&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;
                                 features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;1stFlrSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;2ndFlrSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Total_Bathrooms&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;FullBath&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.5&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;HalfBath&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;
                               features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;BsmtFullBath&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.5&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;BsmtHalfBath&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Total_porch_sf&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;OpenPorchSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;3SsnPorch&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;
                              features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;EnclosedPorch&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;ScreenPorch&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;
                              features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;WoodDeckSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#ç®€åŒ–ç‰¹å¾ã€‚å¯¹äºæŸäº›åˆ†å¸ƒå•è°ƒï¼ˆæ¯”å¦‚100ä¸ªæ•°æ®ä¸­æœ‰99ä¸ªçš„æ•°å€¼æ˜¯0.9ï¼Œå¦1ä¸ªæ˜¯0.1ï¼‰çš„æ•°å­—å‹æ•°æ®åˆ—ï¼Œè¿›è¡Œ01å–å€¼å¤„ç†ã€‚&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;haspool&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;PoolArea&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;has2ndfloor&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;2ndFlrSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;hasgarage&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;GarageArea&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;hasbsmt&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;TotalBsmtSF&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;hasfireplace&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; features&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Fireplaces&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ£€æŸ¥ç‰¹å¾å¤„ç†åï¼Œç‰¹å¾çŸ©é˜µçš„ç»´æ•°ï¼Œæ ¸æŸ¥ç‰¹å¾å¤„ç†ç»“æœã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;åˆ é™¤äº†3ä¸ªç‰¹å¾ï¼Œåˆèåˆåˆ›å»ºäº†10ä¸ªæ–°ç‰¹å¾ï¼Œå¤„ç†ä¹‹åçš„ç‰¹å¾çŸ©é˜µç»´åº¦ä¸º:&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;######################ç‰¹å¾åˆ é™¤å’Œèåˆåˆ›å»ºæ–°ç‰¹å¾-ã€ç»“æŸã€‘###################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;####################ç‰¹å¾æŠ•å½±ã€ç‰¹å¾çŸ©é˜µæ‹†è§£å’Œæˆªå–-ã€å¼€å§‹ã€‘#################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#ä½¿ç”¨.get_dummies()æ–¹æ³•å¯¹ç‰¹å¾çŸ©é˜µè¿›è¡Œç±»ä¼¼â€œåæ ‡æŠ•å½±â€æ“ä½œã€‚è·å¾—åœ¨æ–°ç©ºé—´ä¸‹çš„ç‰¹å¾è¡¨è¾¾ã€‚&lt;/span&gt;
final_features &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;get_dummies&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;features&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;reset_index&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;drop&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ‰“å°æ–°ç©ºé—´ä¸‹çš„ç‰¹å¾ç»´æ•°ï¼Œä¹Ÿæ˜¯æ–°ç©ºé—´çš„ç»´æ•°ã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ä½¿ç”¨get_dummies()æ–¹æ³•â€œæŠ•å½±â€ç‰¹å¾çŸ©é˜µï¼Œå³åˆ†è§£å‡ºæ›´å¤šç‰¹å¾ï¼Œå¾—åˆ°æ›´å¤šåˆ—ã€‚æŠ•å½±åçš„ç‰¹å¾çŸ©é˜µç»´åº¦ä¸º:&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;final_features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#è¿›è¡Œç‰¹å¾ç©ºé—´é™é˜¶ã€‚æˆªå–å‰len(y)è¡Œï¼Œå­˜å…¥Xé˜µï¼ˆå› ä¸ºä¹‹å‰è¿›è¡Œäº†è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®çš„åˆå¹¶ï¼Œæ‰€ä»¥ä»åˆå¹¶çŸ©é˜µä¸­å–å‡ºå‰len(y)è¡Œï¼Œå°±å¾—åˆ°äº†è®­ç»ƒæ•°æ®é›†çš„å¤„ç†åçš„ç‰¹å¾çŸ©é˜µï¼‰ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æˆªå–å‰©ä½™éƒ¨åˆ†ï¼Œå³ä»åºå·ä¸ºlen(y)çš„è¡Œå¼€å§‹ï¼Œè‡³çŸ©é˜µç»“å°¾çš„å„è¡Œï¼Œå­˜å…¥X_subé˜µã€‚æ­¤ä¸ºå®Œæˆç‰¹å¾å˜æ¢åçš„æµ‹è¯•é›†ç‰¹å¾çŸ©é˜µã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ³¨ï¼šlen(df)æ˜¯è¡Œè®¡æ•°æ–¹æ³•&lt;/span&gt;
X &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; final_features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;	&lt;span class=&#34;token comment&#34;&gt;#yæ˜¯åˆ—å‘é‡ï¼Œå­˜å‚¨äº†è®­ç»ƒæ•°æ®ä¸­çš„æˆ¿ä»·åˆ—ä¿¡æ¯ã€‚æˆªå–åå¾—åˆ°çš„Xé˜µçš„ç»´åº¦æ˜¯len(y)*(final_featuresçš„åˆ—æ•°)ã€‚&lt;/span&gt;
X_sub &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; final_features&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#ä½¿ç”¨lenå‘½ä»¤ï¼Œæ±‚çŸ©é˜µXçš„é•¿åº¦ï¼Œå¾—åˆ°çš„æ˜¯çŸ©é˜µå¯¹è±¡çš„é•¿åº¦ï¼Œå³æœ‰çŸ©é˜µä¸­æœ‰å¤šå°‘åˆ—ï¼Œè€Œä¸æ˜¯æ¯åˆ—ä¸Šæœ‰å¤šå°‘è¡Œã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;åˆ é™¤äº†3ä¸ªç‰¹å¾ï¼Œåˆèåˆåˆ›å»ºäº†10ä¸ªæ–°ç‰¹å¾ï¼Œå¤„ç†ä¹‹åçš„ç‰¹å¾çŸ©é˜µç»´åº¦ä¸º:&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;X&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; X&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;y&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;X_sub&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; X_sub&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#åœ¨æ–°ç”Ÿç‰¹å¾ç©ºé—´ä¸­ï¼Œå‰”é™¤Xé˜µå’Œyé˜µä¸­æœ‰ç€æç«¯å€¼çš„å„è¡Œæ•°æ®ï¼ˆå› ä¸ºXå’Œyé˜µåœ¨æ°´å¹³æ–¹å‘ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥è¦ä¸€èµ·åˆ é™¤åŒæ ·çš„è¡Œï¼‰ã€‚outliersæ•°å€¼ä¸­ç»™å‡ºäº†æç«¯å€¼çš„åˆ—åºå·ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#df.drop(df.index[åºå·])å°†åˆ é™¤æŒ‡å®šåºå·çš„å„è¡Œã€‚å†ä½¿ç”¨=å¯¹dfè¦†å€¼ã€‚&lt;/span&gt;
outliers &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;88&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;462&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;631&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1322&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
X &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;index&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;outliers&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#å› ä¸ºXé˜µæ˜¯ç»è¿‡å¯¹ç‰¹å¾çŸ©é˜µè¿›è¡Œç±»ä¼¼â€œåæ ‡æŠ•å½±â€æ“ä½œåå¾—åˆ°çš„ï¼Œåˆ—å‘é‡yä¸­çš„è¡Œå·å¯¹åº”ç€Xé˜µä¸­çš„åˆ—å·ã€‚&lt;/span&gt;
y &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;index&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;outliers&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;####################ç‰¹å¾æŠ•å½±ã€ç‰¹å¾çŸ©é˜µæ‹†è§£å’Œæˆªå–-ã€ç»“æŸã€‘#################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;######################æ¶ˆé™¤æˆªå–åç‰¹å¾çŸ©é˜µçš„è¿‡æ‹Ÿåˆ-ã€å¼€å§‹ã€‘#######################  è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯å¤„ç†Xé˜µå’ŒX_subé˜µã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#åœ¨æ–°ç”Ÿç‰¹å¾ç©ºé—´ä¸­ï¼Œåˆ é™¤å°†äº§ç”Ÿè¿‡æ‹Ÿåˆçš„æ•°æ®åˆ—ã€‚&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#è¿™ç§æ•°æ®åˆ—å…·æœ‰å¦‚ä¸‹ç‰¹å¾ï¼š&lt;/span&gt;
overfit &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#ç”¨æ¥è®°å½•äº§ç”Ÿè¿‡æ‹Ÿåˆçš„æ•°æ®åˆ—çš„åºå·&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; X&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;columns&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#éå†æˆªå–åç‰¹å¾çŸ©é˜µçš„æ¯ä¸€åˆ—&lt;/span&gt;
    counts &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;value_counts&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#ä½¿ç”¨.value_counts()æ–¹æ³•ï¼ŒæŸ¥çœ‹åœ¨XçŸ©é˜µçš„ç¬¬iåˆ—ä¸­ï¼Œä¸åŒçš„å–å€¼åˆ†åˆ«å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œé»˜è®¤æŒ‰æ¬¡æ•°æœ€é«˜åˆ°æœ€ä½åšé™åºæ’åˆ—ã€‚è¿”å›ä¸€ä¸ªdfã€‚&lt;/span&gt;
    zeros &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; counts&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#é€šè¿‡è¡Œå·ç´¢å¼•è¡Œæ•°æ®ï¼Œå–å‡ºcountsåˆ—ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå³å‡ºç°æ¬¡æ•°æœ€å¤šçš„å–å€¼åˆ°åº•æ˜¯å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œå­˜å…¥zeros&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; zeros &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;99.94&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#åˆ¤æ–­æŸä¸€åˆ—æ˜¯å¦å°†äº§ç”Ÿè¿‡æ‹Ÿåˆçš„æ¡ä»¶ï¼š&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æˆªå–åçš„ç‰¹å¾çŸ©é˜µæœ‰len(X)åˆ—ï¼Œå¦‚æœæŸä¸€åˆ—ä¸­çš„æŸä¸ªå€¼å‡ºç°çš„æ¬¡æ•°é™¤ä»¥ç‰¹å¾çŸ©é˜µçš„åˆ—æ•°è¶…è¿‡99.94%ï¼Œå³å…¶å‡ ä¹åœ¨è¢«æŠ•å½±çš„å„ä¸ªç»´åº¦ä¸Šéƒ½æœ‰ç€åŒæ ·çš„å–å€¼ï¼Œå¹¶ä¸å…·æœ‰â€œä¸»æˆåˆ†â€çš„æ€§è´¨ï¼Œåˆ™è®°ä¸ºè¿‡æ‹Ÿåˆåˆ—ã€‚&lt;/span&gt;
        overfit&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;append&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ‰¾åˆ°å°†äº§ç”Ÿè¿‡æ‹Ÿåˆçš„æ•°æ®åˆ—çš„ä½ç½®åï¼Œåœ¨ç‰¹å¾çŸ©é˜µä¸­è¿›è¡Œåˆ é™¤æ“ä½œã€‚&lt;/span&gt;
overfit &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;overfit&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#overfit.append(&#39;MSZoning_C (all)&#39;)#è¿™æ¡è¯­å¥æœ‰ç”¨å—ï¼Ÿæ˜¯è¦æŠŠè®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µXä¸­çš„åˆ—æ ‡ç­¾ä¸º&#39;MSZoning_C (all)&#39;çš„åˆ—ä¹Ÿåˆ é™¤å—ï¼Ÿä½†æ˜¯è®­ç»ƒæ•°æ®ä¸­å¹¶æ²¡æœ‰ä»»ä½•ä¸€ä¸ªåˆ—æ ‡ç­¾åç§°ä¸ºMSZoning_C (all)ã€‚&lt;/span&gt;
X &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;overfit&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#.copy()#åˆ é™¤æˆªå–åç‰¹å¾çŸ©é˜µXä¸­çš„è¿‡æ‹Ÿåˆåˆ—ã€‚å› ä¸ºdropå¹¶ä¸å½±å“åŸæ•°æ®ï¼Œæ‰€ä»¥ä½¿ç”¨copyã€‚ç›´æ¥è¦†å€¼åº”è¯¥ä¹Ÿå¯ä»¥ã€‚&lt;/span&gt;
X_sub &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; X_sub&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;drop&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;overfit&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#.copy()&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;######################æ¶ˆé™¤æˆªå–åç‰¹å¾çŸ©é˜µçš„è¿‡æ‹Ÿåˆ-ã€ç»“æŸã€‘#######################&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;åˆ é™¤æç«¯å€¼åŠè¿‡æ‹Ÿåˆåˆ—åï¼Œè®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µçš„ç»´æ•°ä¸ºï¼Œç‰¹å¾ï¼š&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;X&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; X&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;å¯¹åº”äºç‰¹å¾çš„å¯¹æ•°å˜æ¢åçš„æˆ¿ä»·y&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;æµ‹è¯•æ•°æ®çš„ç‰¹å¾çŸ©é˜µï¼ˆå®ƒåº”è¯¥åœ¨è¡Œã€åˆ—ä¸Šæœªè¢«åˆ å‡ï¼‰X_sub&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; X_sub&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;##############################################################ç‰¹å¾å¤„ç†-ã€ç»“æŸã€‘###################################################################################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;##############################################################æœºå™¨å­¦ä¹ -ã€å¼€å§‹ã€‘###################################################################################&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;ç‰¹å¾å¤„ç†å·²ç»å®Œæˆã€‚å¼€å§‹å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œæœºå™¨å­¦ä¹ &#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#è®¾ç½®kæŠ˜äº¤å‰éªŒè¯çš„å‚æ•°ã€‚&lt;/span&gt;
kfolds &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; KFold&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;n_splits&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; shuffle&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; random_state&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;42&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;token comment&#34;&gt;#å®šä¹‰å‡æ–¹æ ¹å¯¹æ•°è¯¯å·®ï¼ˆRoot Mean Squared Logarithmic Error ï¼ŒRMSLEï¼‰&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;rmsle&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y_pred&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sqrt&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;mean_squared_error&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y_pred&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;token comment&#34;&gt;#åˆ›å»ºæ¨¡å‹è¯„åˆ†å‡½æ•°ï¼Œæ ¹æ®ä¸åŒæ¨¡å‹çš„è¡¨ç°æ‰“åˆ†&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#cvè¡¨ç¤ºCross-validation,äº¤å‰éªŒè¯çš„æ„æ€ã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;cv_rmse&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; X&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    rmse &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sqrt&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;cross_val_score&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; scoring&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;neg_mean_squared_error&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; cv&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;kfolds&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;rmse&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#############ä¸ªä½“æœºå™¨å­¦ä¹ æ¨¡å‹çš„åˆ›å»ºï¼ˆå³æ¨¡å‹å£°æ˜å’Œå‚æ•°è®¾ç½®ï¼‰-ã€å¼€å§‹ã€‘############&lt;/span&gt;
alphas_alt &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;14.5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;14.6&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;14.7&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;14.8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;14.9&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;15.1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;15.2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;15.3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;15.4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;15.5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
alphas2 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5e-05&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0001&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0002&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0003&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0004&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0005&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0006&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0007&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0008&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
e_alphas &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.0001&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0002&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0003&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0004&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0005&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0006&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.0007&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;
e_l1ratio &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.85&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.9&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.95&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.99&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å®šä¹‰ridgeå²­å›å½’æ¨¡å‹ï¼ˆä½¿ç”¨äºŒèŒƒæ•°ä½œä¸ºæ­£åˆ™åŒ–é¡¹ã€‚ä¸è®ºæ˜¯ä½¿ç”¨ä¸€èŒƒæ•°è¿˜æ˜¯äºŒèŒƒæ•°ï¼Œæ­£åˆ™åŒ–é¡¹çš„å¼•å…¥å‡æ˜¯ä¸ºäº†é™ä½è¿‡æ‹Ÿåˆé£é™©ã€‚ï¼‰&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ³¨ï¼šæ­£åˆ™åŒ–é¡¹å¦‚æœä½¿ç”¨äºŒèŒƒæ•°ï¼Œé‚£ä¹ˆå¯¹äºä»»ä½•éœ€è¦å¯»ä¼˜çš„å‚æ•°å€¼ï¼Œåœ¨å¯»ä¼˜ç»ˆæ­¢æ—¶ï¼Œå®ƒéƒ½æ— æ³•å°†æŸäº›å‚æ•°å€¼å˜ä¸ºä¸¥æ ¼çš„0ï¼Œå°½ç®¡æŸäº›å‚æ•°ä¼°è®¡å€¼å˜å¾—éå¸¸å°ä»¥è‡³äºå¯ä»¥å¿½ç•¥ã€‚å³ä½¿ç”¨äºŒèŒƒæ•°ä¼šä¿ç•™å˜é‡çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä¸ä¼šè¿›è¡Œç±»ä¼¼PCAçš„å˜é‡å‡¸æ˜¾ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ³¨ï¼šæ­£åˆ™åŒ–é¡¹å¦‚æœä½¿ç”¨ä¸€èŒƒæ•°ï¼Œå®ƒæ¯”L2èŒƒæ•°æ›´æ˜“äºè·å¾—â€œç¨€ç–(sparse)â€è§£ï¼Œå³å®ƒçš„æ±‚è§£ç»“æœä¼šæœ‰æ›´å¤šçš„é›¶åˆ†é‡ã€‚&lt;/span&gt;
ridge &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; make_pipeline&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;RobustScaler&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; RidgeCV&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;alphas&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;alphas_alt&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; cv&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;kfolds&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å®šä¹‰LASSOæ”¶ç¼©æ¨¡å‹ï¼ˆä½¿ç”¨L1èŒƒæ•°ä½œä¸ºæ­£åˆ™åŒ–é¡¹ï¼‰ï¼ˆç”±äºå¯¹ç›®æ ‡å‡½æ•°çš„æ±‚è§£ç»“æœä¸­å°†å¾—åˆ°å¾ˆå¤šçš„é›¶åˆ†é‡ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºæ”¶ç¼©æ¨¡å‹ã€‚ï¼‰&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ³¨ï¼šæ­£åˆ™åŒ–é¡¹å¦‚æœä½¿ç”¨äºŒèŒƒæ•°ï¼Œé‚£ä¹ˆå¯¹äºä»»ä½•éœ€è¦å¯»ä¼˜çš„å‚æ•°å€¼ï¼Œåœ¨å¯»ä¼˜ç»ˆæ­¢æ—¶ï¼Œå®ƒéƒ½æ— æ³•å°†æŸäº›å‚æ•°å€¼å˜ä¸ºä¸¥æ ¼çš„0ï¼Œå°½ç®¡æŸäº›å‚æ•°ä¼°è®¡å€¼å˜å¾—éå¸¸å°ä»¥è‡³äºå¯ä»¥å¿½ç•¥ã€‚å³ä½¿ç”¨äºŒèŒƒæ•°ä¼šä¿ç•™å˜é‡çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä¸ä¼šè¿›è¡Œç±»ä¼¼PCAçš„å˜é‡å‡¸æ˜¾ã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#æ³¨ï¼šæ­£åˆ™åŒ–é¡¹å¦‚æœä½¿ç”¨ä¸€èŒƒæ•°ï¼Œå®ƒæ¯”L2èŒƒæ•°æ›´æ˜“äºè·å¾—â€œç¨€ç–(sparse)â€è§£ï¼Œå³å®ƒçš„æ±‚è§£ç»“æœä¼šæœ‰æ›´å¤šçš„é›¶åˆ†é‡ã€‚										&lt;/span&gt;
lasso &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; make_pipeline&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;RobustScaler&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; LassoCV&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;max_iter&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1e7&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; alphas&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;alphas2&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; random_state&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;42&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; cv&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;kfolds&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å®šä¹‰elastic netå¼¹æ€§ç½‘ç»œæ¨¡å‹ï¼ˆå¼¹æ€§ç½‘ç»œå®é™…ä¸Šæ˜¯ç»“åˆäº†å²­å›å½’å’Œlassoçš„ç‰¹ç‚¹ï¼ŒåŒæ—¶ä½¿ç”¨äº†L1å’ŒL2ä½œä¸ºæ­£åˆ™åŒ–é¡¹ã€‚ï¼‰									&lt;/span&gt;
elasticnet &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; make_pipeline&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;RobustScaler&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; ElasticNetCV&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;max_iter&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1e7&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; alphas&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;e_alphas&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; cv&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;kfolds&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; l1_ratio&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;e_l1ratio&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å®šä¹‰SVMæ”¯æŒå‘é‡æœºæ¨¡å‹                                     &lt;/span&gt;
svr &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; make_pipeline&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;RobustScaler&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; SVR&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;C&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; epsilon&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.008&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; gamma&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.0003&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å®šä¹‰GBæ¢¯åº¦æå‡æ¨¡å‹ï¼ˆå±•å¼€åˆ°ä¸€é˜¶å¯¼æ•°ï¼‰									&lt;/span&gt;
gbr &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; GradientBoostingRegressor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;n_estimators&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; learning_rate&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.05&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; max_depth&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; max_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;sqrt&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; min_samples_leaf&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; min_samples_split&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; loss&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;huber&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; random_state &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;42&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;                             

&lt;span class=&#34;token comment&#34;&gt;#å®šä¹‰lightgbmæ¨¡å‹									&lt;/span&gt;
lightgbm &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; LGBMRegressor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;objective&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;regression&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                                       num_leaves&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                       learning_rate&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.01&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                                       n_estimators&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                       max_bin&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                                       bagging_fraction&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.75&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                       bagging_freq&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; 
                                       bagging_seed&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                       feature_fraction&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                       feature_fraction_seed&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                       verbose&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                       &lt;span class=&#34;token comment&#34;&gt;#min_data_in_leaf=2,&lt;/span&gt;
                                       &lt;span class=&#34;token comment&#34;&gt;#min_sum_hessian_in_leaf=11&lt;/span&gt;
                                       &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#å®šä¹‰xgboostæ¨¡å‹ï¼ˆå±•å¼€åˆ°äºŒé˜¶å¯¼æ•°ï¼‰                                      &lt;/span&gt;
xgboost &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; XGBRegressor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;learning_rate&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.01&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; n_estimators&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3460&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                     max_depth&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; min_child_weight&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                     gamma&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; subsample&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.7&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                     colsample_bytree&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.7&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                     objective&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;reg:linear&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; nthread&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                     scale_pos_weight&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; seed&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;27&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                     reg_alpha&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.00006&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#############ä¸ªä½“æœºå™¨å­¦ä¹ æ¨¡å‹çš„åˆ›å»ºï¼ˆå³æ¨¡å‹å£°æ˜å’Œå‚æ•°è®¾ç½®ï¼‰-ã€ç»“æŸã€‘############&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;###########################é›†æˆå¤šä¸ªä¸ªä½“å­¦ä¹ å™¨-ã€å¼€å§‹ã€‘##########################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;###ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;###ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;###ï¼ï¼ï¼regressors=(...)ä¸­å¹¶æ²¡æœ‰çº³å…¥å‰é¢çš„svræ¨¡å‹,æ€ä¹ˆå›äº‹ï¼Ÿ&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;###ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;###ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼&lt;/span&gt;
stack_gen &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; StackingCVRegressor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;regressors&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ridge&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; lasso&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; elasticnet&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; gbr&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; xgboost&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; lightgbm&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                meta_regressor&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;xgboost&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;
                                use_features_in_secondary&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token comment&#34;&gt;#regressors=(...)ä¸­å¹¶æ²¡æœ‰çº³å…¥å‰é¢çš„svræ¨¡å‹&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;###########################é›†æˆå¤šä¸ªä¸ªä½“å­¦ä¹ å™¨-ã€ç»“æŸã€‘##########################                             &lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;############################è¿›è¡Œäº¤å‰éªŒè¯æ‰“åˆ†-ã€å¼€å§‹ã€‘###########################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#è¿›è¡Œäº¤å‰éªŒè¯ï¼Œå¹¶å¯¹ä¸åŒæ¨¡å‹çš„è¡¨ç°æ‰“åˆ†&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#ï¼ˆç”±äºæ˜¯äº¤å‰éªŒè¯ï¼Œå°†ä½¿ç”¨ä¸åŒçš„æ•°æ®é›†å¯¹åŒä¸€æ¨¡å‹è¿›è¡Œè¯„åˆ†ï¼Œæ•…æ¯ä¸ªæ¨¡å‹å¯¹åº”ä¸€ä¸ªå¾—åˆ†åºåˆ—ã€‚å±•ç¤ºæ¨¡å‹å¾—åˆ†åºåˆ—çš„å¹³å‡åˆ†ã€æ ‡å‡†å·®ï¼‰&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;è¿›è¡Œäº¤å‰éªŒè¯ï¼Œè®¡ç®—ä¸åŒæ¨¡å‹çš„å¾—åˆ†TEST score on CV&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ‰“å°äºŒèŒƒæ•°ridegå²­å›å½’æ¨¡å‹çš„å¾—åˆ†&lt;/span&gt;
score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cv_rmse&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ridge&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;äºŒèŒƒæ•°ridegå²­å›å½’æ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;std&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ‰“å°ä¸€èŒƒæ•°LASSOæ”¶ç¼©æ¨¡å‹çš„å¾—åˆ†&lt;/span&gt;
score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cv_rmse&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;lasso&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ä¸€èŒƒæ•°LASSOæ”¶ç¼©æ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;std&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ‰“å°elastic netå¼¹æ€§ç½‘ç»œæ¨¡å‹çš„å¾—åˆ†&lt;/span&gt;
score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cv_rmse&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;elasticnet&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;elastic netå¼¹æ€§ç½‘ç»œæ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;std&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ‰“å°SVRæ”¯æŒå‘é‡æœºæ¨¡å‹çš„å¾—åˆ†&lt;/span&gt;
score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cv_rmse&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;svr&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;SVRæ”¯æŒå‘é‡æœºæ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;std&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ‰“å°lightgbmè½»æ¢¯åº¦æå‡æ¨¡å‹çš„å¾—åˆ†&lt;/span&gt;
score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cv_rmse&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;lightgbm&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;lightgbmè½»æ¢¯åº¦æå‡æ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;std&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ‰“å°gbræ¢¯åº¦æå‡å›å½’æ¨¡å‹çš„å¾—åˆ†&lt;/span&gt;
score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cv_rmse&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;gbr&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;gbræ¢¯åº¦æå‡å›å½’æ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;std&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ‰“å°xgboostæ¨¡å‹çš„å¾—åˆ†&lt;/span&gt;
score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cv_rmse&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;xgboost&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;xgboostæ¨¡å‹çš„å¾—åˆ†: {:.4f} ({:.4f})\n&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;std&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;############################è¿›è¡Œäº¤å‰éªŒè¯æ‰“åˆ†-ã€ç»“æŸã€‘###########################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#########ä½¿ç”¨è®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µä½œä¸ºè¾“å…¥ï¼Œè®­ç»ƒæ•°æ®å¯¹æ•°å¤„ç†åçš„é¢„æµ‹æˆ¿ä»·ä½œä¸ºè¾“å‡ºï¼Œè¿›è¡Œå„ä¸ªæ¨¡å‹çš„è®­ç»ƒ-ã€å¼€å§‹ã€‘#########&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#å¼€å§‹é›†åˆæ‰€æœ‰æ¨¡å‹ï¼Œä½¿ç”¨stackingæ–¹æ³•&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;è¿›è¡Œæ¨¡å‹å‚æ•°è®­ç»ƒ START Fit&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;å¯¹stack_gené›†æˆå™¨æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
stack_gen_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; stack_gen&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;array&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;array&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;å¯¹elasticnetå¼¹æ€§ç½‘ç»œæ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
elastic_model_full_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; elasticnet&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;å¯¹ä¸€èŒƒæ•°lassoæ”¶ç¼©æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
lasso_model_full_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; lasso&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;å¯¹äºŒèŒƒæ•°ridgeå²­å›å½’æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
ridge_model_full_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ridge&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;å¯¹svræ”¯æŒå‘é‡æœºæ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
svr_model_full_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; svr&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;å¯¹GradientBoostingæ¢¯åº¦æå‡æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
gbr_model_full_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; gbr&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;å¯¹xgboostäºŒé˜¶æ¢¯åº¦æå‡æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
xgb_model_full_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; xgboost&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;å¯¹lightgbmè½»æ¢¯åº¦æå‡æ¨¡å‹è¿›è¡Œå‚æ•°è®­ç»ƒ&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
lgb_model_full_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; lightgbm&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;fit&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#########ä½¿ç”¨è®­ç»ƒæ•°æ®ç‰¹å¾çŸ©é˜µä½œä¸ºè¾“å…¥ï¼Œè®­ç»ƒæ•°æ®å¯¹æ•°å¤„ç†åçš„é¢„æµ‹æˆ¿ä»·ä½œä¸ºè¾“å‡ºï¼Œè¿›è¡Œå„ä¸ªæ¨¡å‹çš„è®­ç»ƒ-ã€ç»“æŸã€‘#########&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;############################è¿›è¡Œäº¤å‰éªŒè¯æ‰“åˆ†-ã€ç»“æŸã€‘###########################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;########å®šä¹‰ä¸ªä½“å­¦ä¹ å™¨çš„é¢„æµ‹å€¼èåˆå‡½æ•°ï¼Œæ£€æµ‹é¢„æµ‹å€¼èåˆç­–ç•¥çš„æ•ˆæœ-ã€å¼€å§‹ã€‘#######&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#ç»¼åˆå¤šä¸ªæ¨¡å‹äº§ç”Ÿçš„é¢„æµ‹å€¼ï¼Œä½œä¸ºå¤šæ¨¡å‹ç»„åˆå­¦ä¹ å™¨çš„é¢„æµ‹å€¼&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;blend_models_predict&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; elastic_model_full_data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; \
            &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.05&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; lasso_model_full_data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; \
            &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; ridge_model_full_data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; \
            &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; svr_model_full_data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; \
            &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; gbr_model_full_data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; \
            &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.15&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; xgb_model_full_data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; \
            &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; lgb_model_full_data&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; \
            &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.3&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; stack_gen_model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;array&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#æ‰“å°åœ¨ä¸Šè¿°æ¨¡å‹é…æ¯”ä¸‹ï¼Œå¤šæ¨¡å‹ç»„åˆå­¦ä¹ å™¨çš„å‡æ–¹æ ¹å¯¹æ•°è¯¯å·®ï¼ˆRoot Mean Squared Logarithmic Error ï¼ŒRMSLEï¼‰&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#ä½¿ç”¨è®­ç»ƒæ•°æ®å¯¹åˆ›é€ çš„æ¨¡å‹è¿›è¡ŒkæŠ˜äº¤å‰éªŒè¯ï¼Œä»¥è®­ç»ƒåˆ›é€ å‡ºçš„æ¨¡å‹çš„å‚æ•°é…ç½®ã€‚äº¤å‰éªŒè¯è®­ç»ƒè¿‡ç¨‹ç»“æŸåï¼Œå°†å¾—åˆ°æ¨¡å‹çš„å‚æ•°é…ç½®ã€‚ä½¿ç”¨å¾—å‡ºçš„å‚æ•°é…ç½®ä¸‹ï¼Œåœ¨å…¨ä½“è®­ç»ƒæ•°æ®ä¸Šè¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯æ¨¡å‹å¯¹å…¨ä½“è®­ç»ƒæ•°æ®é‡æ„çš„è¯¯å·®ã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;èåˆåçš„è®­ç»ƒæ¨¡å‹å¯¹åŸæ•°æ®é‡æ„æ—¶çš„å‡æ–¹æ ¹å¯¹æ•°è¯¯å·®RMSLE score on train data:&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;rmsle&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; blend_models_predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;########å®šä¹‰ä¸ªä½“å­¦ä¹ å™¨çš„é¢„æµ‹å€¼èåˆå‡½æ•°ï¼Œæ£€æµ‹é¢„æµ‹å€¼èåˆç­–ç•¥çš„æ•ˆæœ-ã€ç»“æŸã€‘#######&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;########å°†æµ‹è¯•é›†çš„ç‰¹å¾çŸ©é˜µä½œä¸ºè¾“å…¥ï¼Œä¼ å…¥è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¾—å‡ºçš„è¾“å‡ºå†™å…¥.csvæ–‡ä»¶çš„ç¬¬2åˆ—-ã€å¼€å§‹ã€‘########&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;ä½¿ç”¨æµ‹è¯•é›†ç‰¹å¾è¿›è¡Œæˆ¿ä»·é¢„æµ‹ Predict submission&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
submission &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;../input/house-prices-advanced-regression-techniques/sample_submission.csv&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#å‡½æ•°æ³¨é‡Šï¼š.iloc[:,1]æ˜¯åŸºäºç´¢å¼•ä½æ¥é€‰å–æ•°æ®é›†ï¼Œ[ç´¢å¼•1:ç´¢å¼•2]ï¼Œå·¦é—­å³å¼€ã€‚&lt;/span&gt;
submission&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;floor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;expm1&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;blend_models_predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X_sub&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;########å°†æµ‹è¯•é›†çš„ç‰¹å¾çŸ©é˜µä½œä¸ºè¾“å…¥ï¼Œä¼ å…¥è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¾—å‡ºçš„è¾“å‡ºå†™å…¥.csvæ–‡ä»¶çš„ç¬¬2åˆ—-ã€ç»“æŸã€‘########&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#---------------------------------------------------------------------------------------------------------------------------#&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#---------------------------------------------------------------------------------------------------------------------------#&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#---------------------------------------------------------------------------------------------------------------------------#&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;# å½“å¯¹å¹³å°æœªå…¬å¼€çš„æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹æ—¶ï¼Œå‰è¿°æ¨¡å‹çš„è¯¯å·®æ˜¯0.114 this kernel gave a score 0.114&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;# ä¸ºäº†æé«˜æ¨¡å‹çš„å¾—åˆ†ï¼Œå¼•å…¥å…¶ä»–æ¨¡å‹çš„ä¼˜ç§€é¢„æµ‹ç»“æœï¼Œä¸å‰è¿°æ¨¡å‹çš„é¢„æµ‹ç»“æœè¿›è¡Œæ··åˆï¼ˆæœ‰ç‚¹ç±»ä¼¼æŠ„åˆ«äººçš„ç­”æ¡ˆï¼Œä½†å®è´¨æ˜¯æ‰©å¤§é›†æˆæ¨¡å‹çš„è§„æ¨¡ï¼Œå¼•å…¥æ›´å¤šçš„æ¨¡å‹ï¼‰ let&#39;s up it by mixing with the top kernels&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;######################æ¨¡å‹è¾“å‡ºç»“æœèåˆ-ã€å¼€å§‹ã€‘#############################&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#åœ¨å¤šæ¨¡å‹é›†æˆå­¦ä¹ å™¨é¢„æµ‹ç»“æœçš„åŸºç¡€ä¸Šï¼Œèåˆå…¶ä»–ä¼˜ç§€æ¨¡å‹ï¼ˆå³å¹³å°ä¸Šå…¶ä»–å‡æ–¹æ ¹å¯¹æ•°è¯¯å·®å°çš„æ¨¡å‹ï¼‰çš„é¢„æµ‹ç»“æœã€‚&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#è¿™æ­¥æ“ä½œæ˜¯ä¸ºäº†é™ä½å¤šæ¨¡å‹é›†æˆå­¦ä¹ å™¨çš„æ–¹å·®ã€‚&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;èåˆå…¶ä»–ä¼˜ç§€æ¨¡å‹çš„é¢„æµ‹ç»“æœ Blend with Top Kernals submissions&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
sub_1 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input/top-10-0-10943-stacking-mice-and-brutal-force/House_Prices_submit.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
sub_2 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input/hybrid-svm-benchmark-approach-0-11180-lb-top-2/hybrid_solution.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
sub_3 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; pd&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;../input/lasso-model-for-regression-problem/lasso_sol22_Median.csv&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
submission&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;floor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.25&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;floor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;expm1&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;blend_models_predict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;X_sub&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; 
                                &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.25&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; sub_1&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; 
                                &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.25&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; sub_2&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; 
                                &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.25&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; sub_3&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;iloc&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;######################æ¨¡å‹è¾“å‡ºç»“æœèåˆ-ã€ç»“æŸã€‘#############################      &lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;####################èåˆç»“æœçš„æç«¯å€¼å‰”é™¤-ã€å¼€å§‹ã€‘###########################  &lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;#å¤„ç†èåˆåç»“æœä¸­çš„æç«¯å€¼ã€‚æŠŠå¤ªå¤§çš„æ•°å€¼ï¼ˆé™åºæ’åˆ—æ—¶ï¼Œä½äºé¡¶éƒ¨å¾€ä¸‹0.005çš„æ•°å€¼ï¼Œå°±æ˜¯åªæœ‰0.005çš„æ•°æ¯”å®ƒå¤§ï¼‰ç¼©å°ä¸€ç‚¹ï¼ˆä¹˜ä»¥0.77ï¼‰ï¼ŒæŠŠå¤ªå°çš„æ•°å€¼ï¼ˆé™åºæ’åˆ—æ—¶ï¼Œä½äºé¡¶éƒ¨å¾€ä¸‹0.99çš„æ•°å€¼ï¼‰æ”¾å¤§ä¸€ç‚¹ï¼ˆä¹˜ä»¥1.1ï¼‰&lt;/span&gt;
q1 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; submission&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SalePrice&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;quantile&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.005&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
q2 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; submission&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SalePrice&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;quantile&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.995&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
submission&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SalePrice&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; submission&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SalePrice&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; x &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;&amp;gt;&lt;/span&gt; q1 &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; x&lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.77&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
submission&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SalePrice&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; submission&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;SalePrice&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;lambda&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; x &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; q2 &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; x&lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1.1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token comment&#34;&gt;####################èåˆç»“æœçš„æç«¯å€¼å‰”é™¤-ã€ç»“æŸã€‘###########################&lt;/span&gt;

&lt;span class=&#34;token comment&#34;&gt;#ä»¥csvæ–‡ä»¶çš„å½¢å¼è¾“å‡ºé¢„æµ‹å€¼&lt;/span&gt;
submission&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to_csv&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;House_price_submission.csv&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; index&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;èåˆç»“æœ.csvæ–‡ä»¶è¾“å‡ºæˆåŠŸ Save submission&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; datetime&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;now&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;





 ]]></description>
        </item>
    </channel>
</rss>
